!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.didi={})}(this,function(t){"use strict";var n=/^class /;function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(){var t=Array.prototype.slice.call(arguments);1===t.length&&e(t[0])&&(t=t[0]);var n=t.pop();return n.$inject=t,n}var o=/constructor\s*[^(]*\(\s*([^)]*)\)/m,i=/^function\s*[^(]*\(\s*([^)]*)\)/m,c=/\/\*([^*]*)\*\//m;function u(t){if("function"!=typeof t)throw new Error('Cannot annotate "'+t+'". Expected a function!');var e=t.toString().match(function(t){return n.test(t.toString())}(t)?o:i);return e&&e[1]&&e[1].split(",").map(function(t){return(e=t.match(c))?e[1].trim():t.trim()})||[]}function f(){var t=[];this.factory=function(n,e){return t.push([n,"factory",e]),this},this.value=function(n,e){return t.push([n,"value",e]),this},this.type=function(n,e){return t.push([n,"type",e]),this},this.forEach=function(n){t.forEach(n)}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function s(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}function p(t,n){return Object.hasOwnProperty.call(t,n)}t.annotate=r,t.Module=f,t.Injector=function t(n,o){o=o||{get:function(t,n){if(i.push(t),!1===n)return null;throw y('No provider for "'+t+'"!')}};var i=[],c=this._providers=Object.create(o._providers||null),l=this._instances=Object.create(null),h=l.injector=this,y=function(t){var n=i.join(" -> ");return i.length=0,new Error(n?t+" (Resolving: "+n+")":t)},d=function t(n,e){if(!c[n]&&-1!==n.indexOf(".")){for(var r=n.split("."),u=t(r.shift());r.length;)u=u[r.shift()];return u}if(p(l,n))return l[n];if(p(c,n)){if(-1!==i.indexOf(n))throw i.push(n),y("Cannot resolve circular dependency!");return i.push(n),l[n]=c[n][0](c[n][1]),i.pop(),l[n]}return o.get(n,e)},v=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof t){if(!e(t))throw new Error('Cannot invoke "'+t+'". Expected a function!');t=r(t.slice())}return{fn:t,dependencies:(t.$inject||u(t)).map(function(t){return p(n,t)?n[t]:d(t)})}},b=function(t){var n=v(t),e=n.dependencies,r=n.fn;return new(Function.prototype.bind.apply(r,[null].concat(s(e))))},m=function(t,n,e){var r=v(t,e),o=r.dependencies,i=r.fn;return i.call.apply(i,[n].concat(s(o)))},_=function(t){return r(function(n){return t.get(n)})},j={factory:m,type:b,value:function(t){return t}};n.forEach(function(n){function o(t,n){return"value"!==t&&e(n)&&(n=r(n.slice())),n}if(n instanceof f)n.forEach(function(t){var n=t[0],e=t[1],r=t[2];c[n]=[j[e],o(e,r),e]});else if("object"===(void 0===n?"undefined":a(n)))if(n.__exports__){var i=Object.keys(n).reduce(function(t,e){return"__"!==e.substring(0,2)&&(t[e]=n[e]),t},Object.create(null)),u=new t((n.__modules__||[]).concat([i]),h),s=r(function(t){return u.get(t)});n.__exports__.forEach(function(t){c[t]=[s,t,"private",u]})}else Object.keys(n).forEach(function(t){if("private"!==n[t][2]){var e=n[t][0],r=n[t][1];c[t]=[j[e],o(e,r),e]}else c[t]=n[t]})}),this.get=d,this.invoke=m,this.instantiate=b,this.createChild=function(n,e){if(e&&e.length){var r,o,i,u,f=Object.create(null),a=Object.create(null),s=[],p=[],l=[];for(var y in c)r=c[y],-1!==e.indexOf(y)&&("private"===r[2]?-1===(o=s.indexOf(r[3]))?(i=r[3].createChild([],e),u=_(i),s.push(r[3]),p.push(i),l.push(u),f[y]=[u,y,"private",i]):f[y]=[l[o],y,"private",p[o]]:f[y]=[r[2],r[1]],a[y]=!0),"factory"!==r[2]&&"type"!==r[2]||!r[1].$scope||e.forEach(function(t){-1!==r[1].$scope.indexOf(t)&&(f[y]=[r[2],r[1]],a[t]=!0)});e.forEach(function(t){if(!a[t])throw new Error('No provider for "'+t+'". Cannot use provider from the parent!')}),n.unshift(f)}return new t(n,h)}},Object.defineProperty(t,"__esModule",{value:!0})});
