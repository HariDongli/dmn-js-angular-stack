/*! dmn-js - dmn-modeler v4.3.0 | Copyright (c) 2014-present, camunda Services GmbH | bpmn.io/license */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.DmnJS=t()}(this,function(){"use strict";function e(e){return Array.prototype.concat.apply([],e)}var t=Object.prototype.toString,n=Object.prototype.hasOwnProperty;function r(e){return"[object Array]"===t.call(e)}function o(e){return"[object Object]"===t.call(e)}function i(e){return"[object Number]"===t.call(e)}function a(e){return"[object Function]"===t.call(e)}function s(e){return"[object String]"===t.call(e)}function c(e,t){return n.call(e,t)}function u(e,t){var n;return t=w(t),p(e,function(e,r){if(t(e,r))return n=e,!1}),n}function l(e,t){var n=[];return p(e,function(e,r){t(e,r)&&n.push(e)}),n}function p(e,t){if(null!==(n=e)&&void 0!==n){var n,o=r(e)?C:x;for(var i in e){if(c(e,i))if(!1===t(e[i],o(i)))return}}}function f(e,t,n){return p(e,function(e,r){n=t(n,e,r)}),n}function d(e,t){return f(e,function(e,n,r){return e&&t(n,r)},!0)}function h(e,t){return!!u(e,t)}function v(e,t){var n=[];return p(e,function(e,r){n.push(t(e,r))}),n}function y(e){return e&&Object.keys(e)||[]}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=_(t),p(e,function(e){var r=t(e)||"_",o=n[r];o||(o=n[r]=[]),o.push(e)}),n}function g(e,t){t=_(t);var n=[];return p(e,function(e,r){for(var o=t(e,r),i={d:o,v:e},a=0;a<n.length;a++){if(o<n[a].d)return void n.splice(a,0,i)}n.push(i)}),v(n,function(e){return e.v})}function b(e){return function(t){return d(e,function(e,n){return t[n]===e})}}function _(e){return a(e)?e:function(t){return t[e]}}function w(e){return a(e)?e:function(t){return t===e}}function x(e){return e}function C(e){return Number(e)}var E=Array.prototype.slice;function O(e,t){var n;return function(){var r=E.call(arguments);n&&clearTimeout(n),n=setTimeout(function(){e.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r))},t)}}function k(e,t){return e.bind(t)}var j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function S(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return j.apply(void 0,[e].concat(n))}function P(e,t){var n={},r=Object(e);return p(t,function(t){t in r&&(n[t]=e[t])}),n}var T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R=Array.prototype.slice;function A(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function M(){}function B(){}function D(e,t){this.model=e,this.properties=t}A.prototype.on=function(e,t,n,o){if(e=r(e)?e:[e],a(t)&&(o=n,n=t,t=1e3),!i(t))throw new Error("priority must be a number");var s=n;o&&((s=k(n,o)).__fn=n.__fn||n);var c=this,u={priority:t,callback:s};e.forEach(function(e){c._addListener(e,u)})},A.prototype.once=function(e,t,n,r){var o=this;if(a(t)&&(r=n,n=t,t=1e3),!i(t))throw new Error("priority must be a number");function s(){return o.off(e,s),n.apply(r,arguments)}s.__fn=n,this.on(e,t,s)},A.prototype.off=function(e,t){var n,r,o,i=this._getListeners(e);if(t)for(o=i.length-1;n=i[o];o--)(r=n.callback)!==t&&r.__fn!==t||i.splice(o,1);else i.length=0},A.prototype.createEvent=function(e){var t=new M;return t.init(e),t},A.prototype.fire=function(e,t){var n,r,o,i;if(i=R.call(arguments),"object"===(void 0===e?"undefined":T(e))&&(e=(n=e).type),!e)throw new Error("no event type specified");if(r=this._listeners[e]){n=t instanceof M?t:this.createEvent(t),i[0]=n;var a=n.type;e!==a&&(n.type=e);try{o=this._invokeListeners(n,i,r)}finally{e!==a&&(n.type=a)}return void 0===o&&n.defaultPrevented&&(o=!1),o}},A.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},A.prototype._destroy=function(){this._listeners={}},A.prototype._invokeListeners=function(e,t,n){var r,o,i;for(r=0;(o=n[r])&&!e.cancelBubble;r++)i=this._invokeListener(e,t,o);return i},A.prototype._invokeListener=function(e,t,n){var r;try{void 0!==(r=function(e,t){return e.apply(null,t)}(n.callback,t))&&(e.returnValue=r,e.stopPropagation()),!1===r&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener"),console.error(e.stack),e}return r},A.prototype._addListener=function(e,t){var n,r,o=this._getListeners(e);for(r=0;n=o[r];r++)if(n.priority<t.priority)return void o.splice(r,0,t);o.push(t)},A.prototype._getListeners=function(e){var t=this._listeners[e];return t||(this._listeners[e]=t=[]),t},M.prototype.stopPropagation=function(){this.cancelBubble=!0},M.prototype.preventDefault=function(){this.defaultPrevented=!0},M.prototype.init=function(e){S(this,e||{})},B.prototype.get=function(e){return this.$model.properties.get(this,e)},B.prototype.set=function(e,t){this.$model.properties.set(this,e,t)},D.prototype.createType=function(e){var t=this.model,n=this.properties,r=Object.create(B.prototype);p(e.properties,function(e){e.isMany||void 0===e.default||(r[e.name]=e.default)}),n.defineModel(r,t),n.defineDescriptor(r,e);var o=e.ns.name;function i(e){n.define(this,"$type",{value:o,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),p(e,k(function(e,t){this.set(t,e)},this))}return i.prototype=r,i.hasType=r.$instanceOf=this.model.hasType,n.defineModel(i,t),n.defineDescriptor(i,e),i};var I={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},N={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e,10)}};function V(e,t){var n=N[e];return n?n(t):t}function L(e){return!!I[e]}function $(e){return!!N[e]}function F(e,t){var n,r,o=e.split(/:/);if(1===o.length)n=e,r=t;else{if(2!==o.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=o[1],r=o[0]}return{name:e=(r?r+":":"")+n,prefix:r,localName:n}}function U(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function z(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,p(e,k(this.registerPackage,this))}function W(e,t,n){var r=t[n];if(r in e)throw new Error("package with "+n+" <"+r+"> already defined")}function G(e){this.model=e}function H(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function q(e){this.properties=new G(this),this.factory=new D(this,this.properties),this.registry=new z(e,this.properties),this.typeCache={}}U.prototype.build=function(){return P(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},U.prototype.addProperty=function(e,t,n){"boolean"==typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);var r=this.properties;void 0!==t?r.splice(t,0,e):r.push(e)},U.prototype.replaceProperty=function(e,t,n){var r=e.ns,o=this.properties,i=this.propertiesByName,a=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=o.indexOf(e);if(-1===s)throw new Error("property <"+r.name+"> not found in property list");o.splice(s,1),this.addProperty(t,n?void 0:s,a),i[r.name]=i[r.localName]=t},U.prototype.redefineProperty=function(e,t,n){var r=e.ns.prefix,o=t.split("#"),i=F(o[0],r),a=F(o[1],i.prefix).name,s=this.propertiesByName[a];if(!s)throw new Error("refined property <"+a+"> not found");this.replaceProperty(s,e,n),delete e.redefines},U.prototype.addNamedProperty=function(e,t){var n=e.ns,r=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),r[n.name]=r[n.localName]=e},U.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]},U.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},U.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},U.prototype.assertNotDefined=function(e,t){var n=e.name,r=this.propertiesByName[n];if(r)throw new Error("property <"+n+"> already defined; override of <"+r.definedBy.ns.name+"#"+r.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},U.prototype.hasProperty=function(e){return this.propertiesByName[e]},U.prototype.addTrait=function(e,t){var n=this.allTypesByName,r=this.allTypes,o=e.name;o in n||(p(e.properties,k(function(n){n=S({},n,{name:n.ns.localName,inherited:t}),Object.defineProperty(n,"definedBy",{value:e});var r=n.replaces,o=n.redefines;r||o?this.redefineProperty(n,r||o,r):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))},this)),r.push(e),n[o]=e)},z.prototype.getPackage=function(e){return this.packageMap[e]},z.prototype.getPackages=function(){return this.packages},z.prototype.registerPackage=function(e){e=S({},e);var t=this.packageMap;W(t,e,"prefix"),W(t,e,"uri"),p(e.types,k(function(t){this.registerType(t,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},z.prototype.registerType=function(e,t){var n=F((e=S({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:S(e.meta||{})})).name,t.prefix),r=n.name,o={};p(e.properties,k(function(e){var t=F(e.name,n.prefix),r=t.name;L(e.type)||(e.type=F(e.type,t.prefix).name),S(e,{ns:t,name:r}),o[r]=e},this)),S(e,{ns:n,name:r,propertiesByName:o}),p(e.extends,k(function(e){var t=this.typeMap[e];t.traits=t.traits||[],t.traits.push(r)},this)),this.definePackage(e,t),this.typeMap[r]=e},z.prototype.mapTypes=function(e,t,n){var r=L(e.name)?{name:e.name}:this.typeMap[e.name],o=this;function i(e){return a(e,!0)}function a(n,r){var i=F(n,L(n)?"":e.prefix);o.mapTypes(i,t,r)}if(!r)throw new Error("unknown type <"+e.name+">");p(r.superClass,n?i:a),t(r,!n),p(r.traits,i)},z.prototype.getEffectiveDescriptor=function(e){var t=F(e),n=new U(t);this.mapTypes(t,function(e,t){n.addTrait(e,t)});var r=n.build();return this.definePackage(r,r.allTypes[r.allTypes.length-1].$pkg),r},z.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})},G.prototype.set=function(e,t,n){var r=this.model.getPropertyDescriptor(e,t),o=r&&r.name;void 0===n?r?delete e[o]:delete e.$attrs[t]:r?o in e?e[o]=n:H(e,r,n):e.$attrs[t]=n},G.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var r=n.name;return!e[r]&&n.isMany&&H(e,n,[]),e[r]},G.prototype.define=function(e,t,n){Object.defineProperty(e,t,n)},G.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},G.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})},q.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)},q.prototype.getType=function(e){var t=this.typeCache,n=s(e)?e:e.ns.name,r=t[n];return r||(e=this.registry.getEffectiveDescriptor(n),r=t[n]=this.factory.createType(e)),r},q.prototype.createAny=function(e,t,n){var r=F(e),i={$type:e,$instanceOf:function(e){return e===this.$type}},a={name:e,isGeneric:!0,ns:{prefix:r.prefix,localName:r.localName,uri:t}};return this.properties.defineDescriptor(i,a),this.properties.defineModel(i,this),this.properties.define(i,"$parent",{enumerable:!1,writable:!0}),p(n,function(e,t){o(e)&&void 0!==e.value?i[e.name]=e.value:i[t]=e}),i},q.prototype.getPackage=function(e){return this.registry.getPackage(e)},q.prototype.getPackages=function(){return this.registry.getPackages()},q.prototype.getElementDescriptor=function(e){return e.$descriptor},q.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},q.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},q.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var K="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function X(e,t){return e(t={exports:{}},t.exports),t.exports}var Y=X(function(e,t){
/**
   * Tiny stack for browser or server
   *
   * @copyright 2015 Jason Mulligan <jason.mulligan@avoidwork.com>
   * @license BSD-3-Clause
   * @version 1.0.0
   */
!function(t){function n(){this.data=[null],this.top=0}n.prototype.clear=function(){return this.data=[null],this.top=0,this},n.prototype.length=function(){return this.top},n.prototype.empty=function(){return 0===this.top},n.prototype.peek=function(){return this.data[this.top]},n.prototype.pop=function(){return this.top>0?(this.top--,this.data.pop()):void 0},n.prototype.push=function(e){return this.data[++this.top]=e,this},n.prototype.search=function(e){var t=this.data.indexOf(e);return-1===t?-1:this.data.length-t},e.exports=function(){return new n}}()}),Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J=String.fromCharCode,Q=Object.prototype.hasOwnProperty,ee=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,te={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function ne(e,t,n,r){return r?Q.call(te,r)?te[r]:"&"+r+";":J(t||parseInt(n,16))}function re(e){return e.length>3&&-1!==e.indexOf("&")?e.replace(ee,ne):e}Object.keys(te).forEach(function(e){te[e.toUpperCase()]=te[e]});var oe="http://www.w3.org/2001/XMLSchema-instance",ie="xsi",ae="xsi:type";function se(e){return new Error(e)}function ce(e){return"missing namespace for prefix <"+e+">"}function ue(e){return{get:e,enumerable:!0}}function le(e){var t,n={};for(t in e)n[t]=e[t];return n}function pe(e){return e+"$uri"}function fe(){return{line:0,column:0}}function de(e){throw e}function he(e){if(!this)return new he(e);var t,n,r,o,i,a,s,c,u,l=e&&e.proxy,p=de,f=fe,d=!1,h=!1,v=null,y=!1;function m(e){e instanceof Error||(e=se(e)),v=e,p(e,f)}function g(e){i&&(e instanceof Error||(e=se(e)),i(e,f))}this.on=function(e,u){if("function"!=typeof u)throw se("required args <name, cb>");switch(e){case"openTag":n=u;break;case"text":t=u;break;case"closeTag":r=u;break;case"error":p=u;break;case"warn":i=u;break;case"cdata":o=u;break;case"attention":c=u;break;case"question":s=u;break;case"comment":a=u;break;default:throw se("unsupported event: "+e)}return this},this.ns=function(e){if(void 0===e&&(e={}),"object"!==(void 0===e?"undefined":Z(e)))throw se("required args <nsMap={}>");var t,n={};for(t in e)n[t]=e[t];return n[oe]=ie,h=!0,u=n,this},this.parse=function(e){if("string"!=typeof e)throw se("required args <xml=string>");return v=null,function(e){var i,p,v,b,_,w,x,C,E,O,k=h?[]:null,j=h?function(e){var t,n,r={};for(t in e)r[n=e[t]]=n,r[pe(n)]=t;return r}(u):null,S=[],P=0,T=!1,R=!1,A=0,M=0,B="",D=0;function I(){if(null!==O)return O;var e,t,n,r,o,i,a,s,c,l,p,f=h&&j.xmlns,v=h&&d?[]:null,y=D,m=B,b=m.length,_={},w={};e:for(;y<b;y++)if(c=!1,!(32===(l=m.charCodeAt(y))||l<14&&l>8)){for((l<65||l>122||l>90&&l<97)&&95!==l&&58!==l&&(g("illegal first char attribute name"),c=!0),p=y+1;p<b;p++)if(!((l=m.charCodeAt(p))>96&&l<123||l>64&&l<91||l>47&&l<59||46===l||45===l||95===l)){if(32===l||l<14&&l>8){g("missing attribute value"),y=p;continue e}if(61===l)break;g("illegal attribute name char"),c=!0}if("xmlns:xmlns"===(s=m.substring(y,p))&&(g("illegal declaration of xmlns"),c=!0),34===(l=m.charCodeAt(p+1)))-1===(p=m.indexOf('"',y=p+2))&&-1!==(p=m.indexOf("'",y))&&(g("attribute value quote missmatch"),c=!0);else if(39===l)-1===(p=m.indexOf("'",y=p+2))&&-1!==(p=m.indexOf('"',y))&&(g("attribute value quote missmatch"),c=!0);else for(g("missing attribute value quotes"),c=!0,p+=1;p<b&&!(32===(l=m.charCodeAt(p+1))||l<14&&l>8);p++);for(-1===p&&(g("missing closing quotes"),p=b,c=!0),c||(i=m.substring(y,p)),y=p;p+1<b&&!(32===(l=m.charCodeAt(p+1))||l<14&&l>8);p++)y===p&&(g("illegal character after attribute end"),c=!0);if(y=p+1,!c)if(s in w)g("attribute <"+s+"> already defined");else if(w[s]=!0,h)if(d){if(null!==(o="xmlns"===s?"xmlns":120===s.charCodeAt(0)&&"xmlns:"===s.substr(0,6)?s.substr(6):null)){if(e=re(i),t=pe(o),!(a=u[e])){if("xmlns"===o||t in j&&j[t]!==e)do{a="ns"+P++}while(void 0!==j[a]);else a=o;u[e]=a}j[o]!==a&&(r||(j=le(j),r=!0),j[o]=a,"xmlns"===o&&(j[pe(a)]=e,f=a),j[t]=e),_[s]=i;continue}v.push(s,i)}else-1!==(l=s.indexOf(":"))?(n=j[s.substring(0,l)])?((s=f===n?s.substr(l+1):n+s.substr(l))===ae&&(-1!==(l=i.indexOf(":"))?(n=i.substring(0,l),n=j[n]||n,i=n+i.substring(l)):i=f+":"+i),_[s]=i):g(ce(s.substring(0,l))):_[s]=i;else _[s]=i}if(d)for(y=0,b=v.length;y<b;y++){if(s=v[y++],i=v[y],-1!==(l=s.indexOf(":"))){if(!(n=j[s.substring(0,l)])){g(ce(s.substring(0,l)));continue}(s=f===n?s.substr(l+1):n+s.substr(l))===ae&&(-1!==(l=i.indexOf(":"))?(n=i.substring(0,l),n=j[n]||n,i=n+i.substring(l)):i=f+":"+i)}_[s]=i}return O=_}f=function(){for(var t,n,r=/(\r\n|\r|\n)/g,o=0,i=0,a=0,s=M;A>=a&&(t=r.exec(e))&&!((s=t[0].length+t.index)>A);)o+=1,a=s;return-1==A?(i=s,n=""):(i=A-a,n=-1==M?e.substring(A):e.substring(A,M+1)),{data:n,line:o,column:i}},l&&(E=Object.create({},{name:ue(function(){return x}),originalName:ue(function(){return C}),attrs:ue(I),ns:ue(function(){return j})}));for(;-1!==M;){if(-1===(A=60===e.charCodeAt(M)?M:e.indexOf("<",M)))return S.length?m("unexpected end of file"):0===M?m("missing start tag"):void 0;if(M!==A&&t&&(t(e.substring(M,A),re,f),y))return;if(33!==(_=e.charCodeAt(A+1)))if(63!==_){if(-1==(M=e.indexOf(">",A+1)))return m("unclosed tag");if(O={},47===_){if(T=!1,R=!0,!S.length)return m("missing open tag");if(p=x=S.pop(),b=A+2+p.length,e.substring(A+2,b)!==p)return m("closing tag mismatch");for(;b<M;b++)if(!(32===(_=e.charCodeAt(b))||_>8&&_<14))return m("close tag")}else{if(47===e.charCodeAt(M-1)?(p=x=e.substring(A+1,M-1),T=!0,R=!0):(p=x=e.substring(A+1,M),T=!0,R=!1),!(_>96&&_<123||_>64&&_<91||95===_||58===_))return m("illegal first char nodeName");for(b=1,v=p.length;b<v;b++)if(!((_=p.charCodeAt(b))>96&&_<123||_>64&&_<91||_>47&&_<59||45===_||95===_)){if(32===_||_<14&&_>8){x=p.substring(0,b),O=null;break}return m("invalid nodeName")}R||S.push(x)}if(h){if(i=j,T&&(R||k.push(i),null===O&&(d=-1!==p.indexOf("xmlns",b))&&(D=b,B=p,I(),d=!1)),C=x,-1!==(_=x.indexOf(":"))){if(!(w=j[x.substring(0,_)]))return m("missing namespace on <"+C+">");x=x.substr(_+1)}else w=j.xmlns;w&&(x=w+":"+x)}if(T&&(D=b,B=p,n&&(l?n(E,re,R,f):n(x,I,re,R,f),y)))return;if(R){if(r&&(r(l?E:x,re,T,f),y))return;h&&(j=T?i:k.pop())}M+=1}else{if(-1===(M=e.indexOf("?>",A)))return m("unclosed question");if(s&&(s(e.substring(A,M+2),f),y))return;M+=2}else{if(91===(_=e.charCodeAt(A+2))&&"CDATA["===e.substr(A+3,6)){if(-1===(M=e.indexOf("]]>",A)))return m("unclosed cdata");if(o&&(o(e.substring(A+9,M),f),y))return;M+=3;continue}if(45===_&&45===e.charCodeAt(A+3)){if(-1===(M=e.indexOf("--\x3e",A)))return m("unclosed comment");if(a&&(a(e.substring(A+4,M),re,f),y))return;M+=3;continue}if(-1===(M=e.indexOf(">",A+1)))return m("unclosed tag");if(c&&(c(e.substring(A,M+1),re,f),y))return;M+=1}}}(e),f=fe,y=!1,v},this.stop=function(){y=!0}}function ve(e){return e.xml&&"lowerCase"===e.xml.tagAlias}var ye={xsi:"http://www.w3.org/2001/XMLSchema-instance"},me="xsi:type";function ge(e){return e.xml&&e.xml.serialize}function be(e){return ge(e)===me}function _e(e,t){return ve(t)?e.prefix+":"+((n=e.localName).charAt(0).toUpperCase()+n.slice(1)):e.name;var n}function we(e){return new Error(e)}function xe(e){return e.$descriptor}function Ce(){}function Ee(){}function Oe(){}function ke(e,t){this.property=e,this.context=t}function je(e,t){this.element=t,this.propertyDesc=e}function Se(){}function Pe(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function Te(e,t,n){Pe.call(this,e,t,n)}function Re(e,t,n){this.model=e,this.context=n}function Ae(e){e instanceof q&&(e={model:e}),S(this,{lax:!1},e)}Ce.prototype.handleEnd=function(){},Ce.prototype.handleText=function(){},Ce.prototype.handleNode=function(){},Ee.prototype=Object.create(Ce.prototype),Ee.prototype.handleNode=function(){return this},Oe.prototype=Object.create(Ce.prototype),Oe.prototype.handleText=function(e){this.body=(this.body||"")+e},ke.prototype=Object.create(Oe.prototype),ke.prototype.handleNode=function(e){if(this.element)throw we("expected no sub nodes");return this.element=this.createReference(e),this},ke.prototype.handleEnd=function(){this.element.id=this.body},ke.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},je.prototype=Object.create(Oe.prototype),je.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=V(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)},Se.prototype=Object.create(Oe.prototype),Se.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t},Pe.prototype=Object.create(Se.prototype),Pe.prototype.addReference=function(e){this.context.addReference(e)},Pe.prototype.handleEnd=function(){var e=this.body,t=this.element,n=xe(t).bodyProperty;n&&void 0!==e&&(e=V(n.type,e),t.set(n.name,e))},Pe.prototype.createElement=function(e){var t,n=e.attributes,r=this.type,o=xe(r),i=this.context,a=new r({}),s=this.model;return p(n,function(e,n){var r=o.propertiesByName[n];r&&r.isReference?r.isMany?p(e.split(" "),function(e){i.addReference({element:a,property:r.ns.name,id:e})}):i.addReference({element:a,property:r.ns.name,id:e}):(r?e=V(r.type,e):"xmlns"!==n&&(t=F(n,o.ns.prefix),s.getPackage(t.prefix)&&i.addWarning({message:"unknown attribute <"+n+">",element:a,property:n,value:e})),a.set(n,e))}),a},Pe.prototype.getPropertyForNode=function(e){var t,n,r=F(e.name),o=this.type,i=this.model,a=xe(o),s=r.name,c=a.propertiesByName[s];if(c)return be(c)&&(t=e.attributes[me])?(t=function(e,t){var n=F(e);return function(e,t){var n=e.name,r=e.localName,o=t.xml&&t.xml.typePrefix;return o&&0===r.indexOf(o)?e.prefix+":"+r.slice(o.length):n}(n,t.getPackage(n.prefix))}(t,i),S({},c,{effectiveType:xe(n=i.getType(t)).name})):c;var l=i.getPackage(r.prefix);if(l){if(t=_e(r,l),n=i.getType(t),c=u(a.properties,function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)}))return S({},c,{effectiveType:xe(n).name})}else if(c=u(a.properties,function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type}))return c;throw we("unrecognized element <"+r.name+">")},Pe.prototype.toString=function(){return"ElementDescriptor["+xe(this.type).name+"]"},Pe.prototype.valueHandler=function(e,t){return new je(e,t)},Pe.prototype.referenceHandler=function(e){return new ke(e,this.context)},Pe.prototype.handler=function(e){return"Element"===e?new Re(this.model,e,this.context):new Pe(this.model,e,this.context)},Pe.prototype.handleChild=function(e){var t,n,r,o;if(t=this.getPropertyForNode(e),r=this.element,$(n=t.effectiveType||t.type))return this.valueHandler(t,r);var i=(o=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(n).handleNode(e)).element;return void 0!==i&&(t.isMany?r.get(t.name).push(i):r.set(t.name,i),t.isReference?(S(i,{element:r}),this.context.addReference(i)):i.$parent=r),o},Te.prototype=Object.create(Pe.prototype),Te.prototype.createElement=function(e){var t=e.name,n=F(t),r=this.model,o=this.type,i=r.getPackage(n.prefix),a=i&&_e(n,i)||t;if(!o.hasType(a))throw we("unexpected element <"+e.originalName+">");return Pe.prototype.createElement.call(this,e)},Re.prototype=Object.create(Se.prototype),Re.prototype.createElement=function(e){var t=e.name,n=F(t).prefix,r=e.ns[n+"$uri"],o=e.attributes;return this.model.createAny(t,r,o)},Re.prototype.handleChild=function(e){var t=new Re(this.model,"Element",this.context).handleNode(e),n=this.element,r=t.element;return void 0!==r&&((n.$children=n.$children||[]).push(r),r.$parent=n),t},Re.prototype.handleText=function(e){this.body=this.body||""+e},Re.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Ae.prototype.fromXML=function(e,t,n){var r=t.rootHandler;t instanceof Pe?(r=t,t={}):"string"==typeof t?(r=this.handler(t),t={}):"string"==typeof r&&(r=this.handler(r));var o=this.model,i=this.lax,a=new function(e){S(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw we("expected element");var t,n=this.elementsById,r=xe(e).idProperty;if(r&&(t=e.get(r.name))){if(n[t])throw we("duplicate ID <"+t+">");n[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}(S({},t,{rootHandler:r})),s=new he({proxy:!0}),c=new Y;function u(e,t,n){var r=t(),o=r.line,i=r.column,s=r.data;"<"===s.charAt(0)&&-1!==s.indexOf(" ")&&(s=s.slice(0,s.indexOf(" "))+">");var c="unparsable content "+(s?s+" ":"")+"detected\n\tline: "+o+"\n\tcolumn: "+i+"\n\tnested error: "+e.message;if(n)return a.addWarning({message:c,error:e}),console.warn("could not parse node"),console.warn(e),!0;throw console.error("could not parse document"),console.error(e),we(c)}r.context=a,c.push(r);var l=/^<\?xml /i,p=/ encoding="([^"]+)"/i,f=/^utf-8$/i;var d=o.getPackages().reduce(function(e,t){return e[t.uri]=t.prefix,e},{});s.ns(d).on("openTag",function(e,t,n,r){var o=e.attrs||{},a=Object.keys(o).reduce(function(e,n){var r=t(o[n]);return e[n]=r,e},{});!function(e,t){var n=c.peek();try{c.push(n.handleNode(e))}catch(e){u(e,t,i)&&c.push(new Ee)}}({name:e.name,originalName:e.originalName,attributes:a,ns:e.ns},r)}).on("question",function(e){if(l.test(e)){var t=p.exec(e),n=t&&t[1];n&&!f.test(n)&&a.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}}).on("closeTag",function(){c.pop().handleEnd()}).on("cdata",function(e){c.peek().handleText(e)}).on("text",function(e,t){!function(e){(e=e.trim())&&c.peek().handleText(e)}(t(e))}).on("error",u).on("warn",function(e,t){return u(e,t,!0)}),setTimeout(function(){var t;try{s.parse(e),function(){var e,t,n=a.elementsById,r=a.references;for(e=0;t=r[e];e++){var o=t.element,i=n[t.id],s=xe(o).propertiesByName[t.property];if(i||a.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),s.isMany){var c=o.get(s.name),u=c.indexOf(t);-1===u&&(u=c.length),i?c[u]=i:c.splice(u,1)}else o.set(s.name,i)}}()}catch(e){t=e}var o=r.element;t||o||(t=we("failed to parse document as <"+r.type.$descriptor.name+">")),n(t,t?void 0:o,a)},0)},Ae.prototype.handler=function(e){return new Te(this.model,e)};var Me='<?xml version="1.0" encoding="UTF-8"?>\n',Be=/<|>|'|"|&|\n\r|\n/g,De=/<|>|&/g;function Ie(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Ne(e){return s(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function Ve(e,t){return t.isGeneric?S({localName:t.ns.localName},e):S({localName:(n=t.ns.localName,r=t.$pkg,ve(r)?(o=n).charAt(0).toLowerCase()+o.slice(1):n)},e);var n,r,o}var Le={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},$e={"<":"lt",">":"gt","&":"amp"};function Fe(e,t,n){return(e=s(e)?e:""+e).replace(t,function(e){return"&"+n[e]+";"})}function Ue(e){this.tagName=e}function ze(){}function We(e){this.tagName=e}function Ge(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function He(e,t){Ge.call(this,e,t)}function qe(e,t){q.call(this,e,t)}Ue.prototype.build=function(e){return this.element=e,this},Ue.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},ze.prototype.serializeValue=ze.prototype.serializeTo=function(e){e.append(this.escape?Fe(this.value,De,$e):this.value)},ze.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(De)&&(this.escape=!0),this},Ie(We,ze),We.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},Ge.prototype.build=function(e){this.element=e;var t,n,r=e.$descriptor,o=this.propertyDescriptor,i=r.isGeneric;return t=i?this.parseGeneric(e):this.parseNsAttributes(e),this.ns=o?this.nsPropertyTagName(o):this.nsTagName(r),this.tagName=this.addTagName(this.ns),i||(n=function(e){return l(e.$descriptor.properties,function(t){var n=t.name;if(t.isVirtual)return!1;if(!e.hasOwnProperty(n))return!1;var r=e[n];return r!==t.default&&null!==r&&(!t.isMany||r.length)})}(e),this.parseAttributes(l(n,function(e){return e.isAttr})),this.parseContainments(function(e){return l(e,function(e){return!e.isAttr})}(n))),this.parseGenericAttributes(e,t),this},Ge.prototype.nsTagName=function(e){return Ve(this.logNamespaceUsed(e.ns),e)},Ge.prototype.nsPropertyTagName=function(e){return function(e,t){return S({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},Ge.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},Ge.prototype.nsAttributeName=function(e){var t;if(t=s(e)?F(e):e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:S({localName:t.localName},n)},Ge.prototype.parseGeneric=function(e){var t=this,n=this.body,r=[];return p(e,function(o,i){"$body"===i?n.push((new ze).build({type:"String"},o)):"$children"===i?p(o,function(e){n.push(new Ge(t).build(e))}):0!==i.indexOf("$")&&t.parseNsAttribute(e,i,o)&&r.push({name:i,value:o})}),r},Ge.prototype.parseNsAttribute=function(e,t,n){var r,o=e.$model,i=F(t);if("xmlns"===i.prefix&&(r={prefix:i.localName,uri:n}),i.prefix||"xmlns"!==i.localName||(r={uri:n}),!r)return{name:t,value:n};if(o&&o.getPackage(n))this.logNamespace(r,!0,!0);else{var a=this.logNamespaceUsed(r,!0);this.getNamespaces().logUsed(a)}},Ge.prototype.parseNsAttributes=function(e,t){var n=this,r=[];return p(e.$attrs,function(t,o){var i=n.parseNsAttribute(e,o,t);i&&r.push(i)}),r},Ge.prototype.parseGenericAttributes=function(e,t){var n=this;p(t,function(t){if(t.name!==me)try{n.addAttribute(n.nsAttributeName(t.name),t.value)}catch(n){console.warn("missing namespace information for ",t.name,"=",t.value,"on",e,n)}})},Ge.prototype.parseContainments=function(e){var t=this,n=this.body,r=this.element;p(e,function(e){var o=r.get(e.name),i=e.isReference;if(e.isMany||(o=[o]),e.isBody)n.push((new ze).build(e,o[0]));else if($(e.type))p(o,function(r){n.push(new We(t.addTagName(t.nsPropertyTagName(e))).build(e,r))});else if(i)p(o,function(r){n.push(new Ue(t.addTagName(t.nsPropertyTagName(e))).build(r))});else{var a=be(e),s=function(e){return"property"===ge(e)}(e);p(o,function(r){var o;o=a?new He(t,e):s?new Ge(t,e):new Ge(t),n.push(o.build(r))})}})},Ge.prototype.getNamespaces=function(e){var t,n=this.namespaces,r=this.parent;return n||(t=r&&r.getNamespaces(),e||!t?this.namespaces=n=new function(e){var t={},n={},r={},o=[],i=[];this.byUri=function(t){return n[t]||e&&e.byUri(t)},this.add=function(e,t){n[e.uri]=e,t?o.push(e):i.push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return t[e||"xmlns"]},this.mapPrefix=function(e,n){t[e||"xmlns"]=n},this.logUsed=function(e){var t=e.uri;r[t]=this.byUri(t)},this.getUsed=function(e){return[].concat(o,i).filter(function(e){return r[e.uri]})}}(t):n=t),n},Ge.prototype.logNamespace=function(e,t,n){var r=this.getNamespaces(n),o=e.uri,i=e.prefix;return r.byUri(o)||r.add(e,t),r.mapPrefix(i,o),e},Ge.prototype.logNamespaceUsed=function(e,t){var n,r,o,i=this.element.$model,a=this.getNamespaces(t),s=e.prefix,c=e.uri;if(!s&&!c)return{localName:e.localName};if(o=ye[s]||i&&(i.getPackage(s)||{}).uri,!(c=c||o||a.uriByPrefix(s)))throw new Error("no namespace uri given for prefix <"+s+">");if(!(e=a.byUri(c))){for(n=s,r=1;a.uriByPrefix(n);)n=s+"_"+r++;e=this.logNamespace({prefix:n,uri:c},o===c)}return s&&a.mapPrefix(s,c),e},Ge.prototype.parseAttributes=function(e){var t=this,n=this.element;p(e,function(e){var r=n.get(e.name);if(e.isReference)if(e.isMany){var o=[];p(r,function(e){o.push(e.id)}),r=o.join(" ")}else r=r.id;t.addAttribute(t.nsAttributeName(e),r)})},Ge.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),Ne(e)},Ge.prototype.addAttribute=function(e,t){var n=this.attrs;s(t)&&(t=Fe(t,Be,Le)),n.push({name:e,value:t})},Ge.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=function(e){return v(e.getUsed(),function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}})}(n).concat(t)),p(t,function(t){e.append(" ").append(Ne(t.name)).append('="').append(t.value).append('"')})},Ge.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==ze;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),p(this.body,function(t){t.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},Ie(He,Ge),He.prototype.parseNsAttributes=function(e){var t=Ge.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var r=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var o=e.$model.getPackage(r.uri),i=o.xml&&o.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(me),(r.prefix?r.prefix+":":"")+i+n.ns.localName),t},He.prototype.isLocalNs=function(e){return e.uri===this.typeNs.uri},qe.prototype=Object.create(q.prototype),qe.prototype.fromXML=function(e,t,n,r){s(t)||(r=n,n=t,t="dmn:Definitions"),a(n)&&(r=n,n={});var o=new Ae(S({model:this,lax:!0},n)),i=o.handler(t);o.fromXML(e,i,r)},qe.prototype.toXML=function(e,t,n){a(t)&&(n=t,t={});var r,o,i=new function(e){return e=S({format:!1,preamble:!0},e||{}),{toXML:function(t,n){var r=n||new function(){this.value="",this.write=function(e){this.value+=e}},o=new function(e,t){var n=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}(r,e.format);if(e.preamble&&o.append(Me),(new Ge).build(t).serializeTo(o),!n)return r.value}}}(t);try{r=i.toXML(e)}catch(e){o=e}return n(o,r)};var Ke={dmn:{name:"DMN",uri:"http://www.omg.org/spec/DMN/20151101/dmn.xsd",xml:{tagAlias:"lowerCase"},prefix:"dmn",types:[{name:"DMNElement",isAbstract:!0,properties:[{name:"description",type:"String"},{name:"id",type:"String",isAttr:!0,isId:!0},{name:"label",type:"String",isAttr:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"NamedElement",isAbstract:!0,superClass:["DMNElement"],properties:[{name:"name",type:"String",isAttr:!0}]},{name:"DMNElementReference",properties:[{name:"href",type:"String",isAttr:!0}]},{name:"ExtensionElements",properties:[{name:"values",type:"Element",isMany:!0}]},{name:"Definitions",superClass:["NamedElement"],properties:[{name:"namespace",type:"String",isAttr:!0},{name:"typeLanguage",type:"String",isAttr:!0,default:"http://www.omg.org/spec/FEEL/20140401"},{name:"expressionLanguage",type:"String",isAttr:!0,default:"http://www.omg.org/spec/FEEL/20140401"},{name:"exporter",type:"String",isAttr:!0},{name:"exporterVersion",type:"String",isAttr:!0},{name:"itemDefinition",type:"ItemDefinition",isMany:!0,xml:{serialize:"property"}},{name:"drgElements",type:"DRGElement",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"Import",properties:[{name:"namespace",type:"String",isAttr:!0},{name:"locationURI",type:"String",isAttr:!0},{name:"importType",type:"String",isAttr:!0}]},{name:"DRGElement",isAbstract:!0,superClass:["NamedElement"]},{name:"Decision",superClass:["DRGElement"],properties:[{name:"question",type:"String"},{name:"allowedAnswers",type:"String"},{name:"variable",type:"InformationItem",xml:{serialize:"property"}},{name:"informationRequirement",type:"InformationRequirement",isMany:!0,xml:{serialize:"property"}},{name:"knowledgeRequirement",type:"KnowledgeRequirement",isMany:!0,xml:{serialize:"property"}},{name:"authorityRequirement",type:"AuthorityRequirement",isMany:!0,xml:{serialize:"property"}},{name:"decisionTable",type:"DecisionTable",xml:{serialize:"property"}},{name:"literalExpression",type:"LiteralExpression",xml:{serialize:"property"}}]},{name:"BusinessKnowledgeModel",superClass:["DRGElement"],properties:[{name:"encapsulatedLogic",type:"FunctionDefinition"},{name:"variable",type:"InformationItem",xml:{serialize:"property"}},{name:"knowledgeRequirement",type:"KnowledgeRequirement",isMany:!0,xml:{serialize:"property"}},{name:"authorityRequirement",type:"AuthorityRequirement",isMany:!0,xml:{serialize:"property"}}]},{name:"InputData",superClass:["DRGElement"],properties:[{name:"variable",type:"InformationItem",xml:{serialize:"property"}}]},{name:"KnowledgeSource",superClass:["DRGElement"],properties:[{name:"authorityRequirement",type:"AuthorityRequirement",isMany:!0,xml:{serialize:"property"}},{name:"type",type:"String",isAttr:!0},{name:"owner",type:"DMNElementReference",isAttr:!0},{name:"locationURI",type:"String",isAttr:!0}]},{name:"InformationRequirement",properties:[{name:"requiredDecision",type:"DMNElementReference",xml:{serialize:"property"}},{name:"requiredInput",type:"DMNElementReference",xml:{serialize:"property"}}]},{name:"KnowledgeRequirement",properties:[{name:"requiredKnowledge",type:"DMNElementReference",isUnique:!0,xml:{serialize:"property"}}]},{name:"AuthorityRequirement",properties:[{name:"requiredDecision",type:"DMNElementReference",xml:{serialize:"property"}},{name:"requiredInput",type:"DMNElementReference",xml:{serialize:"property"}},{name:"requiredAuthority",type:"DMNElementReference",xml:{serialize:"property"}}]},{name:"Expression",isAbstract:!0,superClass:["DMNElement"],properties:[{name:"typeRef",type:"String",isAttr:!0}]},{name:"ItemDefinition",superClass:["NamedElement"],properties:[{name:"typeLanguage",type:"String",isAttr:!0},{name:"isCollection",type:"Boolean",isAttr:!0,default:!1},{name:"typeRef",type:"String"},{name:"allowedValues",type:"UnaryTests",isMany:!0,xml:{serialize:"property"}}]},{name:"LiteralExpression",superClass:["Expression"],properties:[{name:"expressionLanguage",type:"String",isAttr:!0},{name:"importedValues",type:"ImportedValues"},{name:"text",type:"String"}]},{name:"InformationItem",superClass:["NamedElement"],properties:[{name:"typeRef",type:"String",isAttr:!0}]},{name:"DecisionTable",superClass:["Expression"],properties:[{name:"input",type:"InputClause",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"OutputClause",isMany:!0,xml:{serialize:"property"}},{name:"rule",type:"DecisionRule",isMany:!0,xml:{serialize:"property"}},{name:"hitPolicy",type:"HitPolicy",isAttr:!0,default:"UNIQUE"},{name:"aggregation",type:"BuiltinAggregator",isAttr:!0},{name:"preferredOrientation",type:"DecisionTableOrientation",isAttr:!0,default:"Rule-as-Row"},{name:"outputLabel",type:"String",isAttr:!0}]},{name:"DecisionRule",superClass:["DMNElement"],properties:[{name:"inputEntry",type:"UnaryTests",isMany:!0,xml:{serialize:"property"}},{name:"outputEntry",type:"LiteralExpression",isMany:!0,xml:{serialize:"property"}}]},{name:"ImportedValues",superClass:["Import"],properties:[{name:"importedElement",type:"String",isMany:!0,xml:{serialize:"property"}},{name:"expressionLanguage",type:"String",isAttr:!0}]},{name:"Artifact",isAbstract:!0,superClass:["DMNElement"]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String",xml:{serialize:"property"}},{name:"textFormat",type:"String",isAttr:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"sourceRef",type:"DMNElementReference",xml:{serialize:"property"}},{name:"targetRef",type:"DMNElementReference",xml:{serialize:"property"}},{name:"associationDirection",type:"AssociationDirection",isAttr:!0,default:"None"}]},{name:"InputClause",superClass:["DMNElement"],properties:[{name:"inputExpression",type:"LiteralExpression",xml:{serialize:"property"}},{name:"inputValues",type:"UnaryTests",xml:{serialize:"property"}}]},{name:"OutputClause",superClass:["DMNElement"],properties:[{name:"outputValues",type:"UnaryTests",xml:{serialize:"property"}},{name:"defaultOutputEntry",type:"LiteralExpression",xml:{serialize:"property"}},{name:"name",type:"String",isAttr:!0},{name:"typeRef",type:"String",isAttr:!0}]},{name:"UnaryTests",superClass:["DMNElement"],properties:[{name:"text",type:"String"},{name:"expressionLanguage",type:"String",isAttr:!0}]},{name:"FunctionDefinition",superClass:["Expression"],properties:[{name:"formalParameter",type:"InformationItem",isMany:!0,xml:{serialize:"property"}},{name:"expression",type:"String",isReference:!0,xml:{serialize:"property"}}]}],emumerations:[{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"HitPolicy",literalValues:[{name:"UNIQUE"},{name:"FIRST"},{name:"PRIORITY"},{name:"ANY"},{name:"COLLECT"},{name:"RULE ORDER"},{name:"OUTPUT ORDER"}]},{name:"BuiltinAggregator",literalValues:[{name:"SUM"},{name:"COUNT"},{name:"MIN"},{name:"MAX"}]},{name:"DecisionTableOrientation",literalValues:[{name:"Rule-as-Row"},{name:"Rule-as-Column"},{name:"CrossTable"}]}]},camunda:{name:"Camunda",uri:"http://camunda.org/schema/1.0/dmn",prefix:"camunda",xml:{tagAlias:"lowerCase"},types:[{name:"InputVariable",extends:["dmn:InputClause"],properties:[{name:"inputVariable",isAttr:!0,type:"String"}]}]},dc:{name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]},biodi:{name:"bpmn.io DI for DMN",uri:"http://bpmn.io/schema/dmn/biodi/1.0",prefix:"biodi",xml:{tagAlias:"lowerCase"},types:[{name:"Edge",superClass:["Element"],properties:[{name:"source",type:"String",isAttr:!0},{name:"waypoints",type:"Waypoint",isMany:!0,xml:{serialize:"property"}}]},{name:"Bounds",superClass:["dc:Bounds","Element"]},{name:"Waypoint",superClass:["dc:Point"]}]}};function Xe(e,t,n){return 2==arguments.length?e.getAttribute(t):null===n?e.removeAttribute(t):(e.setAttribute(t,n),e)}var Ye=[].indexOf,Ze=function(e,t){if(Ye)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},Je=/\s+/,Qe=Object.prototype.toString;function et(e){return new tt(e)}function tt(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function nt(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}tt.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~Ze(t,e)||t.push(e),this.el.className=t.join(" "),this},tt.prototype.remove=function(e){if("[object RegExp]"==Qe.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=Ze(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},tt.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},tt.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},tt.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(Je);return""===e[0]&&e.shift(),e},tt.prototype.has=tt.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Ze(this.array(),e)};var rt=Element.prototype,ot=rt.matchesSelector||rt.webkitMatchesSelector||rt.mozMatchesSelector||rt.msMatchesSelector||rt.oMatchesSelector,it=function(e,t){if(ot)return ot.call(e,t);for(var n=e.parentNode.querySelectorAll(t),r=0;r<n.length;++r)if(n[r]==e)return!0;return!1};var at,st=function(e,t,n){for(var r=n?e:e.parentNode;r&&r!==document;){if(it(r,t))return r;r=r.parentNode}},ct=window.addEventListener?"addEventListener":"attachEvent",ut=window.removeEventListener?"removeEventListener":"detachEvent",lt="addEventListener"!==ct?"on":"",pt={bind:function(e,t,n,r){return e[ct](lt+t,n,r||!1),n},unbind:function(e,t,n,r){return e[ut](lt+t,n,r||!1),n}},ft=["focus","blur"],dt={bind:function(e,t,n,r,o){return-1!==ft.indexOf(n)&&(o=!0),pt.bind(e,n,function(n){var o=n.target||n.srcElement;n.delegateTarget=st(o,t,!0,e),n.delegateTarget&&r.call(e,n)},o)},unbind:function(e,t,n,r){-1!==ft.indexOf(t)&&(r=!0),pt.unbind(e,t,n,r)}},ht=function(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var r=n[1];if("body"==r){var o=t.createElement("html");return o.innerHTML=e,o.removeChild(o.lastChild)}var i=yt[r]||yt._default,a=i[0],s=i[1],c=i[2];(o=t.createElement("div")).innerHTML=s+e+c;for(;a--;)o=o.lastChild;if(o.firstChild==o.lastChild)return o.removeChild(o.firstChild);var u=t.createDocumentFragment();for(;o.firstChild;)u.appendChild(o.removeChild(o.firstChild));return u},vt=!1;"undefined"!=typeof document&&((at=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',vt=!at.getElementsByTagName("link").length,at=void 0);var yt={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:vt?[1,"X<div>","</div>"]:[0,"",""]};yt.td=yt.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],yt.option=yt.optgroup=[1,'<select multiple="multiple">',"</select>"],yt.thead=yt.tbody=yt.colgroup=yt.caption=yt.tfoot=[1,"<table>","</table>"],yt.polyline=yt.ellipse=yt.polygon=yt.circle=yt.text=yt.line=yt.path=yt.rect=yt.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var mt="undefined"!=typeof Element?Element.prototype:{},gt=mt.matches||mt.matchesSelector||mt.webkitMatchesSelector||mt.mozMatchesSelector||mt.msMatchesSelector||mt.oMatchesSelector,bt=function(e,t){if(!e||1!==e.nodeType)return!1;if(gt)return gt.call(e,t);for(var n=e.parentNode.querySelectorAll(t),r=0;r<n.length;r++)if(n[r]==e)return!0;return!1};function _t(e,t){return(t=t||document).querySelector(e)}function wt(e,t){return(t=t||document).querySelectorAll(e)}function xt(e){e.parentNode&&e.parentNode.removeChild(e)}var Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function kt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var jt={width:"100%",height:"100%",position:"relative"},St=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewsChanged=function(){t._emit("views.changed",{views:t._views,activeView:t._activeView})},this._eventBus=new A,this._viewsChanged=O(this._viewsChanged,0),this._views=[],this._viewers={},this._init(n)}return Ot(e,[{key:"importXML",value:function(e,t,n){var r=this;"object"!==(void 0===t?"undefined":Et(t))&&(n=t,t={open:!0}),"function"!=typeof n&&(n=Pt),e=this._emit("import.parse.start",{xml:e})||e,this._moddle.fromXML(e,"dmn:Definitions",function(e,o,i){o=r._emit("import.parse.complete",{error:e,definitions:o,context:i})||o;var a=i.warnings;if(r._setDefinitions(o),e&&(e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid DMN 1.1 diagram file"+t[2]);return e}(e)),e||!t.open)return r._emit("import.done",{error:e,warmings:a}),n(e,a);var s=r._activeView||r._getInitialView(r._views);if(!s)return n(new Error("no displayable contents"));r.open(s,function(e,t){var o=[].concat(a,t||[]);r._emit("import.done",{error:e,warnings:o}),n(e,o)})})}},{key:"getDefinitions",value:function(){return this._definitions}},{key:"getActiveView",value:function(){return this._activeView}},{key:"getActiveViewer",value:function(){var e=this.getActiveView();return e&&this._getViewer(e)}},{key:"getView",value:function(e){return this._views.filter(function(t){return t.element===e})[0]}},{key:"getViews",value:function(){return this._views}},{key:"saveXML",value:function(e,t){"function"==typeof e&&(t=e,e={});var n=this._definitions;if(!n)return t(new Error("no definitions loaded"));this._moddle.toXML(n,e,t)}},{key:"on",value:function(){var e;(e=this._eventBus).on.apply(e,arguments)}},{key:"off",value:function(){var e;(e=this._eventBus).off.apply(e,arguments)}},{key:"once",value:function(){var e;(e=this._eventBus).once.apply(e,arguments)}},{key:"attachTo",value:function(e){e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=_t(e)),e.appendChild(this._container)}},{key:"detach",value:function(){xt(this._container)}},{key:"destroy",value:function(){var e=this;Object.keys(this._viewers,function(t){Mt(e._viewers[t],"destroy")}),xt(this._container)}},{key:"_init",value:function(e){this._options=e,this._moddle=this._createModdle(e),this._viewers={},this._views=[];var t=ht('<div class="dmn-js-parent"></div>'),n=S({},jt,e);S(t.style,{width:Tt(n.width),height:Tt(n.height),position:n.position}),this._container=t,e.container&&this.attachTo(e.container)}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt;this._switchView(e,t)}},{key:"_setDefinitions",value:function(e){this._definitions=e,this._updateViews()}},{key:"_updateViews",value:function(){var e=this._definitions;if(!e)return this._views=[],void this._switchView(null);var t=this._getViewProviders(),n=[e].concat(kt(e.drgElements||[]));this._views=n.reduce(function(e,n){var r=Rt(t,function(e){return"string"==typeof e.opens?e.opens===n.$type:e.opens(n)});if(!r)return e;var o={element:n,type:r.id};return[].concat(kt(e),[o])},[]);var r,o=this._activeView;if(o){if(r=Rt(this._views,function(e){return At(o,e)})||this._getInitialView(this._views),!At(o,r))return this._switchView(null);this._activeView=r}this._viewsChanged()}},{key:"_getInitialView",value:function(e){return e[0]}},{key:"_switchView",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt,o=function(e,t){n._viewsChanged(),r(e,t)},i=this.getActiveView(),a=e&&this._getViewer(e),s=e&&e.element;if(i&&(t=this._getViewer(i))!==a&&(Mt(t,"clear"),t.detach()),this._activeView=e,a)return t!==a&&a.attachTo(this._container),this._emit("import.render.start",{view:e,element:s}),a.open(s,function(t,r){n._emit("import.render.complete",{view:e,error:t,warnings:r}),o(t,r)});o()}},{key:"_getViewer",value:function(e){var t=e.type,n=this._viewers[t];return n||(n=this._viewers[t]=this._createViewer(e.type),this._emit("viewer.created",{type:t,viewer:n})),n}},{key:"_createViewer",value:function(e){var t=Rt(this._getViewProviders(),function(t){return t.id===e});if(!t)throw new Error("no provider for view type <"+e+">");var n=t.constructor,r=this._options[e]||{},o=this._options.common||{};return new n(Ct({},o,r,{additionalModules:[].concat(kt(r.additionalModules||[]),[{_parent:["value",this],moddle:["value",this._moddle]}])}))}},{key:"_emit",value:function(){var e;(e=this._eventBus).fire.apply(e,arguments)}},{key:"_createModdle",value:function(e){return new function(e,t){return new qe(S({},Ke,e),t)}(e.moddleExtensions||{})}},{key:"_getViewProviders",value:function(){return[]}}]),e}();function Pt(){}function Tt(e){return e+(i(e)?"px":"")}function Rt(e,t){return e.filter(t)[0]}function At(e,t){return void 0===e?void 0===t:void 0!==t&&(e.element===t.element||e.element.id===t.element.id)}function Mt(e,t){"function"==typeof e[t]&&e[t]()}var Bt=X(function(e){var t=e.exports=function(e,n){if(n||(n=16),void 0===e&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(n),o=2;r===1/0;o*=2)r=Math.log(Math.pow(2,e/o))/Math.log(n)*o;var i=r-Math.floor(r),a="";for(o=0;o<Math.floor(r);o++){a=Math.floor(Math.random()*n).toString(n)+a}if(i){var s=Math.pow(n,i);a=Math.floor(Math.random()*s).toString(n)+a}var c=parseInt(a,n);return c!==1/0&&c>=Math.pow(2,e)?t(e,n):a};t.rack=function(e,n,r){var o=function(o){var a=0;do{if(a++>10){if(!r)throw new Error("too many ID collisions, use more bits");e+=r}var s=t(e,n)}while(Object.hasOwnProperty.call(i,s));return i[s]=o,s},i=o.hats={};return o.get=function(e){return o.hats[e]},o.set=function(e,t){return o.hats[e]=t,o},o.bits=e||128,o.base=n||16,o}});function Dt(e){if(!(this instanceof Dt))return new Dt(e);e=e||[128,36,1],this._seed=e.length?Bt.rack(e[0],e[1],e[2]):e}var It=Dt;function Nt(e,t){var n=$t(e);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(t)}function Vt(e){return Nt(e,"dmn:InputClause")}function Lt(e){return Nt(e,"dmn:OutputClause")}function $t(e){return e&&e.businessObject||e}function Ft(e,t){return h(t,function(t){return Nt(e,t)})}Dt.prototype.next=function(e){return this._seed(e||!0)},Dt.prototype.nextPrefixed=function(e,t){var n;do{n=e+this.next(!0)}while(this.assigned(n));return this.claim(n,t),n},Dt.prototype.claim=function(e,t){this._seed.set(e,t||!0)},Dt.prototype.assigned=function(e){return this._seed.get(e)||!1},Dt.prototype.unclaim=function(e){delete this._seed.hats[e]},Dt.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};var Ut=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),zt=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0};var Wt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,St),Ut(t,[{key:"_init",value:function(e){var n=this;zt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_init",this).call(this,e),this.on("import.parse.complete",function(e){e.error||n._collectIds(e.definitions,e.context)}),this.on("destroy",function(){n._moddle.ids.clear()}),this.on("viewer.created",function(e){e.viewer.on("elements.changed",function(e){e.elements.some(function(e){return Ft(e,["dmn:Decision","dmn:Definitions"])})&&n._updateViews()})})}},{key:"_collectIds",value:function(e,t){var n,r=e.$model.ids;for(n in r.clear(),t.elementsById)r.claim(n,t.elementsById[n])}},{key:"_createModdle",value:function(e){var n=zt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createModdle",this).call(this,e);return n.ids=new It([32,36,1]),n}}]),t}(),Gt=X(function(e){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt=/^class /;function Kt(e){return"[object Array]"===Object.prototype.toString.call(e)}function Xt(){var e=Array.prototype.slice.call(arguments);1===e.length&&Kt(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Yt=/constructor\s*[^(]*\(\s*([^)]*)\)/m,Zt=/^function\s*[^(]*\(\s*([^)]*)\)/m,Jt=/\/\*([^*]*)\*\//m;function Qt(e){if("function"!=typeof e)throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(function(e){return qt.test(e.toString())}(e)?Yt:Zt);return t&&t[1]&&t[1].split(",").map(function(e){return(t=e.match(Jt))?t[1].trim():e.trim()})||[]}var en="function"==typeof Symbol&&"symbol"===Ht(Symbol.iterator)?function(e){return void 0===e?"undefined":Ht(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":Ht(e)};function tn(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function nn(e,t){t=t||{get:function(e,t){if(n.push(e),!1===t)return null;throw a('No provider for "'+e+'"!')}};var n=[],r=this._providers=Object.create(t._providers||null),o=this._instances=Object.create(null),i=o.injector=this,a=function(e){var t=n.join(" -> ");return n.length=0,new Error(t?e+" (Resolving: "+t+")":e)},s=function e(i,s){if(!r[i]&&-1!==i.indexOf(".")){for(var c=i.split("."),u=e(c.shift());c.length;)u=u[c.shift()];return u}if(rn(o,i))return o[i];if(rn(r,i)){if(-1!==n.indexOf(i))throw n.push(i),a("Cannot resolve circular dependency!");return n.push(i),o[i]=r[i][0](r[i][1]),n.pop(),o[i]}return t.get(i,s)},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof e){if(!Kt(e))throw new Error('Cannot invoke "'+e+'". Expected a function!');e=Xt(e.slice())}return{fn:e,dependencies:(e.$inject||Qt(e)).map(function(e){return rn(t,e)?t[e]:s(e)})}},u=function(e){var t=c(e),n=t.dependencies,r=t.fn;return new(Function.prototype.bind.apply(r,[null].concat(tn(n))))},l=function(e,t,n){var r=c(e,n),o=r.dependencies,i=r.fn;return i.call.apply(i,[t].concat(tn(o)))},p=function(e){return Xt(function(t){return e.get(t)})},f={factory:l,type:u,value:function(e){return e}};e.forEach(function(e){function t(e,t){return"value"!==e&&Kt(t)&&(t=Xt(t.slice())),t}if(e instanceof function(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}})e.forEach(function(e){var n=e[0],o=e[1],i=e[2];r[n]=[f[o],t(o,i),o]});else if("object"===(void 0===e?"undefined":en(e)))if(e.__exports__){var n=Object.keys(e).reduce(function(t,n){return"__"!==n.substring(0,2)&&(t[n]=e[n]),t},Object.create(null)),o=new nn((e.__modules__||[]).concat([n]),i),a=Xt(function(e){return o.get(e)});e.__exports__.forEach(function(e){r[e]=[a,e,"private",o]})}else Object.keys(e).forEach(function(n){if("private"!==e[n][2]){var o=e[n][0],i=e[n][1];r[n]=[f[o],t(o,i),o]}else r[n]=e[n]})}),this.get=s,this.invoke=l,this.instantiate=u,this.createChild=function(e,t){if(t&&t.length){var n,o,a,s,c=Object.create(null),u=Object.create(null),l=[],f=[],d=[];for(var h in r)n=r[h],-1!==t.indexOf(h)&&("private"===n[2]?-1===(o=l.indexOf(n[3]))?(a=n[3].createChild([],t),s=p(a),l.push(n[3]),f.push(a),d.push(s),c[h]=[s,h,"private",a]):c[h]=[d[o],h,"private",f[o]]:c[h]=[n[2],n[1]],u[h]=!0),"factory"!==n[2]&&"type"!==n[2]||!n[1].$scope||t.forEach(function(e){-1!==n[1].$scope.indexOf(e)&&(c[h]=[n[2],n[1]],u[e]=!0)});t.forEach(function(e){if(!u[e])throw new Error('No provider for "'+e+'". Cannot use provider from the parent!')}),e.unshift(c)}return new nn(e,i)}}function rn(e,t){return Object.hasOwnProperty.call(e,t)}var on=1e3;function an(e,t){var n=this;t=t||on,e.on(["render.shape","render.connection"],t,function(e,t){var r=e.type,o=t.element,i=t.gfx;if(n.canRender(o))return"render.shape"===r?n.drawShape(i,o):n.drawConnection(i,o)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(e,t){if(n.canRender(t))return"render.getShapePath"===e.type?n.getShapePath(t):n.getConnectionPath(t)})}function sn(e,t){return t.appendChild(function(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}(e,t)),e}function cn(e,t){return sn(t,e),e}an.prototype.canRender=function(){},an.prototype.drawShape=function(){},an.prototype.drawConnection=function(){},an.prototype.getShapePath=function(){},an.prototype.getConnectionPath=function(){};var un=2,ln={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":un,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":un,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function pn(e,t,n){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=ln[r];o?(o===un&&"number"==typeof n&&(n=String(n)+"px"),e.style[r]=n):e.setAttributeNS(null,t,n)}function fn(e,t,n){if("string"==typeof t){if(void 0===n)return function(e,t){return ln[t]?e.style[t]:e.getAttributeNS(null,t)}(e,t);pn(e,t,n)}else!function(e,t){var n,r,o=Object.keys(t);for(n=0;r=o[n];n++)pn(e,r,t[r])}(e,t);return e}function dn(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var hn=/\s+/,vn=Object.prototype.toString;function yn(e){return void 0!==e}function mn(e){return new gn(e)}function gn(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function bn(e){var t=e.parentNode;return t&&t.removeChild(e),e}function _n(e){for(var t;t=e.firstChild;)bn(t);return e}gn.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~dn(t,e)||t.push(e),yn(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this},gn.prototype.remove=function(e){if("[object RegExp]"===vn.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=dn(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this},gn.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},gn.prototype.toggle=function(e,t){return this.list?(yn(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(yn(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},gn.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(hn);return""===e[0]&&e.shift(),e},gn.prototype.has=gn.prototype.contains=function(e){return this.list?this.list.contains(e):!!~dn(this.array(),e)};var wn={svg:"http://www.w3.org/2000/svg"},xn='<svg xmlns="'+wn.svg+'"';function Cn(e){return"<svg"===e.substring(0,4)?-1===e.indexOf(wn.svg)&&(e=xn+e.substring(4)):e=xn+">"+e+"</svg>",function(e){var t;return(t=new DOMParser).async=!1,t.parseFromString(e,"text/xml")}(e)}function En(e,t){var n;return"<"===e.charAt(0)?(n=Cn(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(wn.svg,e),t&&fn(n,t),n}var On=En("svg");function kn(e,t,n,r,o,i){var a=On.createSVGMatrix();switch(arguments.length){case 0:return a;case 6:e={a:e,b:t,c:n,d:r,e:o,f:i}}return function(e,t){var n,r,o=Object.keys(t);for(n=0;r=o[n];n++)e[r]=t[r];return e}(a,e)}function jn(e){return e?On.createSVGTransformFromMatrix(e):On.createSVGTransform()}var Sn=/([&<>]{1})/g,Pn=/([\n\r"]{1})/g,Tn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Rn(e,t){return e.replace(t,function(e,t){return Tn[t]||t})}function An(e,t){var n,r,o,i,a;switch(e.nodeType){case 3:t.push(Rn(e.textContent,Sn));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(n=0,r=(o=e.attributes).length;n<r;++n)i=o.item(n),t.push(" ",i.name,'="',Rn(i.value,Pn),'"');if(e.hasChildNodes()){for(t.push(">"),n=0,r=(a=e.childNodes).length;n<r;++n)An(a.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("\x3c!--",Rn(e.nodeValue,Sn),"--\x3e");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function Mn(e,t){if(void 0!==t){try{!function(e,t){var n,r=Cn(t).documentElement;if(_n(e),t)for(n=r.firstChild;n;)sn(n,e),n=n.nextSibling}(e,t)}catch(e){throw new Error("error parsing SVG: "+e.message)}return e}return function(e){for(var t=e.firstChild,n=[];t;)An(t,n),t=t.nextSibling;return n.join("")}(e)}function Bn(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function Dn(e,t){var n=e.transform.baseVal;if(1===arguments.length)return n.consolidate();t.length?function(e,t){var n,r;for(e.clear(),n=0;r=t[n];n++)e.appendItem(Bn(e,r));e.consolidate()}(n,t):n.initialize(Bn(n,t))}function In(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Nn(e){for(var t,n="",r=0;t=e[r];r++)n+=t.x+","+t.y+" ";return n}function Vn(e,t){var n=En("polyline");return fn(n,{points:Nn(e)}),t&&fn(n,t),n}var Ln=1;function $n(e,t){an.call(this,e,Ln),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2})}Gt($n,an),$n.prototype.canRender=function(){return!0},$n.prototype.drawShape=function(e,t){var n=En("rect");return fn(n,{x:0,y:0,width:t.width||0,height:t.height||0}),fn(n,this.SHAPE_STYLE),cn(e,n),n},$n.prototype.drawConnection=function(e,t){var n=Vn(t.waypoints,this.CONNECTION_STYLE);return cn(e,n),n},$n.prototype.getShapePath=function(e){var t=e.x,n=e.y,r=e.width;return In([["M",t,n],["l",r,0],["l",0,e.height],["l",-r,0],["z"]])},$n.prototype.getConnectionPath=function(e){var t,n,r=e.waypoints,o=[];for(t=0;n=r[t];t++)n=n.original||n,o.push([0===t?"M":"L",n.x,n.y]);return In(o)},$n.$inject=["eventBus","styles"];var Fn={__init__:["defaultRenderer"],defaultRenderer:["type",$n],styles:["type",function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(e,t,n){return S(this.style(t,n),{class:e})},this.style=function(t,n){r(t)||n||(n=t,t=[]);var o=f(t,function(t,n){return S(t,e[n]||{})},{});return n?S(o,n):o},this.computeStyle=function(e,n,o){return r(n)||(o=n,n=[]),t.style(n||[],S({},o,e||{}))}}]};function Un(e,t){if(!e||!t)return-1;var n=e.indexOf(t);return-1!==n&&e.splice(n,1),n}function zn(e,t,n){if(e&&t){"number"!=typeof n&&(n=-1);var r=e.indexOf(t);if(-1!==r){if(r===n)return;if(-1===n)return;e.splice(r,1)}-1!==n?e.splice(n,0,t):e.push(t)}}function Wn(e,t){return e&&t?e.indexOf(t):-1}function Gn(e,t,n){var r=!n||-1===e.indexOf(t);return r&&e.push(t),r}function Hn(e,t,n){n=n||0,r(e)||(e=[e]),p(e,function(e,o){var i=t(e,o,n);r(i)&&i.length&&Hn(i,t,n+1)})}function qn(e,t){return function(e,t,n){var r=[],o=[];return Hn(e,function(e,i,a){Gn(r,e,t);var s=e.children;if((-1===n||a<n)&&s&&Gn(o,s,t))return s}),r}(e,!t,-1)}function Kn(e,t){var n,o,i,a;return t=!!t,r(e)||(e=[e]),p(e,function(e){var r=e;e.waypoints&&!t&&(r=Kn(e.waypoints,!0));var s=r.x,c=r.y,u=r.height||0,l=r.width||0;(s<n||void 0===n)&&(n=s),(c<o||void 0===o)&&(o=c),(s+l>i||void 0===i)&&(i=s+l),(c+u>a||void 0===a)&&(a=c+u)}),{x:n,y:o,height:a-o,width:i-n}}function Xn(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}var Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Zn(e,t){return Math.round(e*t)/t}function Jn(e){return i(e)?e+"px":e}function Qn(e,t,n){var r=En("g");mn(r).add(t);var o=void 0!==n?n:e.childNodes.length-1;return e.insertBefore(r,e.childNodes[o]),r}var er={shape:["x","y","width","height"],connection:["waypoints"]};function tr(e,t,n,r){this._eventBus=t,this._elementRegistry=r,this._graphicsFactory=n,this._init(e||{})}function nr(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}tr.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],tr.prototype._init=function(e){var t=this._eventBus,n=this._container=function(e){var t=(e=S({},{width:"100%",height:"100%"},e)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),S(n.style,{position:"relative",overflow:"hidden",width:Jn(e.width),height:Jn(e.height)}),t.appendChild(n),n}(e),r=this._svg=En("svg");fn(r,{width:"100%",height:"100%"}),cn(n,r);var o=this._viewport=Qn(r,"viewport");this._layers={},!1!==e.deferUpdate&&(this._viewboxChanged=O(k(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:r,viewport:o})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)},tr.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},tr.prototype._clear=function(){var e=this;this._elementRegistry.getAll().forEach(function(t){var n=Xn(t);"root"===n?e.setRootElement(null,!0):e._removeElement(t,n)}),delete this._cachedViewbox},tr.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},tr.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),void 0!==t&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group},tr.prototype._createLayer=function(e,t){t||(t=0);var n=f(this._layers,function(e,n){return t>=n.index&&e++,e},0);return{group:Qn(this._viewport,"layer-"+e,n),index:t}},tr.prototype.getContainer=function(){return this._container},tr.prototype._updateMarker=function(e,t,n){var r;e.id||(e=this._elementRegistry.get(e)),(r=this._elementRegistry._elements[e.id])&&(p([r.gfx,r.secondaryGfx],function(e){e&&(n?mn(e).add(t):mn(e).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:r.gfx,marker:t,add:!!n}))},tr.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},tr.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},tr.prototype.hasMarker=function(e,t){return e.id||(e=this._elementRegistry.get(e)),mn(this.getGraphics(e)).has(t)},tr.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},tr.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},tr.prototype.setRootElement=function(e,t){e&&this._ensureValid("root",e);var n=this._rootElement,r=this._elementRegistry,o=this._eventBus;if(n){if(!t)throw new Error("rootElement already set, need to specify override");o.fire("root.remove",{element:n}),o.fire("root.removed",{element:n}),r.remove(n)}if(e){var i=this.getDefaultLayer();o.fire("root.add",{element:e}),r.add(e,i,this._svg),o.fire("root.added",{element:e,gfx:i})}return this._rootElement=e,e},tr.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=er[e];if(!d(n,function(e){return void 0!==t[e]}))throw new Error("must supply { "+n.join(", ")+" } with "+e)},tr.prototype._setParent=function(e,t,n){zn(t.children,e,n),e.parent=t},tr.prototype._addElement=function(e,t,n,r){n=n||this.getRootElement();var o=this._eventBus,i=this._graphicsFactory;this._ensureValid(e,t),o.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,r);var a=i.create(e,t,r);return this._elementRegistry.add(t,a),i.update(e,t,a),o.fire(e+".added",{element:t,gfx:a}),t},tr.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)},tr.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)},tr.prototype._removeElement=function(e,t){var n=this._elementRegistry,r=this._graphicsFactory,o=this._eventBus;if(e=n.get(e.id||e))return o.fire(t+".remove",{element:e}),r.remove(e),Un(e.parent&&e.parent.children,e),e.parent=null,o.fire(t+".removed",{element:e}),n.remove(e),e},tr.prototype.removeShape=function(e){return this._removeElement(e,"shape")},tr.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},tr.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},tr.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},tr.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},tr.prototype.viewbox=function(e){if(void 0===e&&this._cachedViewbox)return this._cachedViewbox;var t,n,r,o,i,a,s=this._viewport,c=this.getSize();return e?(this._changeViewbox(function(){o=Math.min(c.width/e.width,c.height/e.height);var t=this._svg.createSVGMatrix().scale(o).translate(-e.x,-e.y);Dn(s,t)}),e):(t=this.getDefaultLayer().getBBox(),n=(r=Dn(s))?r.matrix:kn(),o=Zn(n.a,1e3),i=Zn(-n.e||0,1e3),a=Zn(-n.f||0,1e3),e=this._cachedViewbox={x:i?i/o:0,y:a?a/o:0,width:c.width/o,height:c.height/o,scale:o,inner:{width:t.width,height:t.height,x:t.x,y:t.y},outer:c})},tr.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=S({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),nr(t,n)}),{x:n.e,y:n.f}},tr.prototype.zoom=function(e,t){return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox(function(){"object"!==(void 0===t?"undefined":Yn(t))&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),r=this._setZoom(e,t)}),Zn(r.a,1e3)):this.viewbox(e).scale;var n,r},tr.prototype._fitViewport=function(e){var t,n,r=this.viewbox(),o=r.outer,i=r.inner;return i.x>=0&&i.y>=0&&i.x+i.width<=o.width&&i.y+i.height<=o.height&&!e?n={x:0,y:0,width:Math.max(i.width+i.x,o.width),height:Math.max(i.height+i.y,o.height)}:(t=Math.min(1,o.width/i.width,o.height/i.height),n={x:i.x+(e?i.width/2-o.width/t/2:0),y:i.y+(e?i.height/2-o.height/t/2:0),width:o.width/t,height:o.height/t}),this.viewbox(n),this.viewbox(!1).scale},tr.prototype._setZoom=function(e,t){var n,r,o,i,a=this._svg,s=this._viewport,c=a.createSVGMatrix(),u=a.createSVGPoint(),l=(r=s.getCTM()).a;return t?(n=S(u,t).matrixTransform(r.inverse()),o=c.translate(n.x,n.y).scale(1/l*e).translate(-n.x,-n.y),i=r.multiply(o)):i=c.scale(e),nr(this._viewport,i),i},tr.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},tr.prototype.getAbsoluteBBox=function(e){var t,n=this.viewbox();e.waypoints?t=this.getGraphics(e).getBBox():t=e;return{x:t.x*n.scale-n.x*n.scale,y:t.y*n.scale-n.y*n.scale,width:t.width*n.scale,height:t.height*n.scale}},tr.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var rr="data-element-id";function or(e){this._elements={},this._eventBus=e}or.$inject=["eventBus"],or.prototype.add=function(e,t,n){var r=e.id;this._validateId(r),fn(t,rr,r),n&&fn(n,rr,r),this._elements[r]={element:e,gfx:t,secondaryGfx:n}},or.prototype.remove=function(e){var t=this._elements,n=e.id||e,r=n&&t[n];r&&(fn(r.gfx,rr,""),r.secondaryGfx&&fn(r.secondaryGfx,rr,""),delete t[n])},or.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),r=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,r)},or.prototype.get=function(e){var t;t="string"==typeof e?e:e&&fn(e,rr);var n=this._elements[t];return n&&n.element},or.prototype.filter=function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(n)}),t},or.prototype.getAll=function(){return this.filter(function(e){return e})},or.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var r=t[n],o=r.element,i=r.gfx;return e(o,i)})},or.prototype.getGraphics=function(e,t){var n=e.id||e,r=this._elements[n];return r&&(t?r.secondaryGfx:r.gfx)},or.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var ir={extend:function(e,t,n,r){var o=n.inverse;return Object.defineProperty(e,"remove",{value:function(e){var n=this.indexOf(e);return-1!==n&&(this.splice(n,1),t.unset(e,o,r)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,n){var i=this.indexOf(e);if(void 0===n){if(-1!==i)return;n=this.length}-1!==i&&this.splice(i,1),this.splice(n,0,e),-1===i&&t.set(e,o,r)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e},isExtended:function(e){return!0===e.__refs_collection}};function ar(e,t,n){var r=ir.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:r}),r.length&&r.forEach(function(r){e.set(r,t.inverse,n)})}function sr(e,t){if(!(this instanceof sr))return new sr(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}sr.prototype.bind=function(e,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?ar(this,t,e):function(e,t,n){var r=t.inverse,o=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return o},set:function(t){if(t!==o){var i=o;o=null,i&&e.unset(i,r,n),o=t,e.set(o,r,n)}}})}(this,t,e)},sr.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return ir.isExtended(n)||ar(this,t,e),n},sr.prototype.ensureBound=function(e,t){(function(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)})(e,t)||this.bind(e,t)},sr.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)},sr.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var cr=sr,ur=ir;cr.Collection=ur;var lr=new cr({name:"children",enumerable:!0,collection:!0},{name:"parent"}),pr=new cr({name:"label",enumerable:!0},{name:"labelTarget"}),fr=new cr({name:"attachers",collection:!0},{name:"host"}),dr=new cr({name:"outgoing",collection:!0},{name:"source"}),hr=new cr({name:"incoming",collection:!0},{name:"target"});function vr(){Object.defineProperty(this,"businessObject",{writable:!0}),lr.bind(this,"parent"),pr.bind(this,"label"),dr.bind(this,"outgoing"),hr.bind(this,"incoming")}function yr(){vr.call(this),lr.bind(this,"children"),fr.bind(this,"host"),fr.bind(this,"attachers")}function mr(){yr.call(this)}function gr(){yr.call(this),pr.bind(this,"labelTarget")}function br(){vr.call(this),dr.bind(this,"source"),hr.bind(this,"target")}Gt(yr,vr),Gt(mr,yr),Gt(gr,yr),Gt(br,vr);var _r={connection:br,shape:yr,label:gr,root:mr};function wr(){this._uid=12}function xr(e,t,n){var r=jn();r.setTranslate(t,n),Dn(e,r)}function Cr(e,t){this._eventBus=e,this._elementRegistry=t}function Er(e,t,n){t.insertBefore(e,n||t.firstChild)}wr.prototype.createRoot=function(e){return this.create("root",e)},wr.prototype.createLabel=function(e){return this.create("label",e)},wr.prototype.createShape=function(e){return this.create("shape",e)},wr.prototype.createConnection=function(e){return this.create("connection",e)},wr.prototype.create=function(e,t){return(t=S({},t||{})).id||(t.id=e+"_"+this._uid++),function(e,t){var n=_r[e];if(!n)throw new Error("unknown type: <"+e+">");return S(new n,t)}(e,t)},Cr.$inject=["eventBus","elementRegistry"],Cr.prototype._getChildren=function(e){var t,n=this._elementRegistry.getGraphics(e);return e.parent?(t=function(e){return e.parentNode.childNodes[1]}(n))||(mn(t=En("g")).add("djs-children"),cn(n.parentNode,t)):t=n,t},Cr.prototype._clear=function(e){var t=function(e){return _t(".djs-visual",e)}(e);return nt(t),t},Cr.prototype._createContainer=function(e,t,n){var r=En("g");mn(r).add("djs-group"),void 0!==n?Er(r,t,t.childNodes[n]):cn(t,r);var o=En("g");mn(o).add("djs-element"),mn(o).add("djs-"+e),cn(r,o);var i=En("g");return mn(i).add("djs-visual"),cn(o,i),o},Cr.prototype.create=function(e,t,n){var r=this._getChildren(t.parent);return this._createContainer(e,r,n)},Cr.prototype.updateContainments=function(e){var t=this,n=this._elementRegistry;p(f(e,function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e},{}),function(e){var r=e.children;if(r){var o=t._getChildren(e);p(r.slice().reverse(),function(e){Er(n.getGraphics(e).parentNode,o)})}})},Cr.prototype.drawShape=function(e,t){return this._eventBus.fire("render.shape",{gfx:e,element:t})},Cr.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},Cr.prototype.drawConnection=function(e,t){return this._eventBus.fire("render.connection",{gfx:e,element:t})},Cr.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},Cr.prototype.update=function(e,t,n){if(t.parent){var r=this._clear(n);if("shape"===e)this.drawShape(r,t),xr(n,t.x,t.y);else{if("connection"!==e)throw new Error("unknown type: "+e);this.drawConnection(r,t)}t.hidden?fn(n,"display","none"):fn(n,"display","block")}},Cr.prototype.remove=function(e){bn(this._elementRegistry.getGraphics(e).parentNode)};var Or={__depends__:[Fn],__init__:["canvas"],canvas:["type",tr],elementRegistry:["type",or],elementFactory:["type",wr],eventBus:["type",A],graphicsFactory:["type",Cr]};function kr(e){var t=[],n=[];function r(e){return t.indexOf(e)>=0}e.forEach(function e(o){r(o)||((o.__depends__||[]).forEach(e),r(o)||(function(e){t.push(e)}(o),(o.__init__||[]).forEach(function(e){n.push(e)})))});var o=new nn(t);return n.forEach(function(e){try{o["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),o}function jr(e,t){this.injector=t=t||function(e){return kr([{config:["value",e=e||{}]},Or].concat(e.modules||[]))}(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}jr.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},jr.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var Sr=Object.freeze({default:jr}),Pr=Sr&&jr||Sr;function Tr(e,t){var n=[];function r(t,n){if(t.gfx)throw new Error("already rendered "+t.id);return e.element(t,n)}function o(e){var t=[];!function(e,t){var n=e.extensionElements;if(!n)return;p(n.values,t)}(e,function(n){Nt(n,"biodi:Bounds")?r(e,n):Nt(n,"biodi:Edge")&&t.push(n)}),function(e,t){function o(t,o){var i,a=(i=o)&&i.href.slice(1),s=u(e,b({source:a}));s&&n.push(function(){r(t,s)})}if(Nt(t,"dmn:Association"))return o(t,t.sourceRef);p(["informationRequirement","knowledgeRequirement","authorityRequirement"],function(e){p(t[e],function(e){var t=null;Nt(e,"dmn:InformationRequirement")?t=["requiredDecision","requiredInput"]:Nt(e,"dmn:KnowledgeRequirement")?t=["requiredKnowledge"]:Nt(e,"dmn:AuthorityRequirement")&&(t=["requiredDecision","requiredInput","requiredAuthority"]),t&&p(t,function(t){e[t]&&o(e,e[t])})})})}(t,e)}return{handleDefinitions:function(t){e.root(t),p(["decision","drgElements","artifacts"],function(e){t[e]&&p(t[e],o)}),p(n,function(e){e()})}}}var Rr=0,Ar={width:150,height:50};function Mr(e,t){t.textContent=e;try{var n,r=""===e;return t.textContent=r?"dummy":e,n=P(t.getBBox(),["width","height"]),r&&(n.width=0),n}catch(e){return{width:0,height:0}}}function Br(e,t,n){for(var r,o=e.shift(),i=o;;){if((r=Mr(i,n)).width=i?r.width:0," "===i||""===i||r.width<Math.round(t)||i.length<2)return Dr(e,i,o,r);i=Ir(i,r.width,t)}}function Dr(e,t,n,r){if(t.length<n.length){var o=n.slice(t.length).trim();e.unshift(o)}return{width:r.width,height:r.height,text:t}}function Ir(e,t,n){var r=Math.max(e.length*(n/t),1),o=function(e,t){var n,r=e.split(/(\s|-)/g),o=[],i=0;if(r.length>1)for(;n=r.shift();){if(!(n.length+i<t)){"-"===n&&o.pop();break}o.push(n),i+=n.length}return o.join("")}(e,r);return o||(o=e.slice(0,Math.max(Math.round(r-1),1))),o}function Nr(e){this._config=S({},{size:Ar,padding:Rr,style:{},align:"center-top"},e||{})}function Vr(e,t,n){an.call(this,e);var i=new Nr({style:{fontFamily:"Arial, sans-serif",fontSize:"12px"},size:{width:100}}),a={};function s(e){return"url(#"+a[e].id+")"}function c(e){function t(t,n){var r=S({strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},n.attrs),o=n.ref||{x:0,y:0},i=n.scale||1;"none"===r.strokeDasharray&&(r.strokeDasharray=[1e4,1]);var s=En("marker");fn(n.element,r),cn(s,n.element),fn(s,{id:t,viewBox:"0 0 20 20",refX:o.x,refY:o.y,markerWidth:20*i,markerHeight:20*i,orient:"auto"});var c=_t("defs",e);return c||(c=En("defs"),cn(e,c)),cn(c,s),function(e,t){a[e]=t}(t,s)}var n=En("path");fn(n,{d:"M 11 5 L 1 10 L 11 15"}),t("association-start",{element:n,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:1,y:10},scale:.5});var r=En("path");fn(r,{d:"M 1 5 L 11 10 L 1 15"}),t("association-end",{element:r,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:12,y:10},scale:.5});var o=En("path");fn(o,{d:"M 1 5 L 11 10 L 1 15 Z"}),t("information-requirement-end",{element:o,ref:{x:11,y:10},scale:1});var i=En("path");fn(i,{d:"M 1 3 L 11 10 L 1 17"}),t("knowledge-requirement-end",{element:i,attrs:{fill:"none",stroke:"black",strokeWidth:2},ref:{x:11,y:10},scale:.8});var s=En("circle");fn(s,{cx:3,cy:3,r:3}),t("authority-requirement-end",{element:s,ref:{x:3,y:3},scale:.9})}function u(e,t,o){return r(t)||(o=t,t=[]),n.style(t||[],S(o,e||{}))}function l(e,t,n,r,i,a){o(i)&&(a=i,i=0),i=i||0,a=u(a,{stroke:"black",strokeWidth:2,fill:"white"});var s=En("rect");return fn(s,{x:i,y:i,width:t-2*i,height:n-2*i,rx:r,ry:r}),fn(s,a),cn(e,s),s}function p(e,t,n){var r=i.createText(t||"",n);return Xe(r,"class","djs-label"),cn(e,r),r}function f(e,t,n){return p(e,function(e){return $t(e).name}(t),{box:t,align:n,padding:5})}function d(e,t,n){n=u(n,["no-fill"],{strokeWidth:2,stroke:"black"});var r=En("path");return fn(r,{d:t}),fn(r,n),cn(e,r),r}var h={"dmn:Decision":function(e,t,n){var r=l(e,t.width,t.height,0,n);return f(e,t,"center-middle"),r},"dmn:KnowledgeSource":function(e,n,r){var o=d(e,t.getScaledPath("KNOWLEDGE_SOURCE",{xScaleFactor:1.021,yScaleFactor:1,containerWidth:n.width,containerHeight:n.height,position:{mx:0,my:.075}}),{strokeWidth:2,fill:"white",stroke:"black"});return f(e,n,"center-middle"),o},"dmn:BusinessKnowledgeModel":function(e,n,r){var o=d(e,t.getScaledPath("BUSINESS_KNOWLEDGE_MODEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width,containerHeight:n.height,position:{mx:0,my:.3}}),{strokeWidth:2,fill:"white",stroke:"black"});return f(e,n,"center-middle"),o},"dmn:InputData":function(e,t,n){var r=l(e,t.width,t.height,22,n);return f(e,t,"center-middle"),r},"dmn:TextAnnotation":function(e,n,r){var o=l(e,n.width,n.height,0,0,{fill:"none",stroke:"none"});return d(e,t.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:n.width,containerHeight:n.height,position:{mx:0,my:0}})),p(e,Lr(n).text||"",{box:n,align:"left-middle",padding:5}),o},"dmn:Association":function(e,t,n){var r=Lr(t);return n=S({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"},n||{}),"One"!==r.associationDirection&&"Both"!==r.associationDirection||(n.markerEnd=s("association-end")),"Both"===r.associationDirection&&(n.markerStart=s("association-start")),v(e,t.waypoints,n)},"dmn:InformationRequirement":function(e,t,n){return n=S({strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:s("information-requirement-end")},n||{}),v(e,t.waypoints,n)},"dmn:KnowledgeRequirement":function(e,t,n){return n=S({strokeWidth:1,strokeDasharray:5,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:s("knowledge-requirement-end")},n||{}),v(e,t.waypoints,n)},"dmn:AuthorityRequirement":function(e,t,n){return n=S({strokeWidth:1.5,strokeDasharray:5,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:s("authority-requirement-end")},n||{}),v(e,t.waypoints,n)}};function v(e,t,n){var r=Vn(t,n=u(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"}));return cn(e,r),r}this.canRender=function(e){return Nt(e,"dmn:DMNElement")||Nt(e,"dmn:InformationRequirement")||Nt(e,"dmn:KnowledgeRequirement")||Nt(e,"dmn:AuthorityRequirement")},this.drawShape=function(e,t){var n=h[t.type];return n?n(e,t):an.prototype.drawShape.apply(this,[e,t])},this.drawConnection=function(e,t){var n=t.type,r=h[n];return r?r(e,t):an.prototype.drawConnection.apply(this,[e,t])},e.on("canvas.init",function(e){c(e.svg)})}function Lr(e){return e.businessObject}Nr.prototype.createText=function(e,t){return this.layoutText(e,t).element},Nr.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},Nr.prototype.layoutText=function(e,t){var n=S({},this._config.size,t.box),r=S({},this._config.style,t.style),i=function(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}(t.align||this._config.align),a=function(e){return o(e)?S({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}(void 0!==t.padding?t.padding:this._config.padding),s=t.fitBox||!1,c=e.split(/\r?\n/g),u=[],l=n.width-a.left-a.right,d=En("text");for(fn(d,{x:0,y:0}),fn(d,r),cn(function(){var e=document.getElementById("helper-svg");return e||(fn(e=En("svg"),{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}(),d);c.length;)u.push(Br(c,l,d));var h,v,y=f(u,function(e,t,n){return e+t.height},0),m=f(u,function(e,t,n){return t.width>e?t.width:e},0);switch(i.vertical){case"middle":h=(n.height-y)/2-u[0].height/4;break;default:h=a.top}var g=En("text");return fn(g,r),p(u,function(e){switch(h+=e.height,i.horizontal){case"left":v=a.left;break;case"right":v=(s?m:l)-a.right-e.width;break;default:v=Math.max(((s?m:l)-e.width)/2+a.left,0)}var t=En("tspan");fn(t,{x:v,y:h}),t.textContent=e.text,cn(g,t)}),bn(d),{dimensions:{width:m,height:y},element:g}},Gt(Vr,an),Vr.$inject=["eventBus","pathMap","styles"];var $r=/\{([^}]+)\}/g,Fr=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;var Ur={__init__:["drdRenderer"],drdRenderer:["type",Vr],pathMap:["type",function(){this.pathMap={KNOWLEDGE_SOURCE:{d:"m {mx},{my} l 0,{e.y0} c {e.x0},{e.y1} {e.x1},-{e.y2} {e.x2},-{e.y3} c {e.x3},-{e.y4} {e.x4},{e.y5} {e.x5},{e.y6} l 0,-{e.y7}z",width:100,height:65,widthElements:[29.8,48.4,67.2,12.2,19.8,30.8],heightElements:[55.3,19.7,4.2,6.7,2.3,1.6,6.2,54.6]},BUSINESS_KNOWLEDGE_MODEL:{d:"m {mx},{my} l {e.x0},-{e.y0} l {e.x1},0 l 0,{e.y1} l -{e.x2},{e.y2} l -{e.x3},0z",width:125,height:45,widthElements:[13.8,109.2,13.8,109.1],heightElements:[13.2,29.8,13.2]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",width:10,height:30,widthElements:[10],heightElements:[30]}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,r,o=this.pathMap[e];t.abspos?(n=t.abspos.x,r=t.abspos.y):(n=t.containerWidth*t.position.mx,r=t.containerHeight*t.position.my);var i,a,s={};if(t.position){for(var c=t.containerHeight/o.height*t.yScaleFactor,u=t.containerWidth/o.width*t.xScaleFactor,l=0;l<o.heightElements.length;l++)s["y"+l]=o.heightElements[l]*c;for(var p=0;p<o.widthElements.length;p++)s["x"+p]=o.widthElements[p]*u}return i=o.d,a={mx:n,my:r,e:s},String(i).replace($r,function(e,t){return function(e,t,n){var r=n;return t.replace(Fr,function(e,t,n,o,i){t=t||o,r&&(t in r&&(r=r[t]),"function"==typeof r&&i&&(r=r()))}),r=(null==r||r==n?e:r)+""}(e,t,a)})}}]};function zr(e,t){return S({id:e.id,type:e.$type,businessObject:e},t)}function Wr(e,t,n,r){this._eventBus=e,this._canvas=t,this._elementRegistry=r,this._elementFactory=n}Wr.$inject=["eventBus","canvas","elementFactory","elementRegistry"],Wr.prototype.root=function(e){var t=this._elementFactory.createRoot(zr(e));return this._canvas.setRootElement(t),t},Wr.prototype.add=function(e,t){var n,r,o,i,a,s,c,u=this._elementFactory,l=this._canvas,p=this._eventBus;if(t.$instanceOf("biodi:Bounds"))a=zr(e,{x:Math.round(t.x),y:Math.round(t.y),width:Math.round(t.width),height:Math.round(t.height)}),n=u.createShape(a),l.addShape(n),p.fire("drdElement.added",{element:n,di:t});else{if(!t.$instanceOf("biodi:Edge"))throw new Error("unknown di for element "+e.id);r=function(e){var t=e.waypoints;if(t)return v(t,function(e){var t={x:e.x,y:e.y};return S({original:t},t)})}(t),s=t.source,c=e.$parent.id,Nt(e,"dmn:Association")&&(c=function(e){return e&&e.href.slice(1)}(e.targetRef)),o=this._getShape(s),i=this._getShape(c),o&&i&&(a=zr(e,{hidden:!1,source:o,target:i,waypoints:r}),n=u.createConnection(a),l.addConnection(n),p.fire("drdElement.added",{element:n,di:t}))}return n},Wr.prototype._getShape=function(e){return this._elementRegistry.get(e)};var Gr={__depends__:[Ur,{drdImporter:["type",Wr]}]};var Hr={translate:["value",function(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(e,n){return t[n]||"{"+n+"}"})}]};function qr(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function Kr(e){return e.originalEvent||e.srcEvent}function Xr(e,t){qr(e),qr(Kr(e))}function Yr(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function Zr(e){return!(Kr(e)||e).button}function Jr(e){var t=Kr(e)||e;return!!Zr(e)&&(/mac/i.test(navigator.platform)?t.metaKey:t.ctrlKey)}function Qr(e){return!0}var eo=500;function to(e,t,n){var r=n.cls("djs-hit",["no-fill","no-border"],{stroke:"white",strokeWidth:15});function o(n,r,o){var i,a;(function(e,t){return!(c[e]||Zr)(t)})(n,r)||(o?a=t.getGraphics(o):(i=r.delegateTarget||r.target)&&(a=i,o=t.get(a)),a&&o&&!1===e.fire(n,{element:o,gfx:a,originalEvent:r})&&(r.stopPropagation(),r.preventDefault()))}var i={};function a(e){return i[e]}var s={mouseover:"element.hover",mouseout:"element.out",click:"element.click",dblclick:"element.dblclick",mousedown:"element.mousedown",mouseup:"element.mouseup",contextmenu:"element.contextmenu"},c={"element.contextmenu":Qr};var u="svg, .djs-element";function l(e,t,n,r){var a=i[n]=function(e){o(n,e)};r&&(c[n]=r),a.$delegate=dt.bind(e,u,t,a)}function f(e,t,n){var r=a(n);r&&dt.unbind(e,t,r.$delegate)}e.on("canvas.destroy",function(e){var t;t=e.svg,p(s,function(e,n){f(t,n,e)})}),e.on("canvas.init",function(e){var t;t=e.svg,p(s,function(e,n){l(t,n,e)})}),e.on(["shape.added","connection.added"],function(e){var t,n=e.element,o=e.gfx;n.waypoints?t=Vn(n.waypoints):fn(t=En("rect"),{x:0,y:0,width:n.width,height:n.height}),fn(t,r),cn(o,t)}),e.on("shape.changed",eo,function(e){var t=e.element;fn(_t(".djs-hit",e.gfx),{width:t.width,height:t.height})}),e.on("connection.changed",function(e){var t=e.element;!function(e,t){fn(e,{points:Nn(t)})}(_t(".djs-hit",e.gfx),t.waypoints)}),this.fire=o,this.triggerMouseEvent=function(e,t,n){var r=s[e];if(!r)throw new Error("unmapped DOM event name <"+e+">");return o(r,t,n)},this.mouseHandler=a,this.registerEvent=l,this.unregisterEvent=f}to.$inject=["eventBus","elementRegistry","styles"];var no={__init__:["interactionEvents"],interactionEvents:["type",to]},ro=500;function oo(e,t,n){this.offset=6;var r=t.cls("djs-outline",["no-fill"]),o=this;function i(e,t){var n=En("rect");return fn(n,S({x:10,y:10,width:100,height:100},r)),cn(e,n),n}e.on(["shape.added","shape.changed"],ro,function(e){var t=e.element,n=e.gfx,r=_t(".djs-outline",n);r||(r=i(n)),o.updateShapeOutline(r,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,n=e.gfx,r=_t(".djs-outline",n);r||(r=i(n)),o.updateConnectionOutline(r,t)})}oo.prototype.updateShapeOutline=function(e,t){fn(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},oo.prototype.updateConnectionOutline=function(e,t){var n=Kn(t);fn(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},oo.$inject=["eventBus","styles","elementRegistry"];var io={__init__:["outline"],outline:["type",oo]};function ao(e){this._eventBus=e,this._selectedElements=[];var t=this;e.on(["shape.remove","connection.remove"],function(e){var n=e.element;t.deselect(n)}),e.on(["diagram.clear"],function(e){t.select(null)})}ao.$inject=["eventBus"],ao.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(-1!==n){var r=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:r,newSelection:t})}},ao.prototype.get=function(){return this._selectedElements},ao.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},ao.prototype.select=function(e,t){var n=this._selectedElements,o=n.slice();r(e)||(e=e?[e]:[]),t?p(e,function(e){-1===n.indexOf(e)&&n.push(e)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:o,newSelection:n})};var so="hover",co="selected";function uo(e,t,n,r){function o(e,n){t.addMarker(e,n)}function i(e,n){t.removeMarker(e,n)}this._multiSelectionBox=null,e.on("element.hover",function(e){o(e.element,so)}),e.on("element.out",function(e){i(e.element,so)}),e.on("selection.changed",function(e){var t=e.oldSelection,n=e.newSelection;p(t,function(e){-1===n.indexOf(e)&&i(e,co)}),p(n,function(e){-1===t.indexOf(e)&&o(e,co)})})}function lo(e,t,n,r){e.on("create.end",500,function(e){e.context.canExecute&&t.select(e.context.shape)}),e.on("connect.end",500,function(e){e.context.canExecute&&e.context.target&&t.select(e.context.target)}),e.on("shape.move.end",500,function(e){var n=e.previousSelection||[],o=r.get(e.context.shape.id);u(n,function(e){return o.id===e.id})||t.select(o)}),e.on("element.click",function(e){var r=e.element;r===n.getRootElement()&&(r=null);var o=t.isSelected(r),i=t.get().length>1,a=Jr(e);if(o&&i)return a?t.deselect(r):t.select(r);o?t.deselect(r):t.select(r,a)})}uo.$inject=["eventBus","canvas","selection","styles"],lo.$inject=["eventBus","selection","canvas","elementRegistry"];var po={__init__:["selectionVisuals","selectionBehavior"],__depends__:[no,io],selection:["type",ao],selectionVisuals:["type",uo],selectionBehavior:["type",lo]};function fo(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}fo.prototype.next=function(){return this._prefix+ ++this._counter};var ho=new fo("ov");function vo(e,t,n){S(e.style,{left:t+"px",top:n+"px"})}function yo(e,t){e.style.display=!1===t?"none":""}function mo(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}function go(e){return void 0!==e}function bo(e,t,n,r){var o,i;this._eventBus=t,this._canvas=n,this._elementRegistry=r,this._ids=ho,this._overlayDefaults=S({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(o=n.getContainer(),i=ht('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),o.insertBefore(i,o.firstChild),i),this._init()}bo.$inject=["config.overlays","eventBus","canvas","elementRegistry"],bo.prototype.get=function(e){if(s(e)&&(e={id:e}),s(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?l(t.overlays,b({type:e.type})):t.overlays.slice():[]}return e.type?l(this._overlays,b({type:e.type})):e.id?this._overlays[e.id]:null},bo.prototype.add=function(e,t,n){if(o(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var r=this._ids.next();return n=S({},this._overlayDefaults,n,{id:r,type:t,element:e,html:n.html}),this._addOverlay(n),r},bo.prototype.remove=function(e){var t=this.get(e)||[];r(t)||(t=[t]);var n=this;p(t,function(e){var t=n._getOverlayContainer(e.element,!0);if(e&&(xt(e.html),xt(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t){var r=t.overlays.indexOf(e);-1!==r&&t.overlays.splice(r,1)}})},bo.prototype.show=function(){yo(this._overlayRoot)},bo.prototype.hide=function(){yo(this._overlayRoot,!1)},bo.prototype.clear=function(){this._overlays={},this._overlayContainers=[],nt(this._overlayRoot)},bo.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,r=t.x,o=t.y;if(t.waypoints){var i=Kn(t);r=i.x,o=i.y}vo(n,r,o),Xe(e.html,"data-container-id",t.id)},bo.prototype._updateOverlay=function(e){var t,n,r=e.position,o=e.htmlContainer,i=e.element,a=r.left,s=r.top;void 0!==r.right&&(t=i.waypoints?Kn(i).width:i.width,a=-1*r.right+t);void 0!==r.bottom&&(n=i.waypoints?Kn(i).height:i.height,s=-1*r.bottom+n);vo(o,a||0,s||0)},bo.prototype._createOverlayContainer=function(e){var t=ht('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},bo.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";mo(this._overlayRoot,n)},bo.prototype._getOverlayContainer=function(e,t){var n=u(this._overlayContainers,function(t){return t.element===e});return n||t?n:this._createOverlayContainer(e)},bo.prototype._addOverlay=function(e){var t,n,r=e.id,o=e.element,i=e.html;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),s(i)&&(i=ht(i)),n=this._getOverlayContainer(o),(t=ht('<div class="djs-overlay" data-overlay-id="'+r+'" style="position: absolute">')).appendChild(i),e.type&&et(t).add("djs-overlay-"+e.type),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[r]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},bo.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,r=n&&n.minZoom,o=n&&n.maxZoom,i=e.htmlContainer,a=!0;n&&((go(r)&&r>t.scale||go(o)&&o<t.scale)&&(a=!1),yo(i,a)),this._updateOverlayScale(e,t)},bo.prototype._updateOverlayScale=function(e,t){var n,r,o,i=e.scale,a=e.htmlContainer,s="";!0!==i&&(!1===i?(n=1,r=1):(n=i.min,r=i.max),go(n)&&t.scale<n&&(o=(1/t.scale||1)*n),go(r)&&t.scale>r&&(o=(1/t.scale||1)*r)),go(o)&&(s="scale("+o+","+o+")"),mo(a,s)},bo.prototype._updateOverlaysVisibilty=function(e){var t=this;p(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})},bo.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",function(e){t.hide()}),e.on("canvas.viewbox.changed",function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateOverlaysVisibilty(n),t.show()}),e.on(["shape.remove","connection.remove"],function(e){var n=e.element;p(t.get({element:n}),function(e){t.remove(e.id)});var r=t._getOverlayContainer(n);if(r){xt(r.html);var o=t._overlayContainers.indexOf(r);-1!==o&&t._overlayContainers.splice(o,1)}}),e.on("element.changed",500,function(e){var n=e.element,r=t._getOverlayContainer(n,!0);r&&(p(r.overlays,function(e){t._updateOverlay(e)}),t._updateOverlayContainer(r))}),e.on("element.marker.update",function(e){var n=t._getOverlayContainer(e.element,!0);n&&et(n.html)[e.add?"add":"remove"](e.marker)}),e.on("diagram.clear",this.clear,this)};var _o={__init__:["overlays"],overlays:["type",bo]};function wo(e,t){this._eventBus=e,this._canvas=t,e.on("diagram.init",function(){this._init()},this),e.on("import.done",function(e){this.update()},this)}function xo(e,t){function n(e,n){et(t.getContainer()).toggle(e,n)}e.on("palette.create",function(){n("with-palette",!0)}),e.on("palette.changed",function(e){n("with-palette-two-column",e.twoColumn)})}wo.$inject=["eventBus","canvas"],wo.prototype._init=function(){var e=this._canvas,t=this._eventBus,n=e.getContainer(),r=this._container=ht(wo.HTML_MARKUP);n.appendChild(r),this.nameElement=_t(".dmn-definitions-name",this._container),this.idElement=_t(".dmn-definitions-id",this._container),dt.bind(r,".dmn-definitions-name, .dmn-definitions-id","mousedown",function(e){e.stopPropagation()}),t.fire("definitionIdView.create",{html:r})},wo.prototype.update=function(e){var t=this._canvas.getRootElement().businessObject;this.nameElement.textContent=t.name,this.idElement.textContent=t.id},wo.HTML_MARKUP='<div class="dmn-definitions"><div class="dmn-definitions-name" title="Definition Name"></div><div class="dmn-definitions-id" title="Definition ID"></div></div>',xo.$inject=["eventBus","canvas"];var Co={__init__:["definitionPropertiesView","definitionPropertiesPaletteAdapter"],definitionPropertiesView:["type",wo],definitionPropertiesPaletteAdapter:["type",xo]},Eo=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Oo=[{className:"dmn-icon-decision-table",matches:function(e){var t=e.businessObject;return Nt(t,"dmn:Decision")&&t.decisionTable}},{className:"dmn-icon-literal-expression",matches:function(e){var t=e.businessObject;return Nt(t,"dmn:Decision")&&t.literalExpression}}],ko=function(){function e(t,n,r,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._injector=t,this._eventBus=n,this._overlays=r,this._config=o||{enabled:!0},n.on(["shape.added"],function(e){for(var t=e.element,n=0;n<Oo.length;n++){var r=Oo[n],o=r.matches,a=r.className;o&&o(t)&&i.addOverlay(t,a)}})}return Eo(e,[{key:"addOverlay",value:function(e,t){var n=ht('\n      <div class="drill-down-overlay">\n        <span class="'+t+'"></span>\n      </div>\n    '),r=this._overlays.add(e,{position:{top:2,left:2},html:n});!1!==this._config.enabled&&(et(n).add("interactive"),this.bindEventListener(e,n,r))}},{key:"bindEventListener",value:function(e,t,n){var r=this,o=this._overlays,i=this._eventBus,a=o._overlayRoot;dt.bind(a,'[data-overlay-id="'+n+'"]',"click",function(){!1!==i.fire("drillDown.click",{element:e})&&r.drillDown(e)})}},{key:"drillDown",value:function(e){var t=this._injector.get("_parent",!1);if(!t)return!1;var n=t.getView(e.businessObject);return!!n&&(t.open(n),!0)}}]),e}();ko.$inject=["injector","eventBus","overlays","config.drillDown"];var jo={__depends__:[_o],__init__:["drillDown"],drillDown:["type",ko]},So='<img width="52" height="52" src="'+("data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 960"><path fill="#fff" d="M960 60v839c0 33-27 61-60 61H60c-33 0-60-27-60-60V60C0 27 27 0 60 0h839c34 0 61 27 61 60z"/><path fill="#52b415" d="M217 548a205 205 0 0 0-144 58 202 202 0 0 0-4 286 202 202 0 0 0 285 3 200 200 0 0 0 48-219 203 203 0 0 0-185-128zM752 6a206 206 0 0 0-192 285 206 206 0 0 0 269 111 207 207 0 0 0 111-260A204 204 0 0 0 752 6zM62 0A62 62 0 0 0 0 62v398l60 46a259 259 0 0 1 89-36c5-28 10-57 14-85l99 2 12 85a246 246 0 0 1 88 38l70-52 69 71-52 68c17 30 29 58 35 90l86 14-2 100-86 12a240 240 0 0 1-38 89l43 58h413c37 0 60-27 60-61V407a220 220 0 0 1-44 40l21 85-93 39-45-76a258 258 0 0 1-98 1l-45 76-94-39 22-85a298 298 0 0 1-70-69l-86 22-38-94 76-45a258 258 0 0 1-1-98l-76-45 40-94 85 22a271 271 0 0 1 41-47z"/></svg>'))+'" />';
/**
   * This file must not be changed or exchanged.
   *
   * @see http://bpmn.io/license for more information.
   */function Po(e){return e.join(";")}var To,Ro='<div class="bjs-powered-by-lightbox" style="'+Po(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+Po(["width: 100%","height: 100%","background: rgba(0,0,0,0.2)"])+'"></div><div class="notice" style="'+Po(["position: absolute","left: 50%","top: 40%","margin: 0 -130px","width: 260px","padding: 10px","background: white","border: solid 1px #AAA","border-radius: 3px","font-family: Helvetica, Arial, sans-serif","font-size: 14px","line-height: 1.2em"])+'"><a href="http://bpmn.io" target="_blank" style="float: left; margin-right: 10px">'+So+'</a>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="http://bpmn.io" target="_blank">bpmn.io</a>.</div></div>';var Ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function Mo(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Bo(e){
/**
   * Adds the project logo to the diagram container as
   * required by the bpmn.io license.
   *
   * @see http://bpmn.io/license
   *
   * @param {Element} container
   */
var t,n;this._container=this._createContainer(),t=this._container,n=ht('<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100">'+So+"</a>"),t.appendChild(n),pt.bind(n,"click",function(e){To||(To=ht(Ro),dt.bind(To,".backdrop","click",function(e){document.body.removeChild(To)})),document.body.appendChild(To),e.preventDefault()}),this._init(this._container,e)}function Do(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function Io(e,t){return{x:e.x-t.x,y:e.y-t.y}}function No(e){return Math.log(e)/Math.log(10)}function Vo(e,t){var n=No(e.min),r=No(e.max);return(Math.abs(n)+Math.abs(r))/t}Gt(Bo,Pr),Bo.prototype.saveSVG=function(e,t){t||(t=e,e={});var n=this.get("canvas"),r=n.getDefaultLayer(),o=_t("defs",n._svg),i=Mn(r),a=o&&o.outerHTML||"",s=r.getBBox();t(null,'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with dmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+s.width+'" height="'+s.height+'" viewBox="'+s.x+" "+s.y+" "+s.width+" "+s.height+'" version="1.1">'+a+i+"</svg>")},Bo.prototype.getModules=function(){return this._modules},Bo.prototype.destroy=function(){Pr.prototype.destroy.call(this),xt(this._container)},Bo.prototype.on=function(e,t,n,r){return this.get("eventBus").on(e,t,n,r)},Bo.prototype.off=function(e,t){this.get("eventBus").off(e,t)},Bo.prototype._init=function(e,t){var n=t.additionalModules,r=t.canvas,o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["additionalModules","canvas"]),i=t.modules||this.getModules(),a=[].concat([{drd:["value",this]}],Mo(i),Mo(n||[])),s=Ao({},o,{canvas:Ao({},r,{container:e}),modules:a});Pr.call(this,s),t&&t.container&&this.attachTo(t.container)},Bo.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},Bo.prototype._createContainer=function(){return ht('<div class="dmn-drd-container"></div>')},Bo.prototype.open=function(e,t){var n;try{return this._definitions&&this.clear(),this._definitions=e,function(e,t,n){var r,o=e.get("drdImporter"),i=e.get("eventBus"),a=[];i.fire("import.start",{definitions:t});try{!function(e){new Tr({root:function(e){return o.root(e)},element:function(e,t){return o.add(e,t)},error:function(e,t){a.push({message:e,context:t})}}).handleDefinitions(e)}(t)}catch(e){r=e}i.fire("import.done",{error:r,warnings:a}),n(r,a)}(this,e,t)}catch(e){n=e}return t(n)},Bo.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach();var t=this._container;e.appendChild(t),this._emit("attach",{}),this.get("canvas").resized()},Bo.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},Bo.prototype._modules=[Gr,Hr,po,_o,Co,jo];var Lo=Math.sign||function(e){return e>=0?1:-1},$o={min:.2,max:4},Fo=.75;function Uo(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=k(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||Fo;var r=this;t.on("canvas.init",function(t){r._init(!1!==e.enabled)})}Uo.$inject=["config.zoomScroll","eventBus","canvas"],Uo.prototype.scroll=function(e){this._canvas.scroll(e)},Uo.prototype.reset=function(){this._canvas.zoom("fit-viewport")},Uo.prototype.zoom=function(e,t){var n=Vo($o,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,n),this._totalDelta=0)},Uo.prototype._handleWheel=function(e){if(!st(e.target,".djs-scrollable",!0)){var t=this._container;e.preventDefault();var n,r=e.ctrlKey,o=e.shiftKey,i=-1*this._scale;if(i*=r?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,r){var a=t.getBoundingClientRect(),s={x:e.clientX-a.left,y:e.clientY-a.top};n=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*Lo(e.deltaY)*i,this.zoom(n,s)}else n=o?{dx:i*e.deltaY,dy:0}:{dx:i*e.deltaX,dy:i*e.deltaY},this.scroll(n)}},Uo.prototype.stepZoom=function(e,t){var n=Vo($o,10);this._zoom(e,t,n)},Uo.prototype._zoom=function(e,t,n){var r=this._canvas,o=e>0?1:-1,i=No(r.zoom()),a=Math.round(i/n)*n;a+=n*o;var s,c,u=Math.pow(10,a);r.zoom((s=$o,c=u,Math.max(s.min,Math.min(s.max,c))),t)},Uo.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,r=this._enabled;return void 0===e&&(e=!r),r!==e&&pt[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e,e},Uo.prototype._init=function(e){this.toggle(e)};var zo={__init__:["zoomScroll"],zoomScroll:["type",Uo]},Wo=/^djs-cursor-.*$/;function Go(e){var t=et(document.body);t.removeMatching(Wo),e&&t.add("djs-cursor-"+e)}function Ho(){Go(null)}var qo=5e3;function Ko(e,t){function n(){return!1}return t=t||"element.click",e.once(t,qo,n),function(){e.off(t,n)}}var Xo=15;function Yo(e,t){var n;function r(r){var o,i=n.start,a=Yr(r),s=Io(a,i);(!n.dragging&&(o=s,Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))>Xo)&&(n.dragging=!0,Ko(e),Go("grab")),n.dragging)&&(s=Io(a,n.last||n.start),t.scroll({dx:s.x,dy:s.y}),n.last=a);r.preventDefault()}function o(e){pt.unbind(document,"mousemove",r),pt.unbind(document,"mouseup",o),n=null,Ho()}e.on("element.mousedown",500,function(e){return function(e){if(!st(e.target,".djs-draggable")&&!(e.button||e.ctrlKey||e.shiftKey||e.altKey))return n={start:Yr(e)},pt.bind(document,"mousemove",r),pt.bind(document,"mouseup",o),!0}(e.originalEvent)})}Yo.$inject=["eventBus","canvas"];var Zo={__init__:["moveCanvas"],moveCanvas:["type",Yo]},Jo=X(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*! Hammer.JS - v2.0.7 - 2016-04-22
   * http://hammerjs.github.io/
   *
   * Copyright (c) 2016 Jorik Tangelder;
   * Licensed under the MIT license */
/*! Hammer.JS - v2.0.7 - 2016-04-22
   * http://hammerjs.github.io/
   *
   * Copyright (c) 2016 Jorik Tangelder;
   * Licensed under the MIT license */
!function(n,r,o,i){var a,s=["","webkit","Moz","MS","ms","o"],c=r.createElement("div"),u="function",l=Math.round,p=Math.abs,f=Date.now;function d(e,t,n){return setTimeout(_(e,n),t)}function h(e,t,n){return!!Array.isArray(e)&&(v(e,n[t],n),!0)}function v(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==i)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,t,r){var o="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=new Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=n.console&&(n.console.warn||n.console.log);return i&&i.call(n.console,o,r),e.apply(this,arguments)}}a="function"!=typeof Object.assign?function(e){if(e===i||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}:Object.assign;var m=y(function(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;)(!n||n&&e[r[o]]===i)&&(e[r[o]]=t[r[o]]),o++;return e},"extend","Use `assign`."),g=y(function(e,t){return m(e,t,!0)},"merge","Use `assign`.");function b(e,t,n){var r,o=t.prototype;(r=e.prototype=Object.create(o)).constructor=e,r._super=o,n&&a(r,n)}function _(e,t){return function(){return e.apply(t,arguments)}}function w(e,n){return(void 0===e?"undefined":t(e))==u?e.apply(n&&n[0]||i,n):e}function x(e,t){return e===i?t:e}function C(e,t,n){v(j(t),function(t){e.addEventListener(t,n,!1)})}function E(e,t,n){v(j(t),function(t){e.removeEventListener(t,n,!1)})}function O(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function k(e,t){return e.indexOf(t)>-1}function j(e){return e.trim().split(/\s+/g)}function S(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function T(e,t,n){for(var r=[],o=[],i=0;i<e.length;){var a=t?e[i][t]:e[i];S(o,a)<0&&r.push(e[i]),o[i]=a,i++}return n&&(r=t?r.sort(function(e,n){return e[t]>n[t]}):r.sort()),r}function R(e,t){for(var n,r,o=t[0].toUpperCase()+t.slice(1),a=0;a<s.length;){if((r=(n=s[a])?n+o:t)in e)return r;a++}return i}var A=1;function M(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||n}var B="ontouchstart"in n,D=R(n,"PointerEvent")!==i,I=B&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N=25,V=1,L=2,$=4,F=8,U=1,z=2,W=4,G=8,H=16,q=z|W,K=G|H,X=q|K,Y=["x","y"],Z=["clientX","clientY"];function J(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&n.handler(t)},this.init()}function Q(e,t,n){var r=n.pointers.length,o=n.changedPointers.length,a=t&V&&r-o==0,s=t&($|F)&&r-o==0;n.isFirst=!!a,n.isFinal=!!s,a&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,o=r.length;n.firstInput||(n.firstInput=ee(t));o>1&&!n.firstMultiple?n.firstMultiple=ee(t):1===o&&(n.firstMultiple=!1);var a=n.firstInput,s=n.firstMultiple,c=s?s.center:a.center,u=t.center=te(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=ie(c,u),t.distance=oe(c,u),function(e,t){var n=t.center,r=e.offsetDelta||{},o=e.prevDelta||{},i=e.prevInput||{};t.eventType!==V&&i.eventType!==$||(o=e.prevDelta={x:i.deltaX||0,y:i.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y});t.deltaX=o.x+(n.x-r.x),t.deltaY=o.y+(n.y-r.y)}(n,t),t.offsetDirection=re(t.deltaX,t.deltaY);var l=ne(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=p(l.x)>p(l.y)?l.x:l.y,t.scale=s?(d=s.pointers,h=r,oe(h[0],h[1],Z)/oe(d[0],d[1],Z)):1,t.rotation=s?function(e,t){return ie(t[1],t[0],Z)+ie(e[1],e[0],Z)}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,o,a,s=e.lastInterval||t,c=t.timeStamp-s.timeStamp;if(t.eventType!=F&&(c>N||s.velocity===i)){var u=t.deltaX-s.deltaX,l=t.deltaY-s.deltaY,f=ne(c,u,l);r=f.x,o=f.y,n=p(f.x)>p(f.y)?f.x:f.y,a=re(u,l),e.lastInterval=t}else n=s.velocity,r=s.velocityX,o=s.velocityY,a=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=o,t.direction=a}(n,t);var d,h;var v=e.element;O(t.srcEvent.target,v)&&(v=t.srcEvent.target);t.target=v}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ee(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:l(e.pointers[n].clientX),clientY:l(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:te(t),deltaX:e.deltaX,deltaY:e.deltaY}}function te(e){var t=e.length;if(1===t)return{x:l(e[0].clientX),y:l(e[0].clientY)};for(var n=0,r=0,o=0;o<t;)n+=e[o].clientX,r+=e[o].clientY,o++;return{x:l(n/t),y:l(r/t)}}function ne(e,t,n){return{x:t/e||0,y:n/e||0}}function re(e,t){return e===t?U:p(e)>=p(t)?e<0?z:W:t<0?G:H}function oe(e,t,n){n||(n=Y);var r=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(r*r+o*o)}function ie(e,t,n){n||(n=Y);var r=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return 180*Math.atan2(o,r)/Math.PI}J.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(M(this.element),this.evWin,this.domHandler)}};var ae={mousedown:V,mousemove:L,mouseup:$},se="mousedown",ce="mousemove mouseup";function ue(){this.evEl=se,this.evWin=ce,this.pressed=!1,J.apply(this,arguments)}b(ue,J,{handler:function(e){var t=ae[e.type];t&V&&0===e.button&&(this.pressed=!0),t&L&&1!==e.which&&(t=$),this.pressed&&(t&$&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var le={pointerdown:V,pointermove:L,pointerup:$,pointercancel:F,pointerout:F},pe={2:"touch",3:"pen",4:"mouse",5:"kinect"},fe="pointerdown",de="pointermove pointerup pointercancel";function he(){this.evEl=fe,this.evWin=de,J.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}n.MSPointerEvent&&!n.PointerEvent&&(fe="MSPointerDown",de="MSPointerMove MSPointerUp MSPointerCancel"),b(he,J,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),o=le[r],i=pe[e.pointerType]||e.pointerType,a="touch"==i,s=S(t,e.pointerId,"pointerId");o&V&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):o&($|F)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:i,srcEvent:e}),n&&t.splice(s,1))}});var ve={touchstart:V,touchmove:L,touchend:$,touchcancel:F},ye="touchstart",me="touchstart touchmove touchend touchcancel";function ge(){this.evTarget=ye,this.evWin=me,this.started=!1,J.apply(this,arguments)}b(ge,J,{handler:function(e){var t=ve[e.type];if(t===V&&(this.started=!0),this.started){var n=function(e,t){var n=P(e.touches),r=P(e.changedTouches);t&($|F)&&(n=T(n.concat(r),"identifier",!0));return[n,r]}.call(this,e,t);t&($|F)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var be={touchstart:V,touchmove:L,touchend:$,touchcancel:F},_e="touchstart touchmove touchend touchcancel";function we(){this.evTarget=_e,this.targetIds={},J.apply(this,arguments)}b(we,J,{handler:function(e){var t=be[e.type],n=function(e,t){var n=P(e.touches),r=this.targetIds;if(t&(V|L)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var o,i,a=P(e.changedTouches),s=[],c=this.target;if(i=n.filter(function(e){return O(e.target,c)}),t===V)for(o=0;o<i.length;)r[i[o].identifier]=!0,o++;o=0;for(;o<a.length;)r[a[o].identifier]&&s.push(a[o]),t&($|F)&&delete r[a[o].identifier],o++;if(!s.length)return;return[T(i.concat(s),"identifier",!0),s]}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});var xe=2500,Ce=25;function Ee(){J.apply(this,arguments);var e=_(this.handler,this);this.touch=new we(this.manager,e),this.mouse=new ue(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Oe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)},xe)}}b(Ee,J,{handler:function(e,t,n){var r="touch"==n.pointerType,o="mouse"==n.pointerType;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(e,t){e&V?(this.primaryTouch=t.changedPointers[0].identifier,Oe.call(this,t)):e&($|F)&&Oe.call(this,t)}).call(this,t,n);else if(o&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var o=this.lastTouches[r],i=Math.abs(t-o.x),a=Math.abs(n-o.y);if(i<=Ce&&a<=Ce)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ke=R(c.style,"touchAction"),je=ke!==i,Se="auto",Pe="manipulation",Te="none",Re="pan-x",Ae="pan-y",Me=function(){if(!je)return!1;var e={},t=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=!t||n.CSS.supports("touch-action",r)}),e}();function Be(e,t){this.manager=e,this.set(t)}Be.prototype={set:function(e){"compute"==e&&(e=this.compute()),je&&this.manager.element.style&&Me[e]&&(this.manager.element.style[ke]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(k(e,Te))return Te;var t=k(e,Re),n=k(e,Ae);if(t&&n)return Te;if(t||n)return t?Re:Ae;if(k(e,Pe))return Pe;return Se}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,o=k(r,Te)&&!Me[Te],i=k(r,Ae)&&!Me[Ae],a=k(r,Re)&&!Me[Re];if(o){var s=1===e.pointers.length,c=e.distance<2,u=e.deltaTime<250;if(s&&c&&u)return}if(!a||!i)return o||i&&n&q||a&&n&K?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var De=1,Ie=2,Ne=4,Ve=8,Le=Ve,$e=16;function Fe(e){this.options=a({},this.defaults,e||{}),this.id=A++,this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=De,this.simultaneous={},this.requireFail=[]}function Ue(e){return e&$e?"cancel":e&Ve?"end":e&Ne?"move":e&Ie?"start":""}function ze(e){return e==H?"down":e==G?"up":e==z?"left":e==W?"right":""}function We(e,t){var n=t.manager;return n?n.get(e):e}function Ge(){Fe.apply(this,arguments)}function He(){Ge.apply(this,arguments),this.pX=null,this.pY=null}function qe(){Ge.apply(this,arguments)}function Ke(){Fe.apply(this,arguments),this._timer=null,this._input=null}function Xe(){Ge.apply(this,arguments)}function Ye(){Ge.apply(this,arguments)}function Ze(){Fe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Je(e,t){return(t=t||{}).recognizers=x(t.recognizers,Je.defaults.preset),new Qe(e,t)}Fe.prototype={defaults:{},set:function(e){return a(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(h(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=We(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return h(e,"dropRecognizeWith",this)?this:(e=We(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(h(e,"requireFailure",this))return this;var t=this.requireFail;return-1===S(t,e=We(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(h(e,"dropRequireFailure",this))return this;e=We(e,this);var t=S(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<Ve&&r(t.options.event+Ue(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=Ve&&r(t.options.event+Ue(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|De)))return!1;e++}return!0},recognize:function(e){var t=a({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(Le|$e|32)&&(this.state=De),this.state=this.process(t),this.state&(Ie|Ne|Ve|$e)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(Ge,Fe,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(Ie|Ne),o=this.attrTest(e);return r&&(n&F||!o)?t|$e:r||o?n&$?t|Ve:t&Ie?t|Ne:Ie:32}}),b(He,Ge,{defaults:{event:"pan",threshold:10,pointers:1,direction:X},getTouchAction:function(){var e=this.options.direction,t=[];return e&q&&t.push(Ae),e&K&&t.push(Re),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,o=e.direction,i=e.deltaX,a=e.deltaY;return o&t.direction||(t.direction&q?(o=0===i?U:i<0?z:W,n=i!=this.pX,r=Math.abs(e.deltaX)):(o=0===a?U:a<0?G:H,n=a!=this.pY,r=Math.abs(e.deltaY))),e.direction=o,n&&r>t.threshold&&o&t.direction},attrTest:function(e){return Ge.prototype.attrTest.call(this,e)&&(this.state&Ie||!(this.state&Ie)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ze(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(qe,Ge,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Te]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Ie)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(Ke,Fe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!r||!n||e.eventType&($|F)&&!o)this.reset();else if(e.eventType&V)this.reset(),this._timer=d(function(){this.state=Le,this.tryEmit()},t.time,this);else if(e.eventType&$)return Le;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===Le&&(e&&e.eventType&$?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),b(Xe,Ge,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Te]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Ie)}}),b(Ye,Ge,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:q|K,pointers:1},getTouchAction:function(){return He.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(q|K)?t=e.overallVelocity:n&q?t=e.overallVelocityX:n&K&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&p(t)>this.options.velocity&&e.eventType&$},emit:function(e){var t=ze(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(Ze,Fe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&V&&0===this.count)return this.failTimeout();if(r&&o&&n){if(e.eventType!=$)return this.failTimeout();var i=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||oe(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&i?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=Le,this.tryEmit()},t.interval,this),Ie):Le}return 32},failTimeout:function(){return this._timer=d(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Le&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Je.VERSION="2.0.7",Je.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Xe,{enable:!1}],[qe,{enable:!1},["rotate"]],[Ye,{direction:q}],[He,{direction:q},["swipe"]],[Ze],[Ze,{event:"doubletap",taps:2},["tap"]],[Ke]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Qe(e,t){var n;this.options=a({},Je.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(D?he:I?we:B?Ee:ue))(n,Q),this.touchAction=new Be(this,this.options.touchAction),et(this,!0),v(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function et(e,t){var n,r=e.element;r.style&&(v(e.options.cssProps,function(o,i){n=R(r.style,i),t?(e.oldCssProps[n]=r.style[n],r.style[n]=o):r.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Qe.prototype={set:function(e){return a(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,o=t.curRecognizer;(!o||o&&o.state&Le)&&(o=t.curRecognizer=null);for(var i=0;i<r.length;)n=r[i],2===t.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&n.state&(Ie|Ne|Ve)&&(o=t.curRecognizer=n),i++}},get:function(e){if(e instanceof Fe)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(h(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(h(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=S(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==i&&t!==i){var n=this.handlers;return v(j(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==i){var n=this.handlers;return v(j(e),function(e){t?n[e]&&n[e].splice(S(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=r.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var o=0;o<n.length;)n[o](t),o++}},destroy:function(){this.element&&et(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},a(Je,{INPUT_START:V,INPUT_MOVE:L,INPUT_END:$,INPUT_CANCEL:F,STATE_POSSIBLE:De,STATE_BEGAN:Ie,STATE_CHANGED:Ne,STATE_ENDED:Ve,STATE_RECOGNIZED:Le,STATE_CANCELLED:$e,STATE_FAILED:32,DIRECTION_NONE:U,DIRECTION_LEFT:z,DIRECTION_RIGHT:W,DIRECTION_UP:G,DIRECTION_DOWN:H,DIRECTION_HORIZONTAL:q,DIRECTION_VERTICAL:K,DIRECTION_ALL:X,Manager:Qe,Input:J,TouchAction:Be,TouchInput:we,MouseInput:ue,PointerEventInput:he,TouchMouseInput:Ee,SingleTouchInput:ge,Recognizer:Fe,AttrRecognizer:Ge,Tap:Ze,Pan:He,Swipe:Ye,Pinch:qe,Rotate:Xe,Press:Ke,on:C,off:E,each:v,merge:g,extend:m,assign:a,inherit:b,bindFn:_,prefixed:R}),(void 0!==n?n:"undefined"!=typeof self?self:{}).Hammer=Je,"function"==typeof i&&i.amd?i(function(){return Je}):e.exports?e.exports=Je:n.Hammer=Je}(window,document)}),Qo=.2,ei=4,ti=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function ni(e,t){return t.get(e,!1)}function ri(e){e.preventDefault(),e.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation()}function oi(e){function t(t){setTimeout(function(){p(ti,function(t){pt.unbind(e,t,ri,!0)})},500)}pt.bind(e,"touchstart",function(t){p(ti,function(t){pt.bind(e,t,ri,!0)})},!0),pt.bind(e,"touchend",t,!0),pt.bind(e,"touchcancel",t,!0);var n=new Jo.Manager(e,{inputClass:Jo.TouchInput,recognizers:[]}),r=new Jo.Tap,o=new Jo.Pan({threshold:10}),i=new Jo.Press,a=new Jo.Pinch,s=new Jo.Tap({event:"doubletap",taps:2});return a.requireFailure(o),a.requireFailure(i),n.add([o,i,a,s,r]),n.reset=function(e){var t=this.recognizers,r=this.session;r.stopped||(n.stop(e),setTimeout(function(){var e,n;for(e=0;n=t[e];e++)n.reset(),n.state=8;r.curRecognizer=null},0))},n.on("hammer.input",function(e){e.srcEvent.defaultPrevented&&n.reset(!0)}),n}function ii(e,t,n,r,o){var i,a=ni("dragging",e),s=ni("move",e),c=ni("contextPad",e),u=ni("palette",e);function l(e){return function(t){o.fire(e,t)}}function p(e){return st(e,"svg, .djs-element",!0)}function f(e){function n(e){var n=p(e.target),o=n&&r.get(n);if(s&&t.getRootElement()!==o)return s.start(e,o,!0);!function(e){var n=0,r=0;function o(e){var o=e.deltaX-n,i=e.deltaY-r;t.scroll({dx:o,dy:i}),n=e.deltaX,r=e.deltaY}function a(e){i.off("panmove",o),i.off("panend",a),i.off("pancancel",a)}i.on("panmove",o),i.on("panend",a),i.on("pancancel",a)}()}(i=oi(e)).on("doubletap",l("element.dblclick")),i.on("tap",l("element.click")),i.on("panstart",n),i.on("press",n),i.on("pinchstart",function(e){var n=t.zoom(),r=e.center;function o(e){var o=1-(1-e.scale)/1.5,i=Math.max(Qo,Math.min(ei,o*n));t.zoom(i,r),ri(e)}function a(e){i.off("pinchmove",o),i.off("pinchend",a),i.off("pinchcancel",a),i.reset(!0)}i.on("pinchmove",o),i.on("pinchend",a),i.on("pinchcancel",a)})}a&&n.on("drag.move",function(e){var t=e.originalEvent;if(t&&!(t instanceof MouseEvent)){var n=Yr(t),o=p(document.elementFromPoint(n.x,n.y)),i=o&&r.get(o);i!==e.hover&&(e.hover&&a.out(e),i&&(a.hover({element:i,gfx:o}),e.hover=i,e.hoverGfx=o))}}),c&&n.on("contextPad.create",function(e){var t=oi(e.pad.html);t.on("panstart",function(e){c.trigger("dragstart",e,!0)}),t.on("press",function(e){c.trigger("dragstart",e,!0)}),t.on("tap",function(e){c.trigger("click",e)})}),u&&n.on("palette.create",function(e){var t=oi(e.container);t.on("panstart",function(e){u.trigger("dragstart",e,!0)}),t.on("press",function(e){u.trigger("dragstart",e,!0)}),t.on("tap",function(e){u.trigger("click",e)})}),n.on("canvas.init",function(e){f(e.svg)})}function ai(e,t){var n=this;t.on("canvas.init",function(e){n.addBBoxMarker(e.svg)})}ii.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"],ai.$inject=["canvas","eventBus"],ai.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=En("rect");fn(n,{x:-1e4,y:1e4,width:10,height:10}),fn(n,t),cn(e,n);var r=En("rect");fn(r,{x:1e4,y:1e4,width:10,height:10}),fn(r,t),cn(e,r)};var si={__depends__:[{__depends__:[no],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",ii],touchFix:["type",ai]}]};function ci(e){Bo.call(this,e)}function ui(e){this._commandStack=e.get("commandStack",!1)}Gt(ci,Bo),ci.prototype._navigationModules=[zo,Zo,si],ci.prototype._modules=[].concat(ci.prototype._modules,ci.prototype._navigationModules),ui.$inject=["injector"],ui.prototype.allowed=function(e,t){var n=!0,r=this._commandStack;return r&&(n=r.canExecute(e,t)),void 0===n||n};var li={__init__:["rules"],rules:["type",ui]},pi=Math.round,fi="djs-drag-active";function di(e){e.preventDefault()}function hi(e,t,n){var r,o={threshold:5,trapClick:!0};function i(e){var n=t.viewbox(),r=t._container.getBoundingClientRect();return{x:n.x+pi((e.x-r.left)/n.scale),y:n.y+pi((e.y-r.top)/n.scale)}}function a(t,n){n=n||r;var o=e.createEvent(S({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,o)&&e.fire(n.prefix+"."+t,o)}function s(e,o){var s,c=r.payload,u=r.displacement,l=r.globalStart,p=Yr(e),f=Io(p,l),d=r.localStart,v=i(p),y=Io(v,d);if(!r.active&&(o||(s=f,Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2))>r.threshold))){if(S(c,{x:d.x+u.x,y:d.y+u.y,dx:0,dy:0},{originalEvent:e}),!1===a("start"))return h();r.active=!0,r.keepSelection||(c.previousSelection=n.get(),n.select(null)),r.cursor&&Go(r.cursor),t.addMarker(t.getRootElement(),fi)}Xr(e),r.active&&(S(c,{x:v.x+u.x,y:v.y+u.y,dx:y.x,dy:y.y},{originalEvent:e}),a("move"))}function c(e){var t=!0;r.active&&(e&&(r.payload.originalEvent=e,Xr(e)),t=a("end")),!1===t&&a("rejected"),a("ended",v(!0!==t))}function u(e){27===e.which&&(di(e),h())}function l(t){var n;r.active&&(n=Ko(e),setTimeout(n,400),di(t)),c(t)}function p(e){s(e)}function f(e){var t=r.payload;t.hoverGfx=e.gfx,t.hover=e.element,a("hover")}function d(e){a("out");var t=r.payload;t.hoverGfx=null,t.hover=null}function h(e){var t;if(r){var n=r.active;n&&a("cancel"),t=v(e),n&&a("canceled",t)}}function v(o){var i,v;a("cleanup"),Ho(),v=r.trapClick?l:c,pt.unbind(document,"mousemove",s),pt.unbind(document,"dragstart",di),pt.unbind(document,"selectstart",di),pt.unbind(document,"mousedown",v,!0),pt.unbind(document,"mouseup",v,!0),pt.unbind(document,"keyup",u),pt.unbind(document,"touchstart",p,!0),pt.unbind(document,"touchcancel",h,!0),pt.unbind(document,"touchmove",s,!0),pt.unbind(document,"touchend",c,!0),e.off("element.hover",f),e.off("element.out",d),t.removeMarker(t.getRootElement(),fi);var y=r.payload.previousSelection;return!1!==o&&y&&!n.get().length&&n.select(y),i=r,r=null,i}e.on("diagram.destroy",h),this.init=function(t,n,v,y){r&&h(!1),"string"==typeof n&&(y=v,v=n,n=null);var m,g,b,_,w,x=(y=S({},o,y||{})).data||{};_=y.trapClick?l:c,t?(m=Kr(t)||t,g=Yr(t),Xr(t),"dragstart"===m.type&&di(m)):(m=null,g={x:0,y:0}),b=i(g),n||(n=b),w=function(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}(m),r=S({prefix:v,data:x,payload:{},globalStart:g,displacement:Io(n,b),localStart:b,isTouch:w},y),y.manual||(w?(pt.bind(document,"touchstart",p,!0),pt.bind(document,"touchcancel",h,!0),pt.bind(document,"touchmove",s,!0),pt.bind(document,"touchend",c,!0)):(pt.bind(document,"mousemove",s),pt.bind(document,"dragstart",di),pt.bind(document,"selectstart",di),pt.bind(document,"mousedown",_,!0),pt.bind(document,"mouseup",_,!0)),pt.bind(document,"keyup",u),e.on("element.hover",f),e.on("element.out",d)),a("init"),y.autoActivate&&s(t,!0)},this.move=s,this.hover=f,this.out=d,this.end=c,this.cancel=h,this.context=function(){return r},this.setOptions=function(e){S(o,e)}}function vi(e,t,n){var r=this;e.on("drag.start",function(t){e.once("drag.move",function(){e.once("drag.move",function(e){r.ensureHover(e)})})}),this.ensureHover=function(e){if(!e.hover){var r,o,i,a=e.originalEvent;a instanceof MouseEvent&&(r=Yr(a),(i=function(e){return st(e,"svg, .djs-element",!0)}(document.elementFromPoint(r.x,r.y)))&&(o=n.get(i),t.hover({element:o,gfx:i})))}}}hi.$inject=["eventBus","canvas","selection"],vi.$inject=["eventBus","dragging","elementRegistry"];var yi={__init__:["hoverFix"],__depends__:[po],dragging:["type",hi],hoverFix:["type",vi]};function mi(e,t,n){this._elementRegistry=e,this._canvas=t,this._styles=n}mi.$inject=["elementRegistry","canvas","styles"],mi.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},mi.prototype.addDragger=function(e,t){var n=this.getGfx(e),r=n.cloneNode(!0),o=n.getBoundingClientRect();return function(e){return e.waypoints}(e)&&function e(t){t.children&&p(t.children,function(t){e(t)});t.style.markerStart="";t.style.markerEnd=""}(r),fn(r,this._styles.cls("djs-dragger",[],{x:o.top,y:o.left})),cn(t,r),r},mi.prototype.addFrame=function(e,t){var n=En("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return cn(t,n),n};var gi={__init__:["previewSupport"],previewSupport:["type",mi]},bi=500,_i=1250,wi=1500,xi=Math.round;function Ci(e,t,n,r,o){function i(e,t,n,r){return o.allowed("elements.move",{shapes:e,delta:t,position:n,target:r})}function a(e,n,r){if(!n.waypoints&&n.parent){var o=function(e){return{x:e.x+xi(e.width/2),y:e.y+xi(e.height/2)}}(n);return t.init(e,o,"shape.move",{cursor:"grabbing",autoActivate:r,data:{shape:n,context:{}}}),!0}}e.on("shape.move.start",wi,function(e){var t,n,o=e.context,i=e.shape,a=r.get().slice();-1===a.indexOf(i)&&(a=[i]),n=m(t=a,"id"),S(o,{shapes:a=l(t,function(e){for(;e=e.parent;)if(n[e.id])return!1;return!0}),validatedShapes:a,shape:i})}),e.on("shape.move.start",_i,function(e){var t=e.context,n=t.validatedShapes;if(!(t.canExecute=i(n)))return!1}),e.on("shape.move.move",bi,function(e){var t,n=e.context,r=n.validatedShapes,o=e.hover,a={x:e.dx,y:e.dy};t=i(r,a,{x:e.x,y:e.y},o),n.delta=a,n.canExecute=t,n.target=null!==t?o:null}),e.on("shape.move.end",function(e){var t=e.context,r=t.delta,o=t.canExecute,i="attach"===o,a=t.shapes;if(!o)return!1;r.x=xi(r.x),r.y=xi(r.y),n.moveElements(a,r,t.target,{primaryShape:t.shape,attach:i})}),e.on("element.mousedown",function(e){var t=Kr(e);if(!t)throw new Error("must supply DOM mousedown event");return a(t,e.element)}),this.start=a}Ci.$inject=["eventBus","dragging","modeling","selection","rules"];var Ei=499,Oi="djs-dragging",ki="drop-ok",ji="drop-not-ok",Si="new-parent",Pi="attach-ok";function Ti(t,n,r,o,i){function a(e){return function(e){return l(e,function(t){return!function(e){return e.waypoints}(t)||u(e,b({id:t.source.id}))&&u(e,b({id:t.target.id}))})}(s(e))}function s(t){var n=qn(t,!0),r=v(n,function(e){return(e.incoming||[]).concat(e.outgoing||[])});return e(n.concat(r))}function c(e,t){[Pi,ki,ji,Si].forEach(function(n){n===t?r.addMarker(e,n):r.removeMarker(e,n)})}t.on("shape.move.start",Ei,function(t){var n=t.context,c=n.shapes,u=n.allDraggedElements,l=a(c);if(!n.dragGroup){var f=En("g");fn(f,o.cls("djs-drag-group",["no-events"])),cn(r.getDefaultLayer(),f),n.dragGroup=f}l.forEach(function(e){i.addDragger(e,n.dragGroup)}),p(u=u?e(u,s(c)):s(c),function(e){r.addMarker(e,Oi)}),n.allDraggedElements=u,n.differentParents=1!==y(m(c,function(e){return e.parent&&e.parent.id})).length}),t.on("shape.move.move",Ei,function(e){var t=e.context,n=t.dragGroup,r=t.target,o=t.shape.parent,i=t.canExecute;r&&("attach"===i?c(r,Pi):t.canExecute&&r&&r.id!==o.id?c(r,Si):c(r,t.canExecute?ki:ji)),xr(n,e.dx,e.dy)}),t.on(["shape.move.out","shape.move.cleanup"],function(e){var t=e.context.target;t&&c(t,null)}),t.on("shape.move.cleanup",function(e){var t=e.context,n=t.allDraggedElements,o=t.dragGroup;p(n,function(e){r.removeMarker(e,Oi)}),o&&_n(o)}),this.makeDraggable=function(e,t,n){i.addDragger(t,e.dragGroup),n&&r.addMarker(t,Oi),e.allDraggedElements?e.allDraggedElements.push(t):e.allDraggedElements=[t]}}Ti.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var Ri={__depends__:[no,po,io,li,yi,gi],__init__:["move","movePreview"],move:["type",Ci],movePreview:["type",Ti]};function Ai(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}function Mi(e,t,n,r){if(void 0===r&&(r=5),!e||!t||!n)return!1;var o=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),i=Ai(e,t);return Math.abs(o/i)<=r}var Bi=2;function Di(e,t){return Math.abs(e.x-t.x)<=Bi?"h":Math.abs(e.y-t.y)<=Bi&&"v"}function Ii(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var Ni="djs-bendpoint",Vi="djs-segment-dragger";function Li(e,t){var n=En("g");mn(n).add(Ni),cn(e,n);var r=En("circle");fn(r,{cx:0,cy:0,r:4}),mn(r).add("djs-visual"),cn(n,r);var o=En("circle");return fn(o,{cx:0,cy:0,r:10}),mn(o).add("djs-hit"),cn(n,o),t&&mn(n).add(t),n}function $i(e,t,n){var r=En("g");cn(e,r);var o=En("rect");fn(o,{x:-7,y:-1.5,width:14,height:3}),mn(o).add("djs-visual"),cn(r,o);var i=En("rect");return fn(i,{x:-10,y:-4.5,width:20,height:9}),mn(i).add("djs-hit"),cn(r,i),function(e,t){var n=jn();n.setRotate(t,0,0),Dn(e,n)}(r,"h"===n?90:0),r}function Fi(e,t,n){var r=En("g"),o=Ii(t,n),i=Di(t,n);return cn(e,r),$i(r,0,i),mn(r).add(Vi),mn(r).add("h"===i?"vertical":"horizontal"),xr(r,o.x,o.y),r}var Ui=X(function(e,t){var n,r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=K,r=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,n=String(e),r=n.length,o=-1,i="",a=n.charCodeAt(0);++o<r;)0!=(t=n.charCodeAt(o))?i+=t>=1&&t<=31||127==t||0==o&&t>=48&&t<=57||1==o&&t>=48&&t<=57&&45==a?"\\"+t.toString(16)+" ":(0!=o||1!=r||45!=t)&&(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?n.charAt(o):"\\"+n.charAt(o):i+="";return i};return e.CSS||(e.CSS={}),e.CSS.escape=t,t},"object"==o(t)?e.exports=r(n):r(n)}),zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wi="hasOwnProperty",Gi=/,?([a-z]),?/gi,Hi=parseFloat,qi=Math,Ki=qi.PI,Xi=qi.min,Yi=qi.max,Zi=qi.pow,Ji=qi.abs,Qi=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,ea=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;
/**
   * This file contains portions that got extraced from Snap.svg (licensed Apache-2.0).
   *
   * @see https://github.com/adobe-webplatform/Snap.svg/blob/master/src/path.js
   */function ta(e,t){return"finite"==(t=String.prototype.toLowerCase.call(t))?isFinite(e):!("array"!=t||!(e instanceof Array||Array.isArray&&Array.isArray(e)))||("null"==t&&null===e||t==(void 0===e?"undefined":zi(e))&&null!==e||"object"==t&&e===Object(e)||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()==t)}function na(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[Wi](n)&&(t[n]=na(e[n]));return t}function ra(e){var t=ra.ps=ra.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[Wi](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function oa(e,t,n,r){return null==e&&(e=t=n=r=0),null==t&&(t=e.y,n=e.width,r=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:r,h:r,x2:e+n,y2:t+r,cx:e+n/2,cy:t+r/2,r1:qi.min(n,r)/2,r2:qi.max(n,r)/2,r0:qi.sqrt(n*n+r*r)/2,path:function(e,t,n,r,o){if(o)return[["M",+e+ +o,t],["l",n-2*o,0],["a",o,o,0,0,1,o,o],["l",0,r-2*o],["a",o,o,0,0,1,-o,o],["l",2*o-n,0],["a",o,o,0,0,1,-o,-o],["l",0,2*o-r],["a",o,o,0,0,1,o,-o],["z"]];var i=[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]];return i.toString=ia,i}(e,t,n,r),vb:[e,t,n,r].join(" ")}}function ia(){return this.join(",").replace(Gi,"$1")}function aa(e){var t=na(e);return t.toString=ia,t}function sa(e,t,n,r,o,i,a,s,c){var u=1-c,l=Zi(u,3),p=Zi(u,2),f=c*c,d=f*c,h=e+2*c*(n-e)+f*(o-2*n+e),v=t+2*c*(r-t)+f*(i-2*r+t),y=n+2*c*(o-n)+f*(a-2*o+n),m=r+2*c*(i-r)+f*(s-2*i+r);return{x:l*e+3*p*c*n+3*u*c*c*o+d*a,y:l*t+3*p*c*r+3*u*c*c*i+d*s,m:{x:h,y:v},n:{x:y,y:m},start:{x:u*e+c*n,y:u*t+c*r},end:{x:u*o+c*a,y:u*i+c*s},alpha:90-180*qi.atan2(h-y,v-m)/Ki}}function ca(e,t,n,r,o,i,a,s){ta(e,"array")||(e=[e,t,n,r,o,i,a,s]);var c=function(e,t,n,r,o,i,a,s){for(var c,u,l,p,f,d,h,v,y=[],m=[[],[]],g=0;g<2;++g)if(0==g?(u=6*e-12*n+6*o,c=-3*e+9*n-9*o+3*a,l=3*n-3*e):(u=6*t-12*r+6*i,c=-3*t+9*r-9*i+3*s,l=3*r-3*t),Ji(c)<1e-12){if(Ji(u)<1e-12)continue;0<(p=-l/u)&&p<1&&y.push(p)}else h=u*u-4*l*c,v=qi.sqrt(h),h<0||(0<(f=(-u+v)/(2*c))&&f<1&&y.push(f),0<(d=(-u-v)/(2*c))&&d<1&&y.push(d));var b,_=y.length,w=_;for(;_--;)p=y[_],b=1-p,m[0][_]=b*b*b*e+3*b*b*p*n+3*b*p*p*o+p*p*p*a,m[1][_]=b*b*b*t+3*b*b*p*r+3*b*p*p*i+p*p*p*s;return m[0][w]=e,m[1][w]=t,m[0][w+1]=a,m[1][w+1]=s,m[0].length=m[1].length=w+2,{min:{x:Xi.apply(0,m[0]),y:Xi.apply(0,m[1])},max:{x:Yi.apply(0,m[0]),y:Yi.apply(0,m[1])}}}.apply(null,e);return oa(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function ua(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function la(e,t,n,r,o){return e*(e*(-3*t+9*n-9*r+3*o)+6*t-12*n+6*r)-3*t+3*n}function pa(e,t,n,r,o,i,a,s,c){null==c&&(c=1);for(var u=(c=c>1?1:c<0?0:c)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,d=0;d<12;d++){var h=u*l[d]+u,v=la(h,e,n,o,a),y=la(h,t,r,i,s),m=v*v+y*y;f+=p[d]*qi.sqrt(m)}return u*f}function fa(e,t,n,r,o,i,a,s){if(!(Yi(e,n)<Xi(o,a)||Xi(e,n)>Yi(o,a)||Yi(t,r)<Xi(i,s)||Xi(t,r)>Yi(i,s))){var c=(e-n)*(i-s)-(t-r)*(o-a);if(c){var u=((e*r-t*n)*(o-a)-(e-n)*(o*s-i*a))/c,l=((e*r-t*n)*(i-s)-(t-r)*(o*s-i*a))/c,p=+u.toFixed(2),f=+l.toFixed(2);if(!(p<+Xi(e,n).toFixed(2)||p>+Yi(e,n).toFixed(2)||p<+Xi(o,a).toFixed(2)||p>+Yi(o,a).toFixed(2)||f<+Xi(t,r).toFixed(2)||f>+Yi(t,r).toFixed(2)||f<+Xi(i,s).toFixed(2)||f>+Yi(i,s).toFixed(2)))return{x:u,y:l}}}}function da(e,t,n){if(!function(e,t){return e=oa(e),ua(t=oa(t),e.x,e.y)||ua(t,e.x2,e.y)||ua(t,e.x,e.y2)||ua(t,e.x2,e.y2)||ua(e,t.x,t.y)||ua(e,t.x2,t.y)||ua(e,t.x,t.y2)||ua(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}(ca(e),ca(t)))return n?0:[];for(var r=~~(pa.apply(0,e)/5),o=~~(pa.apply(0,t)/5),i=[],a=[],s={},c=n?0:[],u=0;u<r+1;u++){var l=sa.apply(0,e.concat(u/r));i.push({x:l.x,y:l.y,t:u/r})}for(u=0;u<o+1;u++)l=sa.apply(0,t.concat(u/o)),a.push({x:l.x,y:l.y,t:u/o});for(u=0;u<r;u++)for(var p=0;p<o;p++){var f=i[u],d=i[u+1],h=a[p],v=a[p+1],y=Ji(d.x-f.x)<.01?"y":"x",m=Ji(v.x-h.x)<.01?"y":"x",g=fa(f.x,f.y,d.x,d.y,h.x,h.y,v.x,v.y);if(g){if(s[g.x.toFixed(0)]==g.y.toFixed(0))continue;s[g.x.toFixed(0)]=g.y.toFixed(0);var b=f.t+Ji((g[y]-f[y])/(d[y]-f[y]))*(d.t-f.t),_=h.t+Ji((g[m]-h[m])/(v[m]-h[m]))*(v.t-h.t);b>=0&&b<=1&&_>=0&&_<=1&&(n?c++:c.push({x:g.x,y:g.y,t1:b,t2:_}))}}return c}function ha(e,t,n,r,o){if(null==o&&null==r&&(r=n),e=+e,t=+t,n=+n,r=+r,null!=o)var i=Math.PI/180,a=e+n*Math.cos(-r*i),s=e+n*Math.cos(-o*i),c=[["M",a,t+n*Math.sin(-r*i)],["A",n,n,0,+(o-r>180),0,s,t+n*Math.sin(-o*i)]];else c=[["M",e,t],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]];return c.toString=ia,c}function va(e){var t=ra(e);if(t.abs)return aa(t.abs);if(ta(e,"array")&&ta(e&&e[0],"array")||(e=function(e){if(!e)return null;var t=ra(e);if(t.arr)return na(t.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return ta(e,"array")&&ta(e[0],"array")&&(r=na(e)),r.length||String(e).replace(Qi,function(e,t,o){var i=[],a=t.toLowerCase();if(o.replace(ea,function(e,t){t&&i.push(+t)}),"m"==a&&i.length>2&&(r.push([t].concat(i.splice(0,2))),a="l",t="m"==t?"l":"L"),"o"==a&&1==i.length&&r.push([t,i[0]]),"r"==a)r.push([t].concat(i));else for(;i.length>=n[a]&&(r.push([t].concat(i.splice(0,n[a]))),n[a]););}),r.toString=ra.toString,t.arr=na(r),r}(e)),!e||!e.length)return[["M",0,0]];var n,r=[],o=0,i=0,a=0,s=0,c=0;"M"==e[0][0]&&(a=o=+e[0][1],s=i=+e[0][2],c++,r[0]=["M",o,i]);for(var u,l,p=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),f=c,d=e.length;f<d;f++){if(r.push(u=[]),(n=(l=e[f])[0])!=n.toUpperCase())switch(u[0]=n.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+o,u[7]=+l[7]+i;break;case"V":u[1]=+l[1]+i;break;case"H":u[1]=+l[1]+o;break;case"R":for(var h=[o,i].concat(l.slice(1)),v=2,y=h.length;v<y;v++)h[v]=+h[v]+o,h[++v]=+h[v]+i;r.pop(),r=r.concat(ba(h,p));break;case"O":r.pop(),(h=ha(o,i,l[1],l[2])).push(h[0]),r=r.concat(h);break;case"U":r.pop(),r=r.concat(ha(o,i,l[1],l[2],l[3])),u=["U"].concat(r[r.length-1].slice(-2));break;case"M":a=+l[1]+o,s=+l[2]+i;default:for(v=1,y=l.length;v<y;v++)u[v]=+l[v]+(v%2?o:i)}else if("R"==n)h=[o,i].concat(l.slice(1)),r.pop(),r=r.concat(ba(h,p)),u=["R"].concat(l.slice(-2));else if("O"==n)r.pop(),(h=ha(o,i,l[1],l[2])).push(h[0]),r=r.concat(h);else if("U"==n)r.pop(),r=r.concat(ha(o,i,l[1],l[2],l[3])),u=["U"].concat(r[r.length-1].slice(-2));else for(var m=0,g=l.length;m<g;m++)u[m]=l[m];if("O"!=(n=n.toUpperCase()))switch(u[0]){case"Z":o=+a,i=+s;break;case"H":o=u[1];break;case"V":i=u[1];break;case"M":a=u[u.length-2],s=u[u.length-1];default:o=u[u.length-2],i=u[u.length-1]}}return r.toString=ia,t.abs=aa(r),r}function ya(e,t,n,r){return[e,t,n,r,n,r]}function ma(e,t,n,r,o,i){return[1/3*e+2/3*n,1/3*t+2/3*r,1/3*o+2/3*n,1/3*i+2/3*r,o,i]}function ga(e,t,n,r,o,i,a,s,c,u){var l,p,f,d,h=120*Ki/180,v=Ki/180*(+o||0),y=[],m=(p=function(e,t,n){return{x:e*qi.cos(n)-t*qi.sin(n),y:e*qi.sin(n)+t*qi.cos(n)}},function e(){var t=Array.prototype.slice.call(arguments,0),n=t.join(""),r=e.cache=e.cache||{},o=e.count=e.count||[];return r[Wi](n)?(function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}(o,n),d?d(r[n]):r[n]):(o.length>=1e3&&delete r[o.shift()],o.push(n),r[n]=p.apply(f,t),d?d(r[n]):r[n])});if(u)k=u[0],j=u[1],E=u[2],O=u[3];else{e=(l=m(e,t,-v)).x,t=l.y;var g=(e-(s=(l=m(s,c,-v)).x))/2,b=(t-(c=l.y))/2,_=g*g/(n*n)+b*b/(r*r);_>1&&(n*=_=qi.sqrt(_),r*=_);var w=n*n,x=r*r,C=(i==a?-1:1)*qi.sqrt(Ji((w*x-w*b*b-x*g*g)/(w*b*b+x*g*g))),E=C*n*b/r+(e+s)/2,O=C*-r*g/n+(t+c)/2,k=qi.asin(((t-O)/r).toFixed(9)),j=qi.asin(((c-O)/r).toFixed(9));k=e<E?Ki-k:k,j=s<E?Ki-j:j,k<0&&(k=2*Ki+k),j<0&&(j=2*Ki+j),a&&k>j&&(k-=2*Ki),!a&&j>k&&(j-=2*Ki)}var S=j-k;if(Ji(S)>h){var P=j,T=s,R=c;j=k+h*(a&&j>k?1:-1),y=ga(s=E+n*qi.cos(j),c=O+r*qi.sin(j),n,r,o,0,a,T,R,[j,P,E,O])}S=j-k;var A=qi.cos(k),M=qi.sin(k),B=qi.cos(j),D=qi.sin(j),I=qi.tan(S/4),N=4/3*n*I,V=4/3*r*I,L=[e,t],$=[e+N*M,t-V*A],F=[s+N*D,c-V*B],U=[s,c];if($[0]=2*L[0]-$[0],$[1]=2*L[1]-$[1],u)return[$,F,U].concat(y);for(var z=[],W=0,G=(y=[$,F,U].concat(y).join().split(",")).length;W<G;W++)z[W]=W%2?m(y[W-1],y[W],v).y:m(y[W],y[W+1],v).x;return z}function ba(e,t){for(var n=[],r=0,o=e.length;o-2*!t>r;r+=2){var i=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];t?r?o-4==r?i[3]={x:+e[0],y:+e[1]}:o-2==r&&(i[2]={x:+e[0],y:+e[1]},i[3]={x:+e[2],y:+e[3]}):i[0]={x:+e[o-2],y:+e[o-1]}:o-4==r?i[3]=i[2]:r||(i[0]={x:+e[r],y:+e[r+1]}),n.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return n}function _a(e,t){var n=!t&&ra(e);if(!t&&n.curve)return aa(n.curve);for(var r=va(e),o=t&&va(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=function(e,t,n){var r,o;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(ga.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*t.x-t.bx,o=2*t.y-t.by):(r=t.x,o=t.y),e=["C",r,o].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(ma(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(ma(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(ya(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(ya(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(ya(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(ya(t.x,t.y,t.X,t.Y))}return e},c=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)l[t]="A",o&&(p[t]="A"),e.splice(t++,0,["C"].concat(n.splice(0,6)));e.splice(t,1),v=Yi(r.length,o&&o.length||0)}},u=function(e,t,n,i,a){e&&t&&"M"==e[a][0]&&"M"!=t[a][0]&&(t.splice(a,0,["M",i.x,i.y]),n.bx=0,n.by=0,n.x=e[a][1],n.y=e[a][2],v=Yi(r.length,o&&o.length||0))},l=[],p=[],f="",d="",h=0,v=Yi(r.length,o&&o.length||0);h<v;h++){r[h]&&(f=r[h][0]),"C"!=f&&(l[h]=f,h&&(d=l[h-1])),r[h]=s(r[h],i,d),"A"!=l[h]&&"C"==f&&(l[h]="C"),c(r,h),o&&(o[h]&&(f=o[h][0]),"C"!=f&&(p[h]=f,h&&(d=p[h-1])),o[h]=s(o[h],a,d),"A"!=p[h]&&"C"==f&&(p[h]="C"),c(o,h)),u(r,o,i,a,h),u(o,r,a,i,h);var y=r[h],m=o&&o[h],g=y.length,b=o&&m.length;i.x=y[g-2],i.y=y[g-1],i.bx=Hi(y[g-4])||i.x,i.by=Hi(y[g-3])||i.y,a.bx=o&&(Hi(m[b-4])||a.x),a.by=o&&(Hi(m[b-3])||a.y),a.x=o&&m[b-2],a.y=o&&m[b-1]}return o||(n.curve=aa(r)),o?[r,o]:r}var wa=function(e,t,n){e=_a(e),t=_a(t);for(var r,o,i,a,s,c,u,l,p,f,d=n?0:[],h=0,v=e.length;h<v;h++){var y=e[h];if("M"==y[0])r=s=y[1],o=c=y[2];else{"C"==y[0]?(r=(p=[r,o].concat(y.slice(1)))[6],o=p[7]):(p=[r,o,r,o,s,c,s,c],r=s,o=c);for(var m=0,g=t.length;m<g;m++){var b=t[m];if("M"==b[0])i=u=b[1],a=l=b[2];else{"C"==b[0]?(i=(f=[i,a].concat(b.slice(1)))[6],a=f[7]):(f=[i,a,i,a,u,l,u,l],i=u,a=l);var _=da(p,f,n);if(n)d+=_;else{for(var w=0,x=_.length;w<x;w++)_[w].segment1=h,_[w].segment2=m,_[w].bez1=p,_[w].bez2=f;d=d.concat(_)}}}}}return d},xa=Math.round,Ca=Math.max;var Ea=10;function Oa(e,t){return function(e,t){var n,r;for(n=0;r=e[n];n++)if(Ai(r,t)<=Ea)return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||function(e,t){var n,r,o,i,a=wa((o=Ea,[["M",(r=t).x,r.y],["m",0,-o],["a",o,o,0,1,1,0,2*o],["a",o,o,0,1,1,0,-2*o],["z"]]),(n=[],e.forEach(function(e,t){n.push([0===t?"M":"L",e.x,e.y])}),n)),s=a[0],c=a[a.length-1];return s?s!==c?s.segment2!==c.segment2?{point:e[i=Ca(s.segment2,c.segment2)-1],bendpoint:!0,index:i}:{point:{x:xa(s.x+c.x)/2,y:xa(s.y+c.y)/2},index:s.segment2}:{point:{x:xa(s.x),y:xa(s.y)},index:s.segment2}:null}(e,t)}function ka(e,t,n,r,o){function i(e,n){return Oa(e,function(e,t){var n,r=Yr(t),o=e._container.getBoundingClientRect();n={x:o.left,y:o.top};var i=e.viewbox();return{x:i.x+(r.x-n.x)/i.scale,y:i.y+(r.y-n.y)/i.scale}}(t,n))}function a(e,t){var n=t.waypoints,a=i(n,e);if(a)return!function(e,t,n){var r,o,i,a,s,c,u=e.index,l=e.point;return!(u<=0||e.bendpoint)&&(i=Ii(r=t[u-1],o=t[u]),a=Di(r,o),s=Math.abs(l.x-i.x),c=Math.abs(l.y-i.y),a&&s<=n&&c<=n)}(a,n,10)?r.start(e,t,a.index,!a.bendpoint):o.start(e,t,a.index),!0}function s(e,t,r){pt.bind(e,t,function(e){n.triggerMouseEvent(t,e,r),e.stopPropagation()})}function c(e,n){var r=t.getLayer("overlays"),o=_t('.djs-bendpoints[data-element-id="'+Ui(e.id)+'"]',r);return!o&&n&&(fn(o=En("g"),{"data-element-id":e.id}),mn(o).add("djs-bendpoints"),cn(r,o),s(o,"mousedown",e),s(o,"click",e),s(o,"dblclick",e)),o}function u(e,t){t.waypoints.forEach(function(t,n){var r=Li(e);cn(e,r),xr(r,t.x,t.y)}),Li(e,"floating")}function l(e,t){for(var n,r,o=t.waypoints,i=1;i<o.length;i++)Di(n=o[i-1],r=o[i])&&Fi(e,n,r)}function f(e){var t=c(e);return t||(u(t=c(e,!0),e),l(t,e)),t}function d(e){var t=c(e);t&&(!function(e){p(wt("."+Vi,e),function(e){bn(e)})}(t),function(e){p(wt("."+Ni,e),function(e){bn(e)})}(t),l(t,e),u(t,e))}e.on("connection.changed",function(e){d(e.element)}),e.on("connection.remove",function(e){var t=c(e.element);t&&bn(t)}),e.on("element.marker.update",function(e){var t,n=e.element;n.waypoints&&(t=f(n),e.add?mn(t).add(e.marker):mn(t).remove(e.marker))}),e.on("element.mousemove",function(e){var t,n,r=e.element,o=r.waypoints;if(o){if(!(t=_t(".floating",c(r,!0))))return;(n=i(o,e.originalEvent))&&xr(t,n.point.x,n.point.y)}}),e.on("element.mousedown",function(e){var t=e.originalEvent,n=e.element,r=n.waypoints;if(r)return a(t,n)}),e.on("selection.changed",function(e){var t=e.newSelection[0];t&&t.waypoints&&f(t)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(f(t),n.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){n.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,n=e.newId;if(t.waypoints){var r=c(t);r&&fn(r,{"data-element-id":n})}}),this.addHandles=f,this.updateHandles=d,this.getBendpointsContainer=c}ka.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var ja="connect-ok",Sa="connect-not-ok",Pa="connect-hover",Ta="djs-updating",Ra="connection.updateWaypoints",Aa="connection.reconnectStart",Ma="connection.reconnectEnd",Ba=Math.round;function Da(e,t,n,r,o,i,a){var s=e.get("connectionDocking",!1);function c(e){o.update("connection",e.connection,e.connectionGfx)}this.start=function(e,t,o,i){var a,s=t.waypoints,c=n.getGraphics(t);a={connection:t,bendpointIndex:o,insert:i,type:i||0!==o?i||o!==s.length-1?Ra:Ma:Aa},r.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:c,context:a}})},t.on("bendpoint.move.start",function(e){var t=e.context,r=t.connection,o=r.waypoints,i=o.slice(),a=t.insert,s=t.bendpointIndex;t.originalWaypoints=o,a&&i.splice(s,0,null),r.waypoints=i,t.draggerGfx=Li(n.getLayer("overlays")),mn(t.draggerGfx).add("djs-dragging"),n.addMarker(r,Ta)}),t.on("bendpoint.move.hover",function(e){var t=e.context;if(t.hover=e.hover,e.hover){n.addMarker(e.hover,Pa);var r=t.allowed=i.allowed(t.type,t);r?(n.removeMarker(t.hover,Sa),n.addMarker(t.hover,ja),t.target=t.hover):!1===r&&(n.removeMarker(t.hover,ja),n.addMarker(t.hover,Sa),t.target=null)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var t=e.context.hover;t&&(n.removeMarker(t,Pa),n.removeMarker(t,e.context.target?ja:Sa))}),t.on("bendpoint.move.move",function(e){var t,n,r=e.context,o=r.type,i=e.connection;i.waypoints[r.bendpointIndex]={x:e.x,y:e.y},s&&(r.hover&&(o===Aa&&(t=r.hover),o===Ma&&(n=r.hover)),i.waypoints=s.getCroppedWaypoints(i,t,n)),xr(r.draggerGfx,e.x,e.y),c(e)}),t.on(["bendpoint.move.end","bendpoint.move.cancel"],function(e){var t=e.context,r=t.hover,o=t.connection;bn(t.draggerGfx),t.newWaypoints=o.waypoints.slice(),o.waypoints=t.originalWaypoints,n.removeMarker(o,Ta),r&&(n.removeMarker(r,ja),n.removeMarker(r,Sa))}),t.on("bendpoint.move.end",function(e){var t,n=e.context,r=n.newWaypoints,o=n.bendpointIndex,i=r[o],s=n.allowed;if(i.x=Ba(i.x),i.y=Ba(i.y),s&&n.type===Aa)a.reconnectStart(n.connection,n.target,i);else if(s&&n.type===Ma)a.reconnectEnd(n.connection,n.target,i);else{if(!1===s||n.type!==Ra)return c(e),!1;t={bendpointMove:{insert:e.context.insert,bendpointIndex:o}},a.updateWaypoints(n.connection,function(e){e=e.slice();for(var t,n,r,o=0;e[o];)t=e[o],n=e[o-1],0===Ai(t,r=e[o+1])||Mi(n,r,t)?e.splice(o,1):o++;return e}(r),t)}}),t.on("bendpoint.move.cancel",function(e){c(e)})}function Ia(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function Na(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function Va(e){return Ia({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function La(e,t,n){o(n=n||0)||(n={x:n,y:n});var r=Na(e),i=Na(t),a=r.bottom+n.y<=i.top,s=r.left-n.x>=i.right,c=r.top-n.y>=i.bottom,u=r.right+n.x<=i.left,l=a?"top":c?"bottom":null,p=u?"left":s?"right":null;return p&&l?l+"-"+p:p||l||"intersect"}function $a(e,t,n){var r=wa(e,t);return 1===r.length?Ia(r[0]):2===r.length&&Ai(r[0],r[1])<1?Ia(r[0]):r.length>1?Ia((r=g(r,function(e){var t=Math.floor(100*e.t2)||1;return t=((t=100-t)<10?"0":"")+t,e.segment2+"#"+t}))[n?0:r.length-1]):null}Da.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","rules","modeling"];var Fa="connect-hover",Ua="djs-updating";function za(e,t,n){return Wa(e,t,e[t]+n)}function Wa(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function Ga(e){return"x"===e?"y":"x"}function Ha(e,t,n){var r,o;return e.original?e.original:(r=Va(t),Wa(e,o=Ga(n),r[o]))}function qa(e,t,n,r,o,i,a){var s=e.get("connectionDocking",!1);function c(e,t){if(!s)return t;var n,r=e.waypoints;return e.waypoints=t,n=s.getCroppedWaypoints(e),e.waypoints=r,n}function u(e){o.update("connection",e.connection,e.connectionGfx)}function l(e,t,n){var r=e.newWaypoints,o=function(e,t,n,r){var o=Math.max(t[r],n[r]),i=Math.min(t[r],n[r]);return Wa(t,r,Math.min(Math.max(i+20,e[r]),o-20))}(n,r[e.segmentStartIndex+t],r[e.segmentEndIndex+t],Ga(e.axis));xr(e.draggerGfx,o.x,o.y)}this.start=function(e,t,o){var i,a,s,c=n.getGraphics(t),u=o-1,l=o,p=t.waypoints,f=p[u],d=p[l];(a=Di(f,d))&&(s="v"===a?"y":"x",0===u&&(f=Ha(f,t.source,s)),l===p.length-1&&(d=Ha(d,t.target,s)),i={connection:t,segmentStartIndex:u,segmentEndIndex:l,segmentStart:f,segmentEnd:d,axis:s},r.init(e,{x:(f.x+d.x)/2,y:(f.y+d.y)/2},"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:c,context:i}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,r=e.connection,o=n.getLayer("overlays");t.originalWaypoints=r.waypoints.slice(),t.draggerGfx=Fi(o,t.segmentStart,t.segmentEnd),mn(t.draggerGfx).add("djs-dragging"),n.addMarker(r,Ua)}),t.on("connectionSegment.move.move",function(e){var t,n,r=e.context,o=r.connection,i=r.segmentStartIndex,a=r.segmentEndIndex,s=r.segmentStart,p=r.segmentEnd,f=r.axis,d=r.originalWaypoints.slice(),h=za(s,f,e["d"+f]),v=za(p,f,e["d"+f]),y=d.length,m=0;d[i]=h,d[a]=v,i<2&&(t=La(o.source,h),1===i?"intersect"===t&&(d.shift(),d[0]=h,m--):"intersect"!==t&&(d.unshift(s),m++)),a>y-3&&(n=La(o.target,v),a===y-2?"intersect"===n&&(d.pop(),d[d.length-1]=v):"intersect"!==n&&d.push(p)),r.newWaypoints=o.waypoints=c(o,d),l(r,m,e),r.newSegmentStartIndex=i+m,u(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,n.addMarker(e.hover,Fa)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){var t=e.context.hover;t&&n.removeMarker(t,Fa)}),t.on("connectionSegment.move.cleanup",function(e){var t=e.context,r=t.connection;t.draggerGfx&&bn(t.draggerGfx),n.removeMarker(r,Ua)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,u(e)}),t.on("connectionSegment.move.end",function(e){var t=e.context,n=t.connection,r=t.newWaypoints,o=t.newSegmentStartIndex,i=function(e,t){var n=0;return{waypoints:e.filter(function(r,o){return!Mi(e[o-1],e[o+1],r)||(n=o<=t?n-1:n,!1)}),segmentOffset:n}}(r=r.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}}),o),s=c(n,i.waypoints),u=i.segmentOffset,l={segmentMove:{segmentStartIndex:t.segmentStartIndex,newSegmentStartIndex:o+u}};a.updateWaypoints(n,s,l)})}qa.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","rules","modeling"];var Ka=Math.abs,Xa=Math.round,Ya=10;function Za(e){function t(e,t){if(r(e)){for(var n=e.length;n--;)if(Ka(e[n]-t)<=Ya)return e[n]}else{var o=t%(e=+e);if(o<Ya)return t-o;if(o>e-Ya)return t-o+e}return t}function n(e){if(e.width)return{x:Xa(e.width/2+e.x),y:Xa(e.height/2+e.y)}}e.on("connectionSegment.move.move",1500,function(e){var r,o,i=function(e){var t=e.snapPoints,r=e.connection,o=r.waypoints,i=e.segmentStart,a=e.segmentStartIndex,s=e.segmentEnd,c=e.segmentEndIndex,u=e.axis;if(t)return t;var l=[o[a-1],i,s,o[c+1]];return a<2&&l.unshift(n(r.source)),c>o.length-3&&l.unshift(n(r.target)),e.snapPoints=t={horizontal:[],vertical:[]},p(l,function(e){e&&(e=e.original||e,"y"===u&&t.horizontal.push(e.y),"x"===u&&t.vertical.push(e.x))}),t}(e.context),a=e.x,s=e.y;if(i){var c=a-(r=t(i.vertical,a)),u=s-(o=t(i.horizontal,s));S(e,{dx:e.dx-c,dy:e.dy-u,x:r,y:o})}}),e.on("bendpoint.move.move",1500,function(e){var r=e.context,o=function(e){var t=e.snapPoints,n=e.connection.waypoints,r=e.bendpointIndex;if(t)return t;var o=[n[r-1],n[r+1]];return e.snapPoints=t={horizontal:[],vertical:[]},p(o,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))}),t}(r),i=r.target,a=i&&n(i),s=e.x,c=e.y;if(o){var u=s-t(a?o.vertical.concat([a.x]):o.vertical,s),l=c-t(a?o.horizontal.concat([a.y]):o.horizontal,c);S(e,{dx:e.dx-u,dy:e.dy-l,x:e.x-u,y:e.y-l})}})}Za.$inject=["eventBus"];var Ja={__depends__:[yi,li],__init__:["bendpoints","bendpointSnapping"],bendpoints:["type",ka],bendpointMove:["type",Da],connectionSegmentMove:["type",qa],bendpointSnapping:["type",Za]};function Qa(e){return h(e.drgElements,es)}function es(e){var t=e.extensionElements,n=t&&t.values;return n&&u(n,function(e){return Nt(e,"biodi:Bounds")})}function ts(e,t,n){e.on("import.start",function(e){var r=e.definitions;Qa(r)||function(e){var r=0;p(e.drgElements,function(e){var o,i,a;Nt(e,"dmn:Decision")&&((i=e.extensionElements)||((i=e.extensionElements=t.createDi()).$parent=e),a=n._getDefaultSize(e),o=t.createDiBounds({x:150+30*r,y:150+30*r,width:a.width,height:a.height}),i.get("values").push(o),o.$parent=i,r++)})}(r)})}ts.$inject=["eventBus","drdFactory","elementFactory"];var ns={__init__:["diGenerator"],diGenerator:["type",ts]};function rs(){}rs.prototype.get=function(){return this._data},rs.prototype.set=function(e){this._data=e},rs.prototype.clear=function(){var e=this._data;return delete this._data,e},rs.prototype.isEmpty=function(){return!this._data};var os={clipboard:["type",rs]};function is(e,t){this._eventBus=e,this._canvas=t,this._init()}is.$inject=["eventBus","canvas"],is.prototype.getHoverContext=function(){var e=this._canvas.viewbox();return{element:this._hoverElement,point:{x:e.x+Math.round(this._mouseX/e.scale),y:e.y+Math.round(this._mouseY/e.scale)}}},is.prototype._init=function(){var e=this._eventBus,t=this._canvas.getContainer();this._setMousePosition=k(this._setMousePosition,this),t.addEventListener("mousemove",this._setMousePosition),e.on("diagram.destroy",function(){t.removeEventListener("mousemove",this._setMousePosition)},this),e.on("element.hover",this._setHoverElement,this)},is.prototype._setHoverElement=function(e){this._hoverElement=e.element},is.prototype._setMousePosition=function(e){this._mouseX=e.layerX,this._mouseY=e.layerY};var as={__init__:["mouseTracking"],mouseTracking:["type",is]};function ss(e,t,n,r,o,i){this._eventBus=e,this._modeling=t,this._elementFactory=n,this._rules=r,this._canvas=i,this._clipboard=o,this._descriptors=[],this.registerDescriptor(function(e,t){return t.priority=1,t.id=e.id,e.parent&&(t.parent=e.parent.id),e.labelTarget&&(t.priority=4,t.labelTarget=e.labelTarget.id),e.host&&(t.priority=2,t.host=e.host.id),"number"==typeof e.x&&(t.x=e.x,t.y=e.y),e.width&&(t.width=e.width,t.height=e.height),e.waypoints&&(t.priority=3,t.waypoints=[],p(e.waypoints,function(e){var n={x:e.x,y:e.y};e.original&&(n.original={x:e.original.x,y:e.original.y}),t.waypoints.push(n)})),e.source&&e.target&&(t.source=e.source.id,t.target=e.target.id),t})}ss.$inject=["eventBus","modeling","elementFactory","rules","clipboard","canvas"],ss.prototype.copy=function(e){var t,n,o=this._clipboard;if(r(e)||(e=e?[e]:[]),e.length)return t=this.createTree(e),n=this._bbox=Do(Kn(t.allShapes)),delete t.allShapes,p(t,function(e){p(e,function(t){var r,o;t.labelTarget?(o=u(e,b({id:t.labelTarget})),r=o.waypoints?Io(t,o.waypoints[0]):Io(t,o)):3===t.priority?(r=[],p(t.waypoints,function(e){var t=Io(e,n);r.push(t)})):r=Io(t,n),t.delta=r})}),this._eventBus.fire("elements.copy",{context:{tree:t}}),0===Object.keys(t).length?o.clear():o.set(t),this._eventBus.fire("elements.copied",{context:{tree:t}}),t},ss.prototype.paste=function(e){var t,n=this._clipboard,r=this._modeling,o=this._eventBus,i=this._rules,a=n.get(),s=e.element,c=e.point;n.isEmpty()||(t=f(a,function(e,t,n){var r=parseInt(n,10);return isNaN(r)?e:(e[r]=t,e)},{}),i.allowed("elements.paste",{tree:t,target:s})?r.pasteElements(t,s,c):o.fire("elements.paste.rejected",{context:{tree:t,position:c,target:s}}))},ss.prototype._computeDelta=function(e,t){var n=this._bbox,r={};return t.labelTarget?Io(t,t.labelTarget):(3===t.priority?(r=[],p(t.waypoints,function(e){var t=Io(e,n);r.push(t)})):r=Io(t,n),r)},ss.prototype.hasRelations=function(e,t){var n,r;return!(t.waypoints&&(n=u(e,b({id:t.source.id})),r=u(e,b({id:t.target.id})),!n||!r))&&!(t.labelTarget&&!u(e,b({id:t.labelTarget.id})))},ss.prototype.registerDescriptor=function(e){if("function"!=typeof e)throw new Error("the descriptor must be a function");if(-1!==this._descriptors.indexOf(e))throw new Error("this descriptor is already registered");this._descriptors.push(e)},ss.prototype._executeDescriptors=function(e){return e.descriptor||(e.descriptor={}),p(this._descriptors,function(t){e.descriptor=t(e.element,e.descriptor)}),e},ss.prototype.createTree=function(e){var t,n=this._rules,o=this,i={},a=[],s=function(e){var t={},n=[],r=[],o=[];return p(e,function(e){var r=e.parent;t[r.id]||(t[r.id]=[]),-1===n.indexOf(r.id)&&n.push(r.id),t[r.id].push(e)}),p(n,function(e){p(t[e],function(e){t[e.id]&&o.push(e.id)})}),p(n,function(e){-1===o.indexOf(e)&&(r=r.concat(t[e]))}),r}(e);function c(e){var t=function(e,t){t=w(t);var n=r(e)?-1:void 0;return p(e,function(e,r){if(t(e,r))return n=r,!1}),n}(a,b({element:e.element}));if(-1===t)return a.push(e);a[t].depth<e.depth&&(a.splice(t,1),a.push(e))}return i.allShapes=[],Hn(s,function(e,t,n){var r=e.children;if(!e.labelTarget)return e.label&&c({element:e.label,depth:n}),p([e.attachers,e.incoming,e.outgoing],function(e){e&&e.length&&p(e,function(e){e.label&&c({element:e.label,depth:n}),c({element:e,depth:n})})}),c({element:e,depth:n}),r||void 0}),a=g(a=v(a,function(e){return o._executeDescriptors(e)}),function(e){return e.descriptor.priority}),t=v(a,function(e){return e.element}),p(a,function(e){var r,a,s=e.depth;o.hasRelations(i.allShapes,e.element)&&(r=t,a=e.element,n.allowed("element.copy",{collection:r,element:a})&&(i.allShapes.push(e.element),i[s]||(i[s]=[]),i[s].push(e.descriptor)))}),i};var cs={__depends__:[os,li,as],__init__:["copyPaste"],copyPaste:["type",ss]};function us(e,t,n,o,i,a,s,c,u){this._actions={undo:function(){t.undo()},redo:function(){t.redo()},copy:function(){var e=o.get();a.copy(e)},paste:function(){var e=u.getHoverContext();a.paste(e)},stepZoom:function(e){i.stepZoom(e.value)},zoom:function(e){s.zoom(e.value)},removeSelection:function(){var e=o.get();if(e.length){var t,i=c.allowed("elements.delete",{elements:e});if(!1===i)return;(t=r(i)?i:e).length&&n.removeElements(t.slice())}},moveCanvas:function(e){var t=0,n=0,r=e.invertY,o=e.speed/Math.min(Math.sqrt(s.viewbox().scale),1);switch(e.direction){case"left":t=o;break;case"up":n=o;break;case"right":t=-o;break;case"down":n=-o}n&&r&&(n=-n),s.scroll({dx:t,dy:n})}}}function ls(e,t){return new Error(e+" "+t)}us.$inject=["eventBus","commandStack","modeling","selection","zoomScroll","copyPaste","canvas","rules","mouseTracking"],us.prototype.trigger=function(e,t){if(!this._actions[e])throw ls(e,"is not a registered action");return this._actions[e](t)},us.prototype.register=function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);p(e,function(e,t){n._registerAction(t,e)})},us.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw ls(e,"is already registered");this._actions[e]=t},us.prototype.unregister=function(e){if(!this.isRegistered(e))throw ls(e,"is not a registered action");this._actions[e]=void 0},us.prototype.length=function(){return Object.keys(this._actions).length},us.prototype.isRegistered=function(e){return!!this._actions[e]};var ps={__depends__:[po,cs,zo],__init__:["editorActions"],editorActions:["type",us]};function fs(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}fs.$inject=["eventBus","dragging"],fs.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},fs.prototype.isActive=function(e){return e&&this._active===e},fs.prototype.length=function(e){return this._tools.length},fs.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},fs.prototype.bindEvents=function(e,t){var n=this._eventBus,r=this._dragging,o=[];n.on(t.tool+".init",function(t){if(!t.context.reactivate&&this.isActive(e))return this.setActive(null),void r.cancel();this.setActive(e)},this),p(t,function(e){o.push(e+".ended"),o.push(e+".canceled")}),n.on(o,250,function(e){var t=e.originalEvent;!this._active||t&&"tools"===t.target.parentNode.getAttribute("data-group")||this.setActive(null)},this)};var ds={__depends__:[yi],__init__:["toolManager"],toolManager:["type",fs]};function hs(e,t,n,r,o,i){this._selection=o,this._dragging=n;var a=this,s=function(e){var n,r=t.getDefaultLayer();fn(n=e.frame=En("rect"),{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),cn(r,n)},c=function(e){var t=e.frame,n=e.bbox;fn(t,{x:n.x,y:n.y,width:n.width,height:n.height})},u=function(e){e.frame&&bn(e.frame)};i.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("lasso.selection.ended",function(){a.activateLasso(t.originalEvent,!0)})}),e.on("lasso.end",function(e){var t=vs(e),n=r.filter(function(e){return e});a.select(n,t)}),e.on("lasso.start",function(e){var t=e.context;t.bbox=vs(e),s(t)}),e.on("lasso.move",function(e){var t=e.context;t.bbox=vs(e),c(t)}),e.on("lasso.cleanup",function(e){var t=e.context;u(t)}),e.on("element.mousedown",1500,function(e){if(function(e){var t=Kr(e)||e;return Zr(e)&&t.shiftKey}(e))return a.activateLasso(e.originalEvent),!0})}function vs(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y};return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?{x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?{x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?{x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}hs.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],hs.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:"crosshair",data:{context:{}}})},hs.prototype.activateSelection=function(e){this._dragging.init(e,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},hs.prototype.select=function(e,t){var n=function(e,t){var n={};return p(e,function(e){var r=e;r.waypoints&&(r=Kn(r)),!i(t.y)&&r.x>t.x&&(n[e.id]=e),!i(t.x)&&r.y>t.y&&(n[e.id]=e),r.x>t.x&&r.y>t.y&&(i(t.width)&&i(t.height)&&r.width+r.x<t.width+t.x&&r.height+r.y<t.height+t.y?n[e.id]=e:i(t.width)&&i(t.height)||(n[e.id]=e))}),n}(e,t);this._selection.select(v(n,function(e){return e}))},hs.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},hs.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};var ys={__depends__:[ds],__init__:["lassoTool"],lassoTool:["type",hs]};function ms(e,t,n,r,o,i){e.invoke(us,this),this.register({selectElements:function(){var e=t.getRootElement(),o=n.filter(function(t){return t!==e});return r.select(o),o},lassoTool:function(){o.toggle()},directEditing:function(){var e=r.get();e.length&&i.activate(e[0])}})}Gt(ms,us),ms.$inject=["injector","canvas","elementRegistry","selection","lassoTool","directEditing"];var gs={__depends__:[ps,ys],editorActions:["type",ms]};function bs(e,t){this._providers=[],this._eventBus=e,this._overlays=t,this._current=null,this._init()}bs.$inject=["eventBus","overlays"],bs.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(e){var n=e.newSelection;1===n.length?t.open(n[0]):t.close()}),e.on("elements.delete",function(e){p(e.elements,function(e){t.isOpen(e)&&t.close()})}),e.on("element.changed",function(e){var n=e.element,r=t._current;r&&r.element===n&&t.open(n,!0)})},bs.prototype.registerProvider=function(e){this._providers.push(e)},bs.prototype.getEntries=function(e){var t={};return p(this._providers,function(n){p(n.getContextPadEntries(e),function(e,n){t[n]=e})}),t},bs.prototype.trigger=function(e,t,n){var r,o,i=this._current.element,s=this._current.entries,c=t.delegateTarget||t.target;if(!c)return t.preventDefault();if(r=s[Xe(c,"data-action")].action,o=t.originalEvent||t,a(r)){if("click"===e)return r(o,i,n)}else if(r[e])return r[e](o,i,n);t.preventDefault()},bs.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},bs.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),o=n.html;p(t,function(e,t){var n,i,a,s,c=e.group||"default",u=ht(e.html||'<div class="entry" draggable="true"></div>');Xe(u,"data-action",t),(n=_t("[data-group="+c+"]",o))||(n=ht('<div class="group" data-group="'+c+'"></div>'),o.appendChild(n)),n.appendChild(u),e.className&&(i=u,a=e.className,s=et(i),(r(a)?a:a.split(/\s+/g)).forEach(function(e){s.add(e)})),e.title&&Xe(u,"title",e.title),e.imageUrl&&u.appendChild(ht('<img src="'+e.imageUrl+'">'))}),et(o).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})},bs.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,r=ht('<div class="djs-context-pad"></div>');dt.bind(r,".entry","click",function(e){t.trigger("click",e)}),dt.bind(r,".entry","dragstart",function(e){t.trigger("dragstart",e)}),pt.bind(r,"mousedown",function(e){e.stopPropagation()}),this._overlayId=n.add(e,"context-pad",{position:{right:-9,top:-6},html:r});var o=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:o}),o},bs.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},bs.prototype.isOpen=function(e){return!(!this._current||e&&this._current.element!==e)};var _s={__depends__:[no,_o],contextPad:["type",bs]},ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xs="connect-ok",Cs="connect-not-ok";function Es(e,t,n,r,o,i){function a(e,t){return r.allowed("connection.create",{source:e,target:t})}e.on("connect.move",function(e){var t,n=e.context,r=n.source,o=n.target;fn(n.visual,{points:[(t=function(e,t,n,r){var o=i.getShapePath(n),a=r&&i.getShapePath(r),s=i.getConnectionPath({waypoints:[e,t]});return[e=$a(o,s,!0)||e,t=r&&$a(a,s,!1)||t]}(n.sourcePosition,{x:e.x,y:e.y},r,o))[0].x,t[0].y,t[1].x,t[1].y]})}),e.on("connect.hover",function(e){var t,n=e.context,r=n.source,i=e.hover;null!==(t=n.canExecute=a(r,i))&&(n.target=i,o.addMarker(i,t?xs:Cs))}),e.on(["connect.out","connect.cleanup"],function(e){var t=e.context;t.target&&o.removeMarker(t.target,t.canExecute?xs:Cs),t.target=null,t.canExecute=!1}),e.on("connect.cleanup",function(e){var t=e.context;t.visual&&bn(t.visual)}),e.on("connect.start",function(e){var t,n=e.context;fn(t=En("polyline"),{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),cn(o.getDefaultLayer(),t),n.visual=t}),e.on("connect.end",function(e){var t=e.context,r=t.source,o=t.sourcePosition,i=t.target,s={x:e.x,y:e.y},c=t.canExecute||a(r,i);if(!c)return!1;var u=null,l={connectionStart:o,connectionEnd:s};"object"===(void 0===c?"undefined":ws(c))&&(u=c),n.connect(r,i,u,l)}),this.start=function(e,n,r,o){"object"!==(void 0===r?"undefined":ws(r))&&(o=r,r=Va(n)),t.init(e,"connect",{autoActivate:o,data:{shape:n,context:{source:n,sourcePosition:r}}})}}Es.$inject=["eventBus","dragging","modeling","rules","canvas","graphicsFactory"];var Os={__depends__:[po,li,yi],connect:["type",Es]},ks=750,js="drop-ok",Ss="drop-not-ok",Ps="attach-ok",Ts="new-parent";function Rs(e,t,n,r,o,i,a){function s(e,t){[Ps,js,Ss,Ts].forEach(function(n){n===t?o.addMarker(e,n):o.removeMarker(e,n)})}e.on("create.move",function(e){var t,r=e.context,o=e.hover,i=r.shape,a=r.source,c={x:e.x,y:e.y};t=r.canExecute=o&&function(e,t,r,o){if(!t)return!1;var i,a,s,c={source:r,shape:e,target:t,position:o};return(a=n.allowed("shape.attach",c))||(i=n.allowed("shape.create",c)),(i||a)&&(s=r&&n.allowed("connection.create",{source:r,target:e,hints:{targetParent:t,targetAttach:a}})),!(!i&&!a)&&{attach:a,connect:s}}(i,o,a,c),o&&null!==t&&(r.target=o,t&&t.attach?s(o,Ps):s(o,t?Ts:Ss))}),e.on("create.move",ks,function(e){var t=e.context,n=t.shape,r=t.visual;r||(r=t.visual=function(e){var t,n,r;fn(t=En("g"),i.cls("djs-drag-group",["no-events"])),cn(o.getDefaultLayer(),t),mn(n=En("g")).add("djs-dragger"),cn(t,n),xr(n,e.width/-2,e.height/-2);var s=En("g");return mn(s).add("djs-visual"),cn(n,s),r=s,a.drawShape(r,e),t}(n)),xr(r,e.x,e.y)}),e.on(["create.end","create.out","create.cleanup"],function(e){var t=e.context.target;t&&s(t,null)}),e.on("create.end",function(e){var t=e.context,n=t.source,o=t.shape,i=t.target,a=t.canExecute,s=a&&a.attach,c=a&&a.connect,u={x:e.x,y:e.y};if(!a)return!1;o=c?r.appendShape(n,o,u,i,{attach:s,connection:!0===c?{}:c}):r.createShape(o,u,i,{attach:s}),t.shape=o}),e.on("create.cleanup",function(e){var t=e.context;t.visual&&bn(t.visual)}),this.start=function(e,n,r){t.init(e,"create",{cursor:"grabbing",autoActivate:!0,data:{shape:n,context:{shape:n,source:r}}})}}Rs.$inject=["eventBus","dragging","rules","modeling","canvas","styles","graphicsFactory"];var As={__depends__:[yi,po,li],create:["type",Rs]};function Ms(e,t){this._eventBus=e,this._canvas=t,this._providers={}}Ms.$inject=["eventBus","canvas"],Ms.prototype.registerProvider=function(e,t){this._providers[e]=t},Ms.prototype.create=function(e,t){var n=this._providers[e];if(!n)throw new Error("Provider is not registered: "+e);if(!t)throw new Error("Element is missing");var r=this._current={provider:n,className:e,element:t};return n.getHeaderEntries&&(r.headerEntries=n.getHeaderEntries(t)),r.entries=n.getEntries(t),this},Ms.prototype.isEmpty=function(){var e=this._current;return 0===e.entries.length&&e.headerEntries&&0===e.headerEntries.length},Ms.prototype.open=function(e){if(!e)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var t=this._current,n=this._canvas.getContainer();t.position=e,t.container=this._createContainer();var r=t.headerEntries||[],o=t.entries||[];return r.length&&t.container.appendChild(this._createEntries(t.headerEntries,"djs-popup-header")),o.length&&t.container.appendChild(this._createEntries(t.entries,"djs-popup-body")),this._attachContainer(t.container,n,e.cursor),this},Ms.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindHandlers(),xt(this._current.container),this._current.container=null)},Ms.prototype.isOpen=function(){return!!this._current.container},Ms.prototype.trigger=function(e){e.preventDefault();var t=Xe(e.delegateTarget||e.target,"data-id"),n=this._getEntry(t);if(n.action)return n.action.call(null,e,n)},Ms.prototype._getEntry=function(e){var t=b({id:e}),n=u(this._current.entries,t)||u(this._current.headerEntries,t);if(!n)throw new Error("entry not found");return n},Ms.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)},Ms.prototype._createContainer=function(){var e=ht('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return S(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),et(e).add(n),e},Ms.prototype._attachContainer=function(e,t,n){var r=this;dt.bind(e,".entry","click",function(e){r.trigger(e)});var o=this._canvas.zoom();e.style.transformOrigin="top left",e.style.transform="scale("+o+")",t.appendChild(e),n&&this._assureIsInbounds(e,n),this._bindHandlers()},Ms.prototype._assureIsInbounds=function(e,t){var n,r,o=this._canvas._container.getBoundingClientRect(),i=e.offsetLeft,a=e.offsetTop,s=e.scrollWidth,c=e.scrollHeight,u={},l=t.x-o.left,p=t.y-o.top;i+s>o.width&&(u.x=!0),a+c>o.height&&(u.y=!0),u.x&&u.y?(n=l-s+"px",r=p-c+"px"):u.x?(n=l-s+"px",r=p+"px"):u.y&&p<c?(n=l+"px",r="10px"):u.y&&(n=l+"px",r=p-c+"px"),S(e.style,{left:n,top:r},{visibility:"visible","z-index":1e3})},Ms.prototype._createEntries=function(e,t){var n=ht("<div>"),r=this;return et(n).add(t),p(e,function(e){var t=r._createEntry(e,n);n.appendChild(t)}),n},Ms.prototype._createEntry=function(e){if(!e.id)throw new Error("every entry must have the id property set");var t=ht("<div>"),n=et(t);if(n.add("entry"),e.className&&n.add(e.className),Xe(t,"data-id",e.id),e.label){var r=ht("<span>");r.textContent=e.label,t.appendChild(r)}return e.imageUrl&&t.appendChild(ht('<img src="'+e.imageUrl+'" />')),!0===e.active&&n.add("active"),!0===e.disabled&&n.add("disabled"),e.title&&(t.title=e.title),t},Ms.prototype._bindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.once("contextPad.close",n),e.once("canvas.viewbox.changing",n),e.once("commandStack.changed",n)},Ms.prototype._unbindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.off("contextPad.close",n),e.off("canvas.viewbox.changed",n),e.off("commandStack.changed",n)};var Bs={__init__:["popupMenu"],popupMenu:["type",Ms]};function Ds(e){this._modeling=e}Ds.$inject=["modeling"],Ds.prototype.replaceElement=function(e,t,n){var r=this._modeling,o=null;return e.waypoints||(t.x=Math.ceil(e.x+(t.width||e.width)/2),t.y=Math.ceil(e.y+(t.height||e.height)/2),o=r.replaceShape(e,t,n)),o};var Is={__init__:["replace"],replace:["type",Ds]};function Ns(e,t,n,r){this.replaceElement=function(n,r,o){o=o||{};var i=r.type,a=n.businessObject,s=e.create(i),c={type:i,businessObject:s};if(c.width=n.width,c.height=n.height,s.name=a.name,r.table){var u=e.create("dmn:DecisionTable");s.decisionTable=u,u.$parent=s;var l=e.create("dmn:OutputClause");l.typeRef="string",l.$parent=u,u.output=[l];var p=e.create("dmn:InputClause");p.$parent=u;var f=e.create("dmn:LiteralExpression",{typeRef:"string"});p.inputExpression=f,f.$parent=p,u.input=[p]}return r.expression&&(s.literalExpression=e.create("dmn:LiteralExpression"),s.variable=e.create("dmn:InformationItem")),t.replaceElement(n,c,o)}}Ns.$inject=["drdFactory","replace","selection","modeling"];var Vs={__depends__:[Is,po],drdReplace:["type",Ns]},Ls=[{label:"Empty",actionName:"replace-with-empty-decision",className:"dmn-icon-clear",target:{type:"dmn:Decision",table:!1,expression:!1}},{label:"Decision Table",actionName:"replace-with-decision-table",className:"dmn-icon-decision-table",target:{type:"dmn:Decision",table:!0,expression:!1}},{label:"Literal Expression",actionName:"replace-with-literal-expression",className:"dmn-icon-literal-expression",target:{type:"dmn:Decision",table:!1,expression:!0}}];function $s(e,t,n,r,o,i){this._popupMenu=e,this._modeling=t,this._moddle=n,this._drdReplace=r,this._rules=o,this._translate=i,this.register()}$s.$inject=["popupMenu","modeling","moddle","drdReplace","rules","translate"],$s.prototype.register=function(){this._popupMenu.registerProvider("dmn-replace",this)},$s.prototype.getEntries=function(e){var t=e.businessObject;if(!this._rules.allowed("shape.replace",{element:e}))return[];if(Nt(t,"dmn:Decision")){var n=l(Ls,function(e){var n="replace-with-empty-decision"===e.actionName&&(t.decisionTable||t.literalExpression),r="replace-with-decision-table"===e.actionName&&!t.decisionTable,o="replace-with-literal-expression"===e.actionName&&!t.literalExpression;return n||r||o});return this._createEntries(e,n)}return[]},$s.prototype._createEntries=function(e,t){var n=[],r=this;return p(t,function(t){var o=r._createMenuEntry(t,e);n.push(o)}),n},$s.prototype._createMenuEntry=function(e,t,n){var r=this._drdReplace.replaceElement,o=this._translate;return n=n||function(){return r(t,e.target)},{label:o(e.label),className:e.className,id:e.actionName,action:n}},$s.prototype.getHeaderEntries=function(e){return[]};var Fs={__depends__:[Hr,Bs,Vs],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",$s]};function Us(e,t,n,r,o,i,a,s,c,u){t.registerProvider(this),this._contextPad=t,this._modeling=n,this._elementFactory=r,this._connect=o,this._create=i,this._rules=a,this._popupMenu=s,this._canvas=c,this._translate=u,e.on("create.end",250,function(e){var n=e.context.shape;if(Jr(e)){var r=t.getEntries(n);r.replace&&r.replace.action.click(e,n)}})}Us.$inject=["eventBus","contextPad","modeling","elementFactory","connect","create","rules","popupMenu","canvas","translate"],Us.prototype.getContextPadEntries=function(e){var t=this._modeling,n=this._elementFactory,o=this._connect,i=this._create,a=this._popupMenu,s=this._canvas,c=this._contextPad,u=this._rules,l=this._translate,p={};if("label"===e.type)return p;var f,d=e.businessObject;function h(e,t,n){o.start(e,t,n)}function v(e,t,r,o){function a(t,r){var a=n.createShape(S({type:e},o));i.start(t,a,r)}return"string"!=typeof r&&(o=r,r=l("Append {type}",{type:e.replace(/^dmn:/,"")})),{group:"model",className:t,title:r,action:{dragstart:a,click:a}}}Ft(d,["dmn:InputData","dmn:BusinessKnowledgeModel","dmn:KnowledgeSource","dmn:Decision"])&&S(p,{"append.decision":v("dmn:Decision","dmn-icon-decision")}),Ft(d,["dmn:InputData","dmn:Decision","dmn:KnowledgeSource"])&&S(p,{"append.knowledge-source":v("dmn:KnowledgeSource","dmn-icon-knowledge-source")}),Ft(d,["dmn:BusinessKnowledgeModel","dmn:KnowledgeSource"])&&S(p,{"append.business-knowledge-model":v("dmn:BusinessKnowledgeModel","dmn-icon-business-knowledge")}),Ft(d,["dmn:Decision"])&&S(p,{"append.input-data":v("dmn:InputData","dmn-icon-input-data")}),Nt(d,"dmn:DRGElement")&&S(p,{"append.text-annotation":v("dmn:TextAnnotation","dmn-icon-text-annotation"),connect:{group:"connect",className:"dmn-icon-connection-multi",title:l("Connect using Information/Knowledge/Authority Requirement or Association"),action:{click:h,dragstart:h}}}),a._providers["dmn-replace"]&&(f=a.create("dmn-replace",e)),f&&!f.isEmpty()&&S(p,{replace:{group:"edit",className:"dmn-icon-screw-wrench",title:l("Change type"),action:{click:function(e,t){f.open(S(function(e){var t=s.getContainer(),n=c.getPad(e).html,r=t.getBoundingClientRect(),o=n.getBoundingClientRect(),i=o.top-r.top;return{x:o.left-r.left,y:i+o.height+5}}(t),{cursor:{x:e.x,y:e.y}}),t)}}}});var y=u.allowed("elements.delete",{elements:[e]});return r(y)&&(y=y[0]===e),y&&S(p,{delete:{group:"edit",className:"dmn-icon-trash",title:l("Remove"),action:{click:function(n){t.removeElements([e])}}}}),p};var zs={__depends__:[Hr,_s,po,Os,As,Fs],__init__:["contextPadProvider"],contextPadProvider:["type",Us]};function Ws(e,t,n){var r=this;this._config=e||{},this._eventBus=t,this._editorActions=n,this._listeners=[],this._keyHandler=function(e){var t,n,o=e.target,i=r._listeners,a=e.keyCode||e.charCode||-1;if(!o||!bt(o,"input, textarea")&&"true"!==o.contentEditable)for(t=0;n=i[t];t++)n(a,e)&&(e.preventDefault(),e.stopPropagation())},t.on("diagram.destroy",function(){r._fire("destroy"),r.unbind(),r._listeners=null}),t.on("diagram.init",function(){r._fire("init")}),t.on("attach",function(){e&&e.bindTo&&r.bind(e.bindTo)}),t.on("detach",function(){r.unbind()}),this._init()}function Gs(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function Hs(e){return e.shiftKey}Ws.$inject=["config.keyboard","eventBus","editorActions"],Ws.prototype.bind=function(e){this.unbind(),this._node=e,pt.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")},Ws.prototype.getBinding=function(){return this._node},Ws.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),pt.unbind(e,"keydown",this._keyHandler,!0)),this._node=null},Ws.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node,listeners:this._listeners})},Ws.prototype._init=function(){var e=this._listeners,t=this._editorActions,n=this._config;e.push(function(e,n){if(Gs(n)&&!Hs(n)&&90===e)return t.trigger("undo"),!0}),e.push(function(e,n){if(Gs(n)&&(89===e||90===e&&Hs(n)))return t.trigger("redo"),!0}),e.push(function(e,n){if(Gs(n)&&67===e)return t.trigger("copy"),!0}),e.push(function(e,n){if(Gs(n)&&86===e)return t.trigger("paste"),!0}),e.push(function(e,n){if(46===e)return t.trigger("removeSelection"),!0}),e.push(function(e,n){if((107===e||187===e||171===e||61===e)&&Gs(n))return t.trigger("stepZoom",{value:1}),!0}),e.push(function(e,n){if((109===e||189===e||173===e)&&Gs(n))return t.trigger("stepZoom",{value:-1}),!0}),e.push(function(e,n){if((96===e||48===e)&&Gs(n))return t.trigger("zoom",{value:1}),!0}),e.push(function(e,r){if([37,38,39,40].indexOf(e)>=0){var o={invertY:n.invertY,speed:n.speed||50};switch(e){case 37:o.direction="left";break;case 38:o.direction="up";break;case 39:o.direction="right";break;case 40:o.direction="down"}return t.trigger("moveCanvas",o),!0}})},Ws.prototype.addListener=function(e){this._listeners.push(e)},Ws.prototype.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},Ws.prototype.isCmd=Gs,Ws.prototype.isShift=Hs;var qs={__init__:["keyboard"],keyboard:["type",Ws]};function Ks(e,t){e.addListener(function(n,r){return 65===n&&e.isCmd(r)?(t.trigger("selectElements"),!0):e.hasModifier(r)?void 0:76===n?(t.trigger("lassoTool"),!0):69===n?(t.trigger("directEditing"),!0):void 0})}Ks.$inject=["keyboard","editorActions"];var Xs={__depends__:[qs],__init__:["drdKeyBindings"],drdKeyBindings:["type",Ks]};function Ys(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}Ys.$inject=["eventBus","injector"],Ys.prototype.execute=function(e,t){if(!e)throw new Error("command required");var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)},Ys.prototype.canExecute=function(e,t){var n={command:e,context:t},r=this._getHandler(e),o=this._fire(e,"canExecute",n);if(void 0===o){if(!r)return!1;r.canExecute&&(o=r.canExecute(t))}return o},Ys.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed")},Ys.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._pushAction(t);t&&(this._internalUndo(t),(e=this._getUndoAction())&&e.id===t.id);)t=e;this._popAction()}},Ys.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._pushAction(t);t&&(this._internalExecute(t,!0),(e=this._getRedoAction())&&e.id===t.id);)t=e;this._popAction()}},Ys.prototype.register=function(e,t){this._setHandler(e,t)},Ys.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)},Ys.prototype.canUndo=function(){return!!this._getUndoAction()},Ys.prototype.canRedo=function(){return!!this._getRedoAction()},Ys.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},Ys.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},Ys.prototype._internalUndo=function(e){var t=this,n=e.command,r=e.context,o=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),o.revert&&t._markDirty(o.revert(r)),t._revertedAction(e),t._fire(n,"reverted",e)})},Ys.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var r,o,i,a=t?[e+"."+t,t]:[e];for(n=this._eventBus.createEvent(n),r=0;(o=a[r])&&(i=this._eventBus.fire("commandStack."+o,n),!n.cancelBubble);r++);return i},Ys.prototype._createId=function(){return this._uid++},Ys.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},Ys.prototype._internalExecute=function(e,t){var n=this,r=e.command,o=e.context,i=this._getHandler(r);if(!i)throw new Error("no command handler registered for <"+r+">");this._pushAction(e),t||(this._fire(r,"preExecute",e),i.preExecute&&i.preExecute(o),this._fire(r,"preExecuted",e)),this._atomicDo(function(){n._fire(r,"execute",e),i.execute&&n._markDirty(i.execute(o)),n._executedAction(e,t),n._fire(r,"executed",e)}),t||(this._fire(r,"postExecute",e),i.postExecute&&i.postExecute(o),this._fire(r,"postExecuted",e)),this._popAction(e)},Ys.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,r=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=r&&r.id||this._createId()),n.push(e)},Ys.prototype._popAction=function(){var e=this._currentExecution,t=e.actions,n=e.dirty;t.pop(),t.length||(this._eventBus.fire("elements.changed",{elements:function(e){e=_(e);for(var t={},n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return p(r,function(n){return m(n,e,t)}),v(t,function(e,t){return e[0]})}("id",n)}),n.length=0,this._fire("changed"))},Ys.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=r(e)?e:[e],t.dirty=t.dirty.concat(e))},Ys.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},Ys.prototype._revertedAction=function(e){this._stackIdx--},Ys.prototype._getHandler=function(e){return this._handlerMap[e]},Ys.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var Zs={commandStack:["type",Ys]};function Js(e,t,n,r){e.on("element.changed",function(r){var o=r.element;(o.parent||o===t.getRootElement())&&(r.gfx=n.getGraphics(o)),r.gfx&&e.fire(Xn(o)+".changed",r)}),e.on("elements.changed",function(t){var n=t.elements;n.forEach(function(t){e.fire("element.changed",{element:t})}),r.updateContainments(n)}),e.on("shape.changed",function(e){r.update("shape",e.element,e.gfx)}),e.on("connection.changed",function(e){r.update("connection",e.element,e.gfx)})}Js.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var Qs={__init__:["changeSupport"],changeSupport:["type",Js]},ec=Math.min,tc=Math.max;function nc(e){e.preventDefault()}function rc(e){e.stopPropagation()}function oc(e){this.container=e.container,this.parent=ht('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=_t("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=k(this.autoResize,this),this.handlePaste=k(this.handlePaste,this)}function ic(e,t){this._eventBus=e,this._providers=[],this._textbox=new oc({container:t.getContainer(),keyHandler:k(this._handleKey,this),resizeHandler:k(this._handleResize,this)})}oc.prototype.create=function(e,t,n,r){var o=this.parent,i=this.content,a=this.container;r=this.options=r||{};var s=P(t=this.style=t||{},["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);S(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=P(t,["fontSize","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return S(i.style,{boxSizing:"border-box",width:"100%",outline:"none"},c),r.centerVertically&&S(i.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),i.innerText=n,pt.bind(i,"keydown",this.keyHandler),pt.bind(i,"mousedown",rc),pt.bind(i,"paste",this.handlePaste),r.autoResize&&pt.bind(i,"input",this.autoResize),r.resizable&&this.resizable(t),a.appendChild(o),this.setSelection(i.lastChild,i.lastChild&&i.lastChild.length),o},oc.prototype.handlePaste=function(e){var t,n,r=this,o=this.options,i=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),!document.execCommand("insertHTML",!1,t)){var a,s,c=this.getSelection(),u=c.startContainer,l=c.endContainer,p=c.startOffset,f=c.endOffset,d=c.commonAncestorContainer,h=(n=d.childNodes,[].slice.call(n));if(d.nodeType===Node.TEXT_NODE){var v=u.textContent;u.textContent=v.substring(0,p)+t+v.substring(f),a=u,s=p+t.length}else if(u===this.content&&l===this.content){var y=document.createTextNode(t);this.content.insertBefore(y,h[p]),a=y,s=y.textContent.length}else{var m=h.indexOf(u),g=h.indexOf(l);h.forEach(function(e,n){n===m?e.textContent=u.textContent.substring(0,p)+t+l.textContent.substring(f):n>m&&n<=g&&xt(e)}),a=u,s=p+t.length}a&&void 0!==s&&setTimeout(function(){r.setSelection(a,s)})}if(o.autoResize){var b=this.autoResize(i);b&&this.resizeHandler(b)}},oc.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var r=e.getBoundingClientRect(),o=t.scrollHeight;e.style.height=o+"px",this.resizeHandler({width:r.width,height:r.height,dx:0,dy:o-r.height})}},oc.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,r=parseInt(this.style.minWidth)||0,o=parseInt(this.style.minHeight)||0,i=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){var s,c,u,l;n=this.resizeHandle=ht('<div class="djs-direct-editing-resize-handle"></div>');var p=function(n){nc(n),rc(n);var p=ec(tc(u+n.clientX-s,r),i),f=ec(tc(l+n.clientY-c,o),a);t.style.width=p+"px",t.style.height=f+"px",e.resizeHandler({width:u,height:l,dx:n.clientX-s,dy:n.clientY-c})},f=function e(t){nc(t),rc(t),pt.unbind(document,"mousemove",p,!1),pt.unbind(document,"mouseup",e,!1)};pt.bind(n,"mousedown",function(e){nc(e),rc(e),s=e.clientX,c=e.clientY;var n=t.getBoundingClientRect();u=n.width,l=n.height,pt.bind(document,"mousemove",p),pt.bind(document,"mouseup",f)})}S(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)},oc.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),pt.unbind(t,"keydown",this.keyHandler),pt.unbind(t,"mousedown",rc),pt.unbind(t,"input",this.autoResize),pt.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),xt(n)),xt(e)},oc.prototype.getValue=function(){return this.content.innerText},oc.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},oc.prototype.setSelection=function(e,t){var n=document.createRange();null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var r=window.getSelection();r.removeAllRanges(),r.addRange(n)},ic.$inject=["eventBus","canvas"],ic.prototype.registerProvider=function(e){this._providers.push(e)},ic.prototype.isActive=function(){return!!this._active},ic.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},ic.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},ic.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},ic.prototype.complete=function(){var e=this._active;if(e){var t=this.getValue(),n=this.$textbox.getBoundingClientRect();(t!==e.context.text||this.resizable)&&e.provider.update(e.element,t,e.context.text,{x:n.top,y:n.left,width:n.width,height:n.height}),this._fire("complete"),this.close()}},ic.prototype.getValue=function(){return this._textbox.getValue()},ic.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},ic.prototype._handleResize=function(e){this._fire("resize",e)},ic.prototype.activate=function(e){var t;this.isActive()&&this.cancel();var n=u(this._providers,function(n){return(t=n.activate(e))?n:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var ac={__depends__:[no],__init__:["directEditing"],directEditing:["type",ic]};function sc(e){return Nt(e,"dmn:Decision")||Nt(e,"dmn:BusinessKnowledgeModel")||Nt(e,"dmn:InputData")||Nt(e,"dmn:KnowledgeSource")?"name":Nt(e,"dmn:TextAnnotation")?"text":void 0}function cc(e){var t=e.businessObject,n=sc(t);if(n)return t[n]||""}function uc(){function e(e,t){var n=e.label||e,r=e.labelTarget||e;return function(e,t,n){var r=e.businessObject,o=sc(r);o&&(r[o]=t),n&&(e.hidden=!t)}(n,t,r!==n),[n,r]}this.execute=function(t){return t.oldLabel=cc(t.element),e(t.element,t.newLabel)},this.revert=function(t){return e(t.element,t.oldLabel)}}function lc(e,t,n,r){this._canvas=t,this._commandStack=r,n.registerProvider(this),r.registerHandler("element.updateLabel",uc),e.on("element.dblclick",function(e){n.activate(e.element)}),e.on(["element.mousedown","drag.init","canvas.viewbox.changed"],function(e){n.complete()}),e.on(["commandStack.changed"],function(){n.cancel()}),e.on("create.end",500,function(e){var t=e.shape;(Nt(t,"dmn:Decision")||Nt(t,"dmn:InputData")||Nt(t,"dmn:BusinessKnowledgeModel")||Nt(t,"dmn:KnowledgeSource"))&&n.activate(t)})}lc.$inject=["eventBus","canvas","directEditing","commandStack"],lc.prototype.activate=function(e){var t=cc(e);if(void 0!==t){var n=this.getEditingBBox(e);return n.text=t,n}},lc.prototype.getEditingBBox=function(e){var t,n=this._canvas,r=e.label||e,o=n.getAbsoluteBBox(r),i={x:o.x,y:o.y},a={};return(t=n.zoom())>1?(i.width=o.width,i.height=o.height):(i.width=o.width/t,i.height=o.height/t),t<1&&(i.x=o.x-(i.width/2-o.width/2),i.y=o.y-(i.height/2-o.height/2)),Nt(e,"dmn:TextAnnotation")&&(i.minWidth=100,i.height=e.height,a.textAlign="left"),{bounds:i,style:a}},lc.prototype.update=function(e,t){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t})};var pc={__depends__:[Zs,Qs,ac],__init__:["labelEditingProvider"],labelEditingProvider:["type",lc]};function fc(e){this._eventBus=e}fc.$inject=["eventBus"],fc.prototype.on=function(e,t,n,s,c,u){if((a(t)||i(t))&&(u=c,c=s,s=n,n=t,t=null),a(n)&&(u=c,c=s,s=n,n=1e3),o(c)&&(u=c,c=!1),!a(s))throw new Error("handlerFn must be a function");r(e)||(e=[e]);var l=this._eventBus;p(e,function(e){var r=["commandStack",e,t].filter(function(e){return e}).join(".");l.on(r,n,c?function(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}(s,u):s,u)})};function dc(e,t,n){fc.call(this,e),this.preExecute("connection.create",function(e){var n,r,o,i,a,s=e.connection,c=s.businessObject,u=e.source,l=e.target;"dmn:Association"===s.type?(n=t.create("dmn:DMNElementReference",{href:"#"+u.id}),r=t.create("dmn:DMNElementReference",{href:"#"+l.id}),c.sourceRef=n,c.targetRef=r,c.extensionElements=t.createDi(),a=t.createDiEdge(u,[Va(u),Va(l)]),c.extensionElements.values.push(a)):(Nt(u,"dmn:Decision")&&Nt(l,"dmn:InputData")&&(e.target=u,e.source=u=l),o=function(e){switch(e.type){case"dmn:InputData":return"Input";case"dmn:Decision":return"Decision";case"dmn:KnowledgeSource":return"Authority";case"dmn:BusinessKnowledgeModel":return"Knowledge"}}(u),i=t.create("dmn:DMNElementReference",{href:"#"+u.id}),c["required"+o]=i,a=t.createDiEdge(u,[Va(u),Va(e.target)]),e.di=a)},!0)}function hc(e,t,n){fc.call(this,e),this.postExecuted("connection.reconnectStart",function(e){var t=e.context.connection.target.businessObject.extensionElements.values,n=l(t,function(t){return"biodi:Edge"===t.$type&&t.source===e.context.oldSource.id})[0];n&&t.splice(t.indexOf(n),1)}),this.postExecuted(["connection.reconnectStart","connection.reconnectEnd"],function(e){!function(e){var r,o=e.source,i=e.target;e.parent&&((r=n.canConnect(o,i)||{type:"dmn:Association"}).waypoints=e.waypoints.slice(),t.removeConnection(e),t.connect(o,i,r))}(e.context.connection)})}function vc(e,t){fc.call(this,e),this._modeling=t,this.postExecuted(["shape.replace"],1500,function(e){var n=e.context,r=n.oldShape,o=n.newShape,i=o.id;t.unclaimId(r.businessObject.id,r.businessObject),t.updateProperties(o,{id:r.id}),p(o.outgoing,function(e){var t,n,o=e.businessObject;o.$instanceOf("dmn:Association")?(o.sourceRef.href="#"+r.id,t=o.extensionElements):(o.requiredDecision.href="#"+r.id,t=o.$parent.extensionElements),(n=l(t.values,function(e){return"biodi:Edge"===e.$type&&e.source===i})[0])&&(n.source=r.id)})})}p(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(e){fc.prototype[e]=function(t,n,r,o,s){(a(t)||i(t))&&(s=o,o=r,r=n,n=t,t=null),this.on(t,e,n,r,o,s)}}),dc.$inject=["eventBus","drdFactory","drdRules"],Gt(dc,fc),Gt(hc,fc),hc.$inject=["eventBus","modeling","drdRules"],Gt(vc,fc),vc.$inject=["eventBus","modeling"];var yc={__init__:["createConnectionBehavior","replaceConnectionBehavior","replaceElementBehavior"],createConnectionBehavior:["type",dc],replaceConnectionBehavior:["type",hc],replaceElementBehavior:["type",vc]};function mc(e){fc.call(this,e),this.init()}function gc(e){mc.call(this,e)}function bc(e,t){if(Nt(e,"dmn:Definitions")||Nt(t,"dmn:Definitions"))return!1;if(Nt(e,"dmn:Decision")||Nt(e,"dmn:InputData")){if(Nt(t,"dmn:Decision")||Nt(e,"dmn:Decision")&&Nt(t,"dmn:InputData"))return{type:"dmn:InformationRequirement"};if(Nt(t,"dmn:KnowledgeSource"))return{type:"dmn:AuthorityRequirement"}}return Nt(e,"dmn:BusinessKnowledgeModel")&&Ft(t,["dmn:Decision","dmn:BusinessKnowledgeModel"])?{type:"dmn:KnowledgeRequirement"}:Nt(e,"dmn:KnowledgeSource")&&Ft(t,["dmn:Decision","dmn:BusinessKnowledgeModel","dmn:KnowledgeSource"])?{type:"dmn:AuthorityRequirement"}:!!Nt(t,"dmn:TextAnnotation")&&{type:"dmn:Association"}}function _c(e,t){return Nt(t,"dmn:Definitions")}function wc(e,t){return!t||!!Nt(t,"dmn:Definitions")}mc.$inject=["eventBus"],Gt(mc,fc),mc.prototype.addRule=function(e,t,n){var r=this;"string"==typeof e&&(e=[e]),e.forEach(function(e){r.canExecute(e,t,function(e,t,r){return n(e)},!0)})},mc.prototype.init=function(){},Gt(gc,mc),gc.$inject=["eventBus"],gc.prototype.init=function(){this.addRule("elements.move",function(e){var t=e.target,n=e.shapes;e.position;return wc(n,t)}),this.addRule("connection.create",function(e){return bc(e.source,e.target)}),this.addRule("connection.reconnectStart",function(e){var t=e.connection;return bc(e.hover||e.source,t.target)}),this.addRule("connection.reconnectEnd",function(e){var t=e.connection;return bc(t.source,e.hover||e.target)}),this.addRule("connection.updateWaypoints",function(e){return null}),this.addRule("shape.create",function(e){return _c(e.shape,e.target)})},gc.prototype.canConnect=bc,gc.prototype.canCreate=_c,gc.prototype.canMove=wc;var xc={__depends__:[li],__init__:["drdRules"],drdRules:["type",gc]};function Cc(e){this._model=e}function Ec(e,t,n,r,o){fc.call(this,e),this._drdFactory=t,this._drdRules=r,this._definitionPropertiesView=o;var i=this;function a(e){var t=e.context,n=t.shape||t.connection,r=t.oldParent;t.connection&&!Nt(n,"dmn:Association")&&(r=n.target),i.updateParent(n,r)}function s(e){var t=e.context,n=t.shape||t.connection,r=t.parent||t.newParent;t.connection&&!Nt(n,"dmn:Association")&&(r=n.target),i.updateParent(n,r)}function c(e){var t=e.context.shape;(Nt(t,"dmn:DRGElement")||Nt(t,"dmn:TextAnnotation"))&&i.updateBounds(t)}function u(e){i.updateConnectionWaypoints(e.context)}this.executed(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){var t,r=e.context;r.cropped||((t=r.connection).waypoints=n.getCroppedWaypoints(t),r.cropped=!0)}),this.reverted(["connection.layout"],function(e){delete e.context.cropped}),this.executed(["shape.create","shape.delete","connection.create","connection.move","connection.delete"],a),this.reverted(["shape.create","shape.delete","connection.create","connection.move","connection.delete"],s),this.executed(["shape.create","shape.move"],c),this.reverted(["shape.create","shape.move"],c),this.executed(["connection.layout","connection.updateWaypoints","connection.move"],u),this.reverted(["connection.layout","connection.updateWaypoints","connection.move"],u),this.executed(["connection.create"],function(e){var t,n,r=e.context,o=r.connection,s=r.target.businessObject;Nt(o,"dmn:Association")?a(e):(i.updateSemanticParent(o.businessObject,s),t=r.di,n=s.extensionElements.values,p(t.waypoints,function(e,t){e.x=o.waypoints[t].x,e.y=o.waypoints[t].y}),n.push(t))}),this.reverted(["connection.create"],function(e){var t,n,r,o=e.context,i=o.connection;s(e),Nt(i,"dmn:Association")||(t=o.di,-1!==(r=(n=o.target.businessObject.extensionElements.values).indexOf(t))&&n.splice(r,1))}),this.executed(["connection.delete"],function(e){var t,n=e.context,r=$t(n.connection),o=n.source,i=$t(n.target);Nt(r,"dmn:Association")||(p(i.extensionElements.values,function(e,n){if(Nt(e,"biodi:Edge")&&o.id===e.source)return t=n,!1}),void 0!==t&&(n.oldDI=i.extensionElements.values[t],i.extensionElements.values.splice(t,1)))}),this.reverted(["connection.delete"],function(e){var t=e.context,n=t.connection,r=$t(t.target),o=t.oldDI;o&&!Nt(n,"dmn:Association")&&r.extensionElements.values.push(o)}),this.executed(["element.updateProperties"],function(e){o.update()}),this.reverted(["element.updateProperties"],function(e){o.update()}),this.reverted(["connection.reconnectEnd"],function(e){i.updateSemanticParent(e.context.connection.businessObject,e.context.oldTarget.businessObject)})}function Oc(e){wr.call(this),this._drdFactory=e}function kc(e){this._modeling=e}Cc.$inject=["moddle"],Cc.prototype._needsId=function(e){return e.$instanceOf("dmn:DRGElement")||e.$instanceOf("dmn:Artifact")||e.$instanceOf("dmn:DMNElement")},Cc.prototype._ensureId=function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},Cc.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},Cc.prototype.createDi=function(){return this.create("dmn:ExtensionElements",{values:[]})},Cc.prototype.createDiBounds=function(e){return this.create("biodi:Bounds",e)},Cc.prototype.createDiEdge=function(e,t){var n=this,r=[];return p(t||[],function(e){r.push(n.createDiWaypoint(e))}),this.create("biodi:Edge",{waypoints:r,source:e.id})},Cc.prototype.createDiWaypoint=function(e){return this.create("biodi:Waypoint",e)},Gt(Ec,fc),Ec.$inject=["eventBus","drdFactory","connectionDocking","drdRules","definitionPropertiesView"],Ec.prototype.updateParent=function(e,t){var n=e.parent;Nt(e,"dmn:DRGElement")||Nt(e,"dmn:Artifact")||(n=t);var r=e.businessObject,o=n&&n.businessObject;this.updateSemanticParent(r,o),this.updateExtensionElements(r)},Ec.prototype.updateBounds=function(e){var t,n,r=this._drdFactory,o=$t(e).extensionElements;o&&((n=(t=o.values)[0])?t[0]=S(n,{x:e.x,y:e.y,width:e.width,height:e.height}):t.push(r.createDiBounds({x:e.x,y:e.y,width:e.width,height:e.height})))},Ec.prototype.updateExtensionElements=function(e){var t=e.extensionElements;t&&!t.$parent&&(t.$parent=e)},Ec.prototype.updateSemanticParent=function(e,t){var n,r;e.$parent!==t&&(e.$instanceOf("dmn:DRGElement")?n="drgElements":e.$instanceOf("dmn:Artifact")?n="artifacts":e.$instanceOf("dmn:InformationRequirement")?n="informationRequirement":e.$instanceOf("dmn:AuthorityRequirement")?n="authorityRequirement":e.$instanceOf("dmn:KnowledgeRequirement")&&(n="knowledgeRequirement"),e.$parent&&Un(r=e.$parent.get(n),e),t?(r=t.get(n))&&(r.push(e),e.$parent=t):e.$parent=null)},Ec.prototype.updateConnectionWaypoints=function(e){var t,n=this._drdFactory,r=e.connection,o=r.source,i=r.target;(t=Nt(r,"dmn:Association")?r.businessObject.extensionElements:i.businessObject.extensionElements).values=v(t.values,function(e){return Nt(e,"biodi:Edge")&&e.source===o.id&&(e.waypoints=[],p(r.waypoints,function(t,r){var o=n.createDiWaypoint(P(t,["x","y"]));o.$parent=e,e.waypoints.push(o)})),e})},Gt(Oc,wr),Oc.$inject=["drdFactory"],Oc.prototype.baseCreate=wr.prototype.create,Oc.prototype.create=function(e,t){return this.createDrdElement(e,t)},Oc.prototype.createDrdElement=function(e,t){var n,r=this._drdFactory,o=(t=t||{}).businessObject;if(!o){if(!t.type)throw new Error("no shape type specified");o=r.create(t.type)}return"root"===e||"connection"===e||o.extensionElements||(o.extensionElements=r.createDi()),n=this._getDefaultSize(o),t=S({businessObject:o,id:o.id},n,t),this.baseCreate(e,t)},Oc.prototype._getDefaultSize=function(e){return Nt(e,"dmn:Decision")?{width:180,height:80}:Nt(e,"dmn:InputData")?{width:125,height:45}:Nt(e,"dmn:KnowledgeSource")?{width:100,height:63}:Nt(e,"dmn:BusinessKnowledgeModel")?{width:135,height:46}:{width:100,height:80}},kc.$inject=["modeling"],kc.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,r=e.shape;r=e.shape=this._modeling.createShape(r,e.position,n,{attach:e.attach}),e.shape=r},kc.prototype.postExecute=function(e){var t,n,r=e.connectionParent||e.shape.parent;t=e.source,n=e.shape,h(t.outgoing,function(e){return e.target===n})||this._modeling.connect(e.source,e.shape,e.connection,r)};var jc=Math.round;function Sc(e){this._canvas=e}function Pc(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}function Tc(e,t){this._canvas=e,this._modeling=t}function Rc(e,t,n){var r=Do(t),o=Do(n),i=Io(e,r),a=i.x*(n.width/t.width),s=i.y*(n.height/t.height);return Ia({x:o.x+a,y:o.y+s})}function Ac(e,t,n){var r=Nc(e)[0];return Rc(r.original||r,n,t)}function Mc(e,t,n){var r=Nc(e),o=r[r.length-1];return Rc(o.original||o,n,t)}function Bc(e,t,n){return Ac(e,t,Ic(t,n))}function Dc(e,t,n){return Mc(e,t,Ic(t,n))}function Ic(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Nc(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Vc(e){this._modeling=e}function Lc(e){this._modeling=e,this._helper=new Vc(e)}function $c(e){this._modeling=e}function Fc(e,t){this._modeling=e,this._rules=t}function Uc(e){this._modeling=e}function zc(e){this._modeling=e}function Wc(e){Sc.call(this,e)}Sc.$inject=["canvas"],Sc.prototype.execute=function(e){var t=e.shape,n=e.position,r=e.parent,o=e.parentIndex;if(!r)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?S(t,n):S(t,{x:n.x-jc(t.width/2),y:n.y-jc(t.height/2)}),this._canvas.addShape(t,r,o),t},Sc.prototype.revert=function(e){this._canvas.removeShape(e.shape)},Tc.$inject=["canvas","modeling"],Tc.prototype.preExecute=function(e){var t=this._modeling,n=e.shape,r=n.label;n.labelTarget&&(e.labelTarget=n.labelTarget,n.labelTarget=null),r&&this._modeling.removeShape(r,{nested:!0}),Pc(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),Pc(n.outgoing,function(e){t.removeConnection(e,{nested:!0})}),Pc(n.children,function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},Tc.prototype.execute=function(e){var t=this._canvas,n=e.shape,r=n.parent;return e.oldParent=r,e.oldParentIndex=Wn(r.children,n),n.label=null,t.removeShape(n),n},Tc.prototype.revert=function(e){var t=this._canvas,n=e.shape,r=e.oldParent,o=e.oldParentIndex,i=e.labelTarget;return zn(r.children,n,o),i&&(i.label=n),t.addShape(n,r),n},Vc.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},Vc.prototype.moveClosure=function(e,t,n,r,o){var i=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,l=!1;o&&o.parent===n&&(l=!0),p(a,function(e){i.moveShape(e,t,u[e.id]&&!l&&n,{recurse:!1,layout:!1})}),p(s,function(e){var r=!!a[e.source.id],o=!!a[e.target.id];c[e.id]&&r&&o?i.moveConnection(e,t,u[e.id]&&!l&&n):i.layoutConnection(e,{connectionStart:r&&Bc(e,e.source,t),connectionEnd:o&&Dc(e,e.target,t)})})},Vc.prototype.getClosure=function(e){var t=m(e,function(e){return e.id}),n={},r={},o={},i={};function a(e){t[e.source.id]&&t[e.target.id]&&(t[e.id]=[e]),n[e.source.id]&&n[e.target.id]&&(i[e.id]=o[e.id]=e),r[e.id]=e}return Hn(e,function(e){if(o[e.id]=e,!e.waypoints)return n[e.id]=e,p(e.incoming,a),p(e.outgoing,a),e.children;i[e.id]=r[e.id]=e}),{allShapes:n,allConnections:r,topLevel:t,enclosedConnections:i,enclosedElements:o}},Lc.$inject=["modeling"],Lc.prototype.execute=function(e){var t=e.shape,n=e.delta,r=e.newParent||t.parent,o=e.newParentIndex,i=t.parent;return e.oldBounds=P(t,["x","y","width","height"]),e.oldParent=i,e.oldParentIndex=Un(i.children,t),zn(r.children,t,o),S(t,{parent:r,x:t.x+n.x,y:t.y+n.y}),t},Lc.prototype.postExecute=function(e){var t=e.shape,n=e.delta,r=e.hints,o=this._modeling;!1!==r.layout&&(p(t.incoming,function(e){o.layoutConnection(e,{connectionEnd:Dc(e,t,n)})}),p(t.outgoing,function(e){o.layoutConnection(e,{connectionStart:Bc(e,t,n)})})),!1!==r.recurse&&this.moveChildren(e)},Lc.prototype.revert=function(e){var t=e.shape,n=e.oldParent,r=e.oldParentIndex,o=e.delta;return zn(n.children,t,r),S(t,{parent:n,x:t.x-o.x,y:t.y-o.y}),t},Lc.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},Lc.prototype.getNewParent=function(e){return e.newParent||e.shape.parent},$c.$inject=["modeling"],$c.prototype.execute=function(e){var t=e.shape,n=e.newBounds,r=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(r&&(n.width<r.width||n.height<r.height))throw new Error("width and height cannot be less than minimum height and width");if(!r&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},S(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},$c.prototype.postExecute=function(e){var t=e.shape,n=e.oldBounds,r=this._modeling;p(t.incoming,function(e){r.layoutConnection(e,{connectionEnd:Mc(e,t,n)})}),p(t.outgoing,function(e){r.layoutConnection(e,{connectionStart:Ac(e,t,n)})})},$c.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return S(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},Fc.$inject=["modeling","rules"],Fc.prototype.preExecute=function(e){var t,n=this,r=this._modeling,o=this._rules,i=e.oldShape,a=e.newData,s=e.hints;function c(e,t,n,r){return o.allowed(e,{source:t,target:n,connection:r})}var u,l={x:a.x,y:a.y};t=e.newShape=e.newShape||n.createShape(a,l,i.parent),i.host&&r.updateAttachment(t,i.host),!1!==s.moveChildren&&(u=i.children.slice(),r.moveElements(u,{x:0,y:0},t));var f=i.incoming.slice(),d=i.outgoing.slice();p(f,function(e){var r=e.waypoints,o=r[r.length-1];c("connection.reconnectEnd",e.source,t,e)&&n.reconnectEnd(e,t,o)}),p(d,function(e){var r=e.waypoints[0],o=e.target;c("connection.reconnectStart",t,o,e)&&n.reconnectStart(e,t,r)})},Fc.prototype.postExecute=function(e){var t=this._modeling,n=e.oldShape,r=e.newShape;p(r.incoming,function(e){t.layoutConnection(e,{endChanged:!0})}),p(r.outgoing,function(e){t.layoutConnection(e,{startChanged:!0})}),t.removeShape(n)},Fc.prototype.execute=function(e){},Fc.prototype.revert=function(e){},Fc.prototype.createShape=function(e,t,n){return this._modeling.createShape(e,t,n)},Fc.prototype.reconnectStart=function(e,t,n){this._modeling.reconnectStart(e,t,n)},Fc.prototype.reconnectEnd=function(e,t,n){this._modeling.reconnectEnd(e,t,n)},Uc.$inject=["modeling"],Uc.prototype.execute=function(e){var t,n=e.shape,r=n.children;return e.oldChildrenVisibility=(t={},r.forEach(function(e){t[e.id]=e.hidden}),t),n.collapsed=!n.collapsed,function(e,t){e.forEach(function(e){e.hidden=t})}(r,n.collapsed),[n].concat(r)},Uc.prototype.revert=function(e){var t,n=e.shape,r=e.oldChildrenVisibility,o=n.children;return t=r,o.forEach(function(e){e.hidden=t[e.id]}),n.collapsed=!n.collapsed,[n].concat(o)},zc.$inject=["modeling"],zc.prototype.preExecute=function(e){var t=this._modeling,n=e.resizingShapes,r=e.delta,o=e.direction;p(n,function(e){var n=function(e,t,n){var r=n.x,o=n.y;switch(t){case"n":return{x:e.x,y:e.y+o,width:e.width,height:e.height-o};case"s":return{x:e.x,y:e.y,width:e.width,height:e.height+o};case"w":return{x:e.x+r,y:e.y,width:e.width-r,height:e.height};case"e":return{x:e.x,y:e.y,width:e.width+r,height:e.height};default:throw new Error("unrecognized direction: "+t)}}(e,o,r);t.resizeShape(e,n)})},zc.prototype.postExecute=function(e){var t=this._modeling,n=e.movingShapes,r=e.delta;t.moveElements(n,r,void 0,{autoResize:!1,attach:!1})},zc.prototype.execute=function(e){},zc.prototype.revert=function(e){},Gt(Wc,Sc),Wc.$inject=["canvas"];var Gc=Sc.prototype.execute;Wc.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach(function(t){void 0===e[t]&&(e[t]=0)})}(t),t.labelTarget=e.labelTarget,Gc.call(this,e)};var Hc=Sc.prototype.revert;function qc(e,t){this._canvas=e,this._layouter=t}function Kc(e,t){this._canvas=e,this._modeling=t}function Xc(){}function Yc(e,t){this._layouter=e,this._canvas=t}function Zc(){}function Jc(){}function Qc(e){this._helper=new Vc(e)}function eu(e,t){this._modeling=e,this._elementRegistry=t}function tu(e){this._modeling=e}Wc.prototype.revert=function(e){return e.shape.labelTarget=null,Hc.call(this,e)},qc.$inject=["canvas","layouter"],qc.prototype.execute=function(e){var t=e.connection,n=e.source,r=e.target,o=e.parent,i=e.parentIndex,a=e.hints;if(!n||!r)throw new Error("source and target required");if(!o)throw new Error("parent required");return t.source=n,t.target=r,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,o,i),t},qc.prototype.revert=function(e){var t=e.connection;this._canvas.removeConnection(t),t.source=null,t.target=null},Kc.$inject=["canvas","modeling"],Kc.prototype.preExecute=function(e){var t=e.connection;t.label&&this._modeling.removeShape(t.label)},Kc.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=Wn(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t.label=null,t},Kc.prototype.revert=function(e){var t=e.connection,n=e.parent,r=e.parentIndex;return t.source=e.source,t.target=e.target,zn(n.children,t,r),this._canvas.addConnection(t,n),t},Xc.prototype.execute=function(e){var t=e.connection,n=e.delta,r=e.newParent||t.parent,o=e.newParentIndex,i=t.parent;return e.oldParent=i,e.oldParentIndex=Un(i.children,t),zn(r.children,t,o),t.parent=r,p(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},Xc.prototype.revert=function(e){var t=e.connection,n=t.parent,r=e.oldParent,o=e.oldParentIndex,i=e.delta;return Un(n.children,t),zn(r.children,t,o),t.parent=r,p(t.waypoints,function(e){e.x-=i.x,e.y-=i.y,e.original&&(e.original.x-=i.x,e.original.y-=i.y)}),t},Yc.$inject=["layouter","canvas"],Yc.prototype.execute=function(e){var t=e.connection;return S(e,{oldWaypoints:t.waypoints}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},Yc.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t},Zc.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},Zc.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t},Jc.$inject=[],Jc.prototype.execute=function(e){var t,n=e.newSource,o=e.newTarget,i=e.connection,a=e.dockingOrPoints,s=i.waypoints;if(!n&&!o)throw new Error("newSource or newTarget are required");if(n&&o)throw new Error("must specify either newSource or newTarget");return e.oldWaypoints=s,r(a)?t=a:(t=s.slice()).splice(n?0:-1,1,a),n&&(e.oldSource=i.source,i.source=n),o&&(e.oldTarget=i.target,i.target=o),i.waypoints=t,i},Jc.prototype.revert=function(e){var t=e.newSource,n=e.newTarget,r=e.connection;return t&&(r.source=e.oldSource),n&&(r.target=e.oldTarget),r.waypoints=e.oldWaypoints,r},Qc.$inject=["modeling"],Qc.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},Qc.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)},eu.$inject=["modeling","elementRegistry"],eu.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry;p(e.elements,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})},tu.$inject=["modeling"];var nu={x:"y",y:"x"};function ru(e,t){this._modeling=e,this._canvas=t}function ou(e){this._modeling=e}function iu(e,t){return Un(e&&e.attachers,t)}function au(e,t,n){if(e){var r=e.attachers;r||(e.attachers=r=[]),zn(r,t,n)}}function su(e,t){p(t,function(t){e[t]&&delete e[t]})}function cu(e,t,n,r,o,i){this._eventBus=e,this._canvas=t,this._selection=n,this._elementFactory=r,this._modeling=o,this._rules=i}tu.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,r=e.axis,o=e.dimension;function i(e,t){e.range.min=Math.min(t[r],e.range.min),e.range.max=Math.max(t[r]+t[o],e.range.max)}function a(e){return e[r]+e[o]/2}function s(e){return e.length-1}function c(e){return e.max-e.min}var u,l,f=n[0],d=s(n),h=n[d],v=0;p(n,function(e,u){var l,f,h;e.elements.length<2?u&&u!==n.length-1&&(i(e,e.elements[0]),v+=c(e.range)):(f=(l=g(e.elements,r))[0],u===d&&(f=l[s(l)]),h=a(f),e.range=null,p(l,function(n){!function(e,n){var o={y:0};o[r]=e-a(n),o[r]&&(o[nu[r]]=0,t.moveElements([n],o,n.parent))}(h,n),null!==e.range?i(e,n):e.range={min:n[r],max:n[r]+n[o]}}),u&&u!==n.length-1&&(v+=c(e.range)))}),l=Math.abs(h.range.min-f.range.max),(u=Math.round((l-v)/(n.length-1)))<n.length-1||p(n,function(e,i){var a,s={};e!==f&&e!==h&&(a=n[i-1],e.range.max=0,p(e.elements,function(n,i){s[nu[r]]=0,s[r]=a.range.max-n[r]+u,e.range.min!==n[r]&&(s[r]+=n[r]-e.range.min),s[r]&&t.moveElements([n],s,n.parent),e.range.max=Math.max(n[r]+n[o],i?e.range.max:0)}))})},tu.prototype.postExecute=function(e){},ru.$inject=["modeling","canvas"],ru.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,r=e.alignment;p(n,function(e){var n={x:0,y:0};r.left?n.x=r.left-e.x:r.right?n.x=r.right-e.width-e.x:r.center?n.x=r.center-Math.round(e.width/2)-e.x:r.top?n.y=r.top-e.y:r.bottom?n.y=r.bottom-e.height-e.y:r.middle&&(n.y=r.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)})},ru.prototype.postExecute=function(e){},ou.$inject=["modeling"],ou.prototype.execute=function(e){var t=e.shape,n=e.newHost,r=t.host;return e.oldHost=r,e.attacherIdx=iu(r,t),au(n,t),t.host=n,t},ou.prototype.revert=function(e){var t=e.shape,n=e.newHost,r=e.oldHost,o=e.attacherIdx;return t.host=r,iu(n,t),au(r,t,o),t},cu.$inject=["eventBus","canvas","selection","elementFactory","modeling","rules"],cu.prototype.preExecute=function(e){var t=this._eventBus,n=this,r=e.tree,o=e.topParent,i=e.position;r.createdElements={},r.labels=[],p(r,function(e,a){var s=parseInt(a,10);isNaN(s)||(s||(e=v(e,function(e){return e.parent=o,e})),p(e=g(e,"priority"),function(e){var a,c=e.id,u=e.parent,l={},p=S({},e);if(s&&(p.parent=n._getCreatedElement(u,r)),u)if(t.fire("element.paste",{createdElements:r.createdElements,descriptor:p}),u=p.parent,p.waypoints)(p=n._createConnection(p,u,i,r))&&(r.createdElements[c]={element:p,descriptor:e});else{if(p.parent!==o&&(l.root=!1),p.host&&(l.attach=!0,u=n._getCreatedElement(p.host,r)),p.labelTarget)return r.labels.push(p);a={x:Math.round(i.x+p.delta.x+p.width/2),y:Math.round(i.y+p.delta.y+p.height/2)},su(p,["id","parent","delta","host","priority"]),(p=n._createShape(p,u,a,l))&&(r.createdElements[c]={element:p,descriptor:e})}}))})},cu.prototype.postExecute=function(e){var t=this._modeling,n=this._selection,r=this,o=e.tree,i=[];p(o.labels,function(e){var n,i,a,s=r._getCreatedElement(e.labelTarget,o);s&&(n=s.label)&&(i={x:s.x,y:s.y},s.waypoints&&(i=s.waypoints[0]),a={x:Math.round(i.x-n.x+e.delta.x),y:Math.round(i.y-n.y+e.delta.y)},t.moveShape(n,a,s.parent))}),p(o[0],function(e){var t=e.id,n=o.createdElements[t];n&&i.push(n.element)}),n.select(i)},cu.prototype._createConnection=function(e,t,n,r){var o,i,a=this._modeling,s=this._rules;return e.waypoints=v(e.waypoints,function(t,r){return{x:Math.round(n.x+e.delta[r].x),y:Math.round(n.y+e.delta[r].y)}}),o=this._getCreatedElement(e.source,r),i=this._getCreatedElement(e.target,r),o&&i&&s.allowed("element.paste",{source:o,target:i})?(su(e,["id","parent","delta","source","target","width","height","priority"]),a.createConnection(o,i,e,t)):null},cu.prototype._createShape=function(e,t,n,r,o){var i=this._modeling,a=this._elementFactory;if(!this._rules.allowed("element.paste",{element:e,position:n,parent:t}))return null;var s=a.createShape(e);return i.createShape(s,n,t,r,o),s},cu.prototype._getCreatedElement=function(e,t){return t.createdElements[e]&&t.createdElements[e].element};var uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function lu(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var r=this;e.on("diagram.init",function(){r.registerHandlers(n)})}lu.$inject=["eventBus","elementFactory","commandStack"],lu.prototype.getHandlers=function(){return{"shape.append":kc,"shape.create":Sc,"shape.delete":Tc,"shape.move":Lc,"shape.resize":$c,"shape.replace":Fc,"shape.toggleCollapse":Uc,spaceTool:zc,"label.create":Wc,"connection.create":qc,"connection.delete":Kc,"connection.move":Xc,"connection.layout":Yc,"connection.updateWaypoints":Zc,"connection.reconnectStart":Jc,"connection.reconnectEnd":Jc,"elements.move":Qc,"elements.delete":eu,"elements.distribute":tu,"elements.align":ru,"element.updateAttachment":ou,"elements.paste":cu}},lu.prototype.registerHandlers=function(e){p(this.getHandlers(),function(t,n){e.registerHandler(n,t)})},lu.prototype.moveShape=function(e,t,n,r,o){"object"===(void 0===r?"undefined":uu(r))&&(o=r,r=null);var i={shape:e,delta:t,newParent:n,newParentIndex:r,hints:o||{}};this._commandStack.execute("shape.move",i)},lu.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)},lu.prototype.moveElements=function(e,t,n,r){var o,i=(r=r||{}).attach,a=n;!0===i?(o=n,a=n.parent):!1===i&&(o=null);var s={shapes:e,delta:t,newParent:a,newHost:o,hints:r};this._commandStack.execute("elements.move",s)},lu.prototype.moveConnection=function(e,t,n,r,o){"object"===(void 0===r?"undefined":uu(r))&&(o=r,r=void 0);var i={connection:e,delta:t,newParent:n,newParentIndex:r,hints:o||{}};this._commandStack.execute("connection.move",i)},lu.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)},lu.prototype.createConnection=function(e,t,n,r,o,i){"object"===(void 0===n?"undefined":uu(n))&&(i=o,o=r,r=n,n=void 0);var a={source:e,target:t,parent:o,parentIndex:n,connection:r=this._create("connection",r),hints:i};return this._commandStack.execute("connection.create",a),a.connection},lu.prototype.createShape=function(e,t,n,r,o){"number"!=typeof r&&(o=r,r=void 0);var i,a,s=(o=o||{}).attach;e=this._create("shape",e),s?(i=n.parent,a=n):i=n;var c={position:t,shape:e,parent:i,parentIndex:r,host:a,hints:o};return this._commandStack.execute("shape.create",c),c.shape},lu.prototype.createLabel=function(e,t,n,r){n=this._create("label",n);var o={labelTarget:e,position:t,parent:r||e.parent,shape:n};return this._commandStack.execute("label.create",o),o.shape},lu.prototype.appendShape=function(e,t,n,r,o){o=o||{};var i={source:e,position:n,target:r,shape:t=this._create("shape",t),connection:o.connection,connectionParent:o.connectionParent,attach:o.attach};return this._commandStack.execute("shape.append",i),i.shape},lu.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},lu.prototype.distributeElements=function(e,t,n){var r={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",r)},lu.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)},lu.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)},lu.prototype.replaceShape=function(e,t,n){var r={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",r),r.newShape},lu.prototype.pasteElements=function(e,t,n){var r={tree:e,topParent:t,position:n};this._commandStack.execute("elements.paste",r)},lu.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)},lu.prototype.resizeShape=function(e,t,n){var r={shape:e,newBounds:t,minBounds:n};this._commandStack.execute("shape.resize",r)},lu.prototype.createSpace=function(e,t,n,r){var o={movingShapes:e,resizingShapes:t,delta:n,direction:r};this._commandStack.execute("spaceTool",o)},lu.prototype.updateWaypoints=function(e,t,n){var r={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",r)},lu.prototype.reconnectStart=function(e,t,n){var r={connection:e,newSource:t,dockingOrPoints:n};this._commandStack.execute("connection.reconnectStart",r)},lu.prototype.reconnectEnd=function(e,t,n){var r={connection:e,newTarget:t,dockingOrPoints:n};this._commandStack.execute("connection.reconnectEnd",r)},lu.prototype.connect=function(e,t,n,r){return this.createConnection(e,t,n||{},e.parent,r)},lu.prototype._create=function(e,t){return t instanceof vr?t:this._elementFactory.create(e,t)},lu.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};var pu="id";function fu(e,t){this._elementRegistry=e,this._moddle=t}function du(e,t){return pu in e&&e[pu]!==t[pu]}function hu(e,t){p(t,function(t,n){e.set(n,t)})}function vu(e){this._moddle=e}function yu(e,t,n,r,o){this._canvas=e,this._drdRules=o,lu.call(this,t,n,r)}function mu(){}function gu(){}function bu(e,t){return e?e.original||e:Va(t)}function _u(e){return S({original:e.point.original||e.point},e.actual)}function wu(e,t){this._elementRegistry=e,this._graphicsFactory=t}fu.$inject=["elementRegistry","moddle"],fu.prototype.execute=function(e){var t=e.element,n=[t];if(!t)throw new Error("element required");var r=this._elementRegistry,o=this._moddle.ids,i=t.businessObject,a=e.properties,s=e.oldProperties||function(e,t){return f(t,function(t,n){return t[n]=e.get(n),t},{})}(i,y(a));return du(a,i)&&(o.unclaim(i[pu]),r.updateId(t,a[pu]),o.claim(a[pu],i)),"name"in a&&t.label&&n.push(t.label),hu(i,a),e.oldProperties=s,e.changed=n,n},fu.prototype.revert=function(e){var t=e.element,n=e.properties,r=e.oldProperties,o=t.businessObject,i=this._elementRegistry,a=this._moddle.ids;return hu(o,r),du(n,o)&&(a.unclaim(n[pu]),i.updateId(t,r[pu]),a.claim(r[pu],o)),e.changed},vu.$inject=["moddle"],vu.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,r=e.element;e.claiming?t.claim(n,r):t.unclaim(n)},vu.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,r=e.element;e.claiming?t.unclaim(n):t.claim(n,r)},Gt(yu,lu),yu.$inject=["canvas","eventBus","elementFactory","commandStack","drdRules"],yu.prototype.getHandlers=function(){var e=lu.prototype.getHandlers.call(this);return e["element.updateProperties"]=fu,e["id.updateClaim"]=vu,e},yu.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},yu.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},yu.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},yu.prototype.connect=function(e,t,n,r){var o=this._drdRules,i=this._canvas.getRootElement();return n||(n=o.canConnect(e,t)||{type:"dmn:Association"}),this.createConnection(e,t,n,i,r)},mu.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||Va(e.source),t.connectionEnd||Va(e.target)]},Gt(gu,mu),gu.prototype.layoutConnection=function(e,t){t=t||{};var n,r=e.source,o=e.target,i=e.waypoints,a=t.connectionStart,s=t.connectionEnd;return n=(i=i||[]).slice(1,i.length-1),a||(a=bu(i&&i[0],r)),s||(s=bu(i&&i[i.length-1],o)),[a].concat(n,[s])},wu.$inject=["elementRegistry","graphicsFactory"],wu.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var r=this.getDockingPoint(e,t,!0),o=this.getDockingPoint(e,n),i=e.waypoints.slice(r.idx+1,o.idx);return i.unshift(_u(r)),i.push(_u(o)),i},wu.prototype.getDockingPoint=function(e,t,n){var r,o,i=e.waypoints;return{point:o=i[r=n?0:i.length-1],actual:this._getIntersection(t,e,n)||o,idx:r}},wu.prototype._getIntersection=function(e,t,n){return $a(this._getShapePath(e),this._getConnectionPath(t),n)},wu.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},wu.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},wu.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var xu={__init__:["modeling","drdUpdater"],__depends__:[yc,xc,Co,Zs,po,Qs],drdFactory:["type",Cc],drdUpdater:["type",Ec],elementFactory:["type",Oc],modeling:["type",yu],layouter:["type",gu],connectionDocking:["type",wu]};function Cu(e,t){this._eventBus=e,this._canvas=t,this._providers=[];var n=this;e.on("tool-manager.update",function(e){var t=e.tool;n.updateToolHighlight(t)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._providers.length&&(n._init(),n._update())})}Cu.$inject=["eventBus","canvas"],Cu.prototype.registerProvider=function(e){this._providers.push(e),this._diagramInitialized&&(this._container||this._init(),this._update())},Cu.prototype.getEntries=function(){var e={};return p(this._providers,function(t){p(t.getPaletteEntries(),function(t,n){e[n]=t})}),e},Cu.prototype._init=function(){var e=this._canvas,t=this._eventBus,n=e.getContainer(),r=this._container=ht(Cu.HTML_MARKUP),o=this;n.appendChild(r),dt.bind(r,".djs-palette-toggle, .entry","click",function(e){var t=e.delegateTarget;if(bt(t,".djs-palette-toggle"))return o.toggle();o.trigger("click",e)}),pt.bind(r,"mousedown",function(e){e.stopPropagation()}),dt.bind(r,".entry","dragstart",function(e){o.trigger("dragstart",e)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:r})},Cu.prototype._toggleState=function(e){e=e||{};var t,n=this._getParentContainer(),r=this._container,o=this._eventBus,i=et(r);t="twoColumn"in e?e.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),i.toggle("two-column",t),"open"in e&&i.toggle("open",e.open),o.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},Cu.prototype._update=function(){var e=_t(".djs-palette-entries",this._container),t=this._entries=this.getEntries();nt(e),p(t,function(t,n){var o=t.group||"default",i=_t("[data-group="+o+"]",e);i||(i=ht('<div class="group" data-group="'+o+'"></div>'),e.appendChild(i));var a,s,c,u=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),l=ht(u);i.appendChild(l),t.separator||(Xe(l,"data-action",n),t.title&&Xe(l,"title",t.title),t.className&&(a=l,s=t.className,c=et(a),(r(s)?s:s.split(/\s+/g)).forEach(function(e){c.add(e)})),t.imageUrl&&l.appendChild(ht('<img src="'+t.imageUrl+'">')))}),this.open()},Cu.prototype.trigger=function(e,t,n){var r,o,i,s=this._entries,c=t.delegateTarget||t.target;if(!c)return t.preventDefault();(r=s[Xe(c,"data-action")])&&(o=r.action,i=t.originalEvent||t,a(o)?"click"===e&&o(i,n):o[e]&&o[e](i,n),t.preventDefault())},Cu.prototype._layoutChanged=function(){this._toggleState({})},Cu.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},Cu.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},Cu.prototype.open=function(){this._toggleState({open:!0})},Cu.prototype.toggle=function(e){this.isOpen()?this.close():this.open()},Cu.prototype.isActiveTool=function(e){return e&&this._activeTool===e},Cu.prototype.updateToolHighlight=function(e){var t;this._toolsContainer||(t=_t(".djs-palette-entries",this._container),this._toolsContainer=_t("[data-group=tools]",t)),p(this._toolsContainer.children,function(t){var n=t.getAttribute("data-action");if(n){var r=et(t);n=n.replace("-tool",""),r.contains("entry")&&n===e?r.add("highlighted-entry"):r.remove("highlighted-entry")}})},Cu.prototype.isOpen=function(){return et(this._container).has("open")},Cu.prototype._getParentContainer=function(){return this._canvas.getContainer()},Cu.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var Eu={__init__:["palette"],palette:["type",Cu]};function Ou(e,t,n,r,o){this._palette=e,this._create=t,this._elementFactory=n,this._lassoTool=r,this._translate=o,e.registerProvider(this)}Ou.$inject=["palette","create","elementFactory","lassoTool","translate"],Ou.prototype.getPaletteEntries=function(e){var t={},n=this._create,r=this._elementFactory,o=this._lassoTool;function i(e,t,o,i,a){function s(t){var o=r.createShape(S({type:e},a));n.start(t,o)}return{group:t,className:o,title:i,action:{dragstart:s,click:s}}}return S(t,{"lasso-tool":{group:"tools",className:"dmn-icon-lasso-tool",title:(0,this._translate)("Activate the lasso tool"),action:{click:function(e){o.activateSelection(e)}}},"tool-separator":{group:"tools",separator:!0},"create.decision":i("dmn:Decision","drd","dmn-icon-decision"),"create.input-data":i("dmn:InputData","drd","dmn-icon-input-data"),"create.knowledge-source":i("dmn:KnowledgeSource","drd","dmn-icon-knowledge-source"),"create.business-knowledge-model":i("dmn:BusinessKnowledgeModel","drd","dmn-icon-business-knowledge")}),t};var ku={__depends__:[Hr,Eu,As,ys],__init__:["paletteProvider"],paletteProvider:["type",Ou]};function ju(e,t,n){this._eventBus=e,this._modeling=t,this._canvas=n,e.on("definitionIdView.create",function(e){var t=e.html,n=_t(".dmn-definitions-name",t),r=_t(".dmn-definitions-id",t);this._setup(n,"name"),this._setup(r,"id")},this)}ju.$inject=["eventBus","modeling","canvas"],ju.prototype.update=function(e,t){var n={};n[e]=t,this._modeling.updateProperties(this._canvas.getRootElement(),n)},ju.prototype._setup=function(e,t){var n=this;e.setAttribute("contenteditable",!0),e.addEventListener("input",O(function(e){var r=e.target.value||e.target.textContent;n.update(t,r.trim())},300)),e.addEventListener("keydown",function(t){13===t.keyCode&&(e.blur(),window.getSelection().removeAllRanges())})};var Su={__init__:["definitionPropertiesEdit","definitionPropertiesPaletteAdapter"],definitionPropertiesEdit:["type",ju],definitionPropertiesPaletteAdapter:["type",xo]};function Pu(e){ci.call(this,e)}function Tu(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ru(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Au(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Gt(Pu,ci),Pu.prototype._modelingModules=[Ri,Ja,ns,gs,zs,Xs,pc,xu,ku,Su],Pu.prototype._modules=[].concat(Pu.prototype._modules,Pu.prototype._modelingModules);var Mu=function e(t){Au(this,e),S(this,t),Lu(this,"businessObject",{writable:!0})},Bu=function(e){function t(e){Au(this,t);var n=Tu(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Lu(n,"rows",{enumerable:!0,value:n.rows||[]}),Lu(n,"cols",{enumerable:!0,value:n.cols||[]}),n}return Ru(t,Mu),t}(),Du=function(e){function t(e){Au(this,t);var n=Tu(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Lu(n,"root",{writable:!0}),Lu(n,"cells",{enumerable:!0,value:n.cells||[]}),n}return Ru(t,Mu),t}(),Iu=function(e){function t(e){Au(this,t);var n=Tu(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Lu(n,"root",{writable:!0}),Lu(n,"cells",{enumerable:!0,value:n.cells||[]}),n}return Ru(t,Mu),t}(),Nu=function(e){function t(e){Au(this,t);var n=Tu(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Lu(n,"row",{writable:!0}),Lu(n,"col",{writable:!0}),n}return Ru(t,Mu),t}(),Vu={root:Bu,row:Du,col:Iu,cell:Nu};function Lu(e,t,n){Object.defineProperty(e,t,n)}var $u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Fu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uid=12}return $u(e,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.id||(t.id=e+"_"+this._uid++),function(e,t){var n=Vu[e];if(!n)throw new Error("unknown type "+e);return new n(t)}(e,t)}},{key:"createRoot",value:function(e){return this.create("root",e)}},{key:"createRow",value:function(e){return this.create("row",e)}},{key:"createCol",value:function(e){return this.create("col",e)}},{key:"createCell",value:function(e){return this.create("cell",e)}}]),e}(),Uu=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var zu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventBus=t,this._elements={},t.on("table.clear",this.clear.bind(this))}return Uu(e,[{key:"add",value:function(e,t){var n=e.id;this._elements[n]=e}},{key:"remove",value:function(e){var t=e.id||e;delete this._elements[t]}},{key:"get",value:function(e){return this._elements[e]}},{key:"getAll",value:function(){return Wu(this._elements)}},{key:"forEach",value:function(e){Wu(this._elements).forEach(function(t){return e(t)})}},{key:"filter",value:function(e){return Wu(this._elements).filter(function(t){return e(t)})}},{key:"clear",value:function(){this._elements={}}}]),e}();function Wu(e){return Object.keys(e).map(function(t){return e[t]})}zu.$inject=["eventBus"];var Gu=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Hu=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners={},t.on("elements.changed",function(e){var t=e.elements;n.elementsChanged(t)}),t.on("root.remove",function(e){var r=e.root.id;n._listeners[r]&&t.once("root.add",function(e){var t=e.root.id;n._listeners[t]=n._listeners[r],delete n._listeners[r]})})}return Gu(e,[{key:"elementsChanged",value:function(e){for(var t={},n=e.length,r=0;r<n;r++){var o=e[r].id;if(t[o])return;t[o]=!0;var i=this._listeners[o]&&this._listeners[o].length;if(i)for(var a=0;a<i;a++)this._listeners[o][a]&&this._listeners[o][a]()}}},{key:"onElementsChanged",value:function(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e][this._listeners[e].length]=t}},{key:"offElementsChanged",value:function(e,t){if(this._listeners[e])if(t){var n=this._listeners[e].indexOf(t);-1!==n&&this._listeners[e].splice(n,1)}else this._listeners[e].length=0}}]),e}();Hu.$inject=["eventBus"];var qu=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ku=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners={}}return qu(e,[{key:"getComponent",value:function(e,t){var n=this._listeners[e];if(n){for(var r=void 0,o=0;o<n.length&&!(r=n[o].callback(t));o++);return r}}},{key:"getComponents",value:function(e,t){var n=this._listeners[e],r=[];if(!n)return r;for(var o=0;o<n.length;o++){var i=n[o].callback(t);i&&r.push(i)}return r.length,r}},{key:"onGetComponent",value:function(e,t,n){if(a(t)&&(n=t,t=1e3),!i(t))throw new Error("priority must be a number");var r=this._getListeners(e),o=void 0,s=void 0,c={priority:t,callback:n};for(s=0;o=r[s];s++)if(o.priority<t)return void r.splice(s,0,c);r.push(c)}},{key:"offGetComponent",value:function(e,t){var n=this._getListeners(e),r=void 0,o=void 0;if(t)for(o=n.length-1;r=n[o];o--)r.callback===t&&n.splice(o,1);else n.length=0}},{key:"_getListeners",value:function(e){var t=this._listeners[e];return t||(this._listeners[e]=t=[]),t}}]),e}(),Xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yu="$NO_OP",Zu="a runtime error occured! Use Inferno in development environment to find the error.",Ju=!("undefined"==typeof window||!window.document),Qu=Array.isArray;function el(e){var t=void 0===e?"undefined":Xu(e);return"string"===t||"number"===t}function tl(e){return sl(e)||al(e)}function nl(e){return al(e)||!1===e||function(e){return!0===e}(e)||sl(e)}function rl(e){return"function"==typeof e}function ol(e){return"string"==typeof e}function il(e){return"number"==typeof e}function al(e){return null===e}function sl(e){return void 0===e}function cl(e){return void 0!==e}function ul(e,t){var n={};if(e)for(var r in e)n[r]=e[r];if(t)for(var o in t)n[o]=t[o];return n}var ll="$";function pl(e,t,n,r,o,i,a,s){return{childFlags:e,children:t,className:n,dom:null,flags:r,key:void 0===o?null:o,parentVNode:null,props:void 0===i?null:i,ref:void 0===a?null:a,type:s}}function fl(e,t,n,r,o,i,a,s){var c=void 0===o?1:o,u=pl(c,r,n,e,a,i,s,t),l=_l.createVNode;return"function"==typeof l&&l(u),0===c&&bl(u,u.children),u}function dl(e,t,n,r,o){(2&e)>0&&(e=cl(t.prototype)&&rl(t.prototype.render)?4:8);var i=t.defaultProps;if(!tl(i))for(var a in n||(n={}),i)sl(n[a])&&(n[a]=i[a]);if((8&e)>0){var s=t.defaultHooks;if(!tl(s))if(o)for(var c in s)sl(o[c])&&(o[c]=s[c]);else o=s}var u=pl(1,null,null,e,r,n,o,t),l=_l.createVNode;return rl(l)&&l(u),u}function hl(e,t){return pl(1,tl(e)?"":e,null,16,t,null,null,null)}function vl(e){var t=e.props;if(t){var n=e.flags;481&n&&(cl(t.children)&&tl(e.children)&&bl(e,t.children),cl(t.className)&&(e.className=t.className||null,t.className=void 0)),cl(t.key)&&(e.key=t.key,t.key=void 0),cl(t.ref)&&(e.ref=8&n?ul(e.ref,t.ref):t.ref,t.ref=void 0)}return e}function yl(e){var t,n=e.flags;if(14&n){var r,o=e.props;if(!al(o))for(var i in r={},o)r[i]=o[i];t=dl(n,e.type,r,e.key,e.ref)}else if(481&n){var a=e.children;t=fl(n,e.type,e.className,a,e.childFlags,e.props,e.key,e.ref)}else 16&n?t=hl(e.children,e.key):1024&n&&(t=e);return t}function ml(){return hl("",null)}function gl(e,t,n,r){for(var o=e.length;n<o;n++){var i=e[n];if(!nl(i)){var a=r+ll+n;if(Qu(i))gl(i,t,0,a);else{if(el(i))i=hl(i,a);else{var s=i.key,c=ol(s)&&s[0]===ll;al(i.dom)&&!c||(i=yl(i)),al(s)||c?i.key=a:i.key=r+s}t.push(i)}}}}function bl(e,t){var n,r=1;if(nl(t))n=t;else if(ol(t))r=2,n=hl(t);else if(il(t))r=2,n=hl(t+"");else if(Qu(t)){var o=t.length;if(0===o)n=null,r=1;else{(Object.isFrozen(t)||!0===t.$)&&(t=t.slice()),r=8;for(var i=0;i<o;i++){var a=t[i];if(nl(a)||Qu(a)){gl(t,n=n||t.slice(0,i),i,"");break}if(el(a))(n=n||t.slice(0,i)).push(hl(a,ll+i));else{var s=a.key,c=al(a.dom),u=al(s),l=!u&&s[0]===ll;!c||u||l?(n=n||t.slice(0,i),c&&!l||(a=yl(a)),(u||l)&&(a.key=ll+i),n.push(a)):n&&n.push(a)}}(n=n||t).$=!0}}else n=t,al(t.dom)||(n=yl(t)),r=2;return e.children=n,e.childFlags=r,e}var _l={afterMount:null,afterRender:null,afterUpdate:null,beforeRender:null,beforeUnmount:null,createVNode:null,roots:[]},wl="http://www.w3.org/1999/xlink",xl="http://www.w3.org/XML/1998/namespace",Cl="http://www.w3.org/2000/svg",El={"xlink:actuate":wl,"xlink:arcrole":wl,"xlink:href":wl,"xlink:role":wl,"xlink:show":wl,"xlink:title":wl,"xlink:type":wl,"xml:base":xl,"xml:lang":xl,"xml:space":xl},Ol={},kl=[];function jl(e,t){e.appendChild(t)}function Sl(e,t,n){tl(n)?jl(e,t):e.insertBefore(t,n)}function Pl(e,t,n){e.replaceChild(t,n)}function Tl(e){for(var t;void 0!==(t=e.shift());)t()}var Rl={},Al={};function Ml(e,t,n){var r=Rl[e],o=n.$EV;t?(r||(Al[e]=function(e){var t=function(t){var n=t.type,r="click"===n||"dblclick"===n;if(r&&0!==t.button)return t.preventDefault(),t.stopPropagation(),!1;t.stopPropagation=Dl;var o={dom:document};Object.defineProperty(t,"currentTarget",{configurable:!0,get:function(){return o.dom}}),function(e,t,n,r,o){var i=t;for(;!al(i);){if(n&&i.disabled)return;var a=i.$EV;if(a){var s=a[r];if(s&&(o.dom=i,s.event?s.event(s.data,e):s(e),e.cancelBubble))return}i=i.parentNode}}(t,t.target,r,e,o)};return document.addEventListener(Bl(e),t),t}(e),Rl[e]=0),o||(o=n.$EV={}),o[e]||Rl[e]++,o[e]=t):o&&o[e]&&(Rl[e]--,1===r&&(document.removeEventListener(Bl(e),Al[e]),Al[e]=null),o[e]=t)}function Bl(e){return e.substr(2).toLowerCase()}function Dl(){this.cancelBubble=!0,this.stopImmediatePropagation()}function Il(e,t){var n=document.createElement("i");return n.innerHTML=t,n.innerHTML===e.innerHTML}function Nl(e,t,n){if(e[t]){var r=e[t];r.event?r.event(r.data,n):r(n)}else{var o=t.toLowerCase();e[o]&&e[o](n)}}function Vl(e,t){var n=function(n){n.stopPropagation();var r=this.$V;if(r){var o=r.props||Ol,i=r.dom;if(ol(e))Nl(o,e,n);else for(var a=0;a<e.length;a++)Nl(o,e[a],n);if(rl(t)){var s=this.$V,c=s.props||Ol;t(c,i,!1,s)}}};return Object.defineProperty(n,"wrapped",{configurable:!1,enumerable:!1,value:!0,writable:!1}),n}function Ll(e){return"checkbox"===e||"radio"===e}var $l=Vl("onInput",zl),Fl=Vl(["onClick","onChange"],zl);function Ul(e){e.stopPropagation()}function zl(e,t){var n=e.type,r=e.value,o=e.checked,i=e.multiple,a=e.defaultValue,s=!tl(r);n&&n!==t.type&&t.setAttribute("type",n),tl(i)||i===t.multiple||(t.multiple=i),tl(a)||s||(t.defaultValue=a+""),Ll(n)?(s&&(t.value=r),tl(o)||(t.checked=o)):s&&t.value!==r?(t.defaultValue=r,t.value=r):tl(o)||(t.checked=o)}function Wl(e,t){if("optgroup"===e.type){var n=e.children,r=e.childFlags;if(12&r)for(var o=0,i=n.length;o<i;o++)Gl(n[o],t);else 2===r&&Gl(n,t)}else Gl(e,t)}function Gl(e,t){var n=e.props||Ol,r=e.dom;r.value=n.value,Qu(t)&&-1!==t.indexOf(n.value)||n.value===t?r.selected=!0:tl(t)&&tl(n.selected)||(r.selected=n.selected||!1)}Ul.wrapped=!0;var Hl=Vl("onChange",ql);function ql(e,t,n,r){var o=Boolean(e.multiple);tl(e.multiple)||o===t.multiple||(t.multiple=o);var i=r.childFlags;if(0==(1&i)){var a=r.children,s=e.value;if(n&&tl(s)&&(s=e.defaultValue),12&i)for(var c=0,u=a.length;c<u;c++)Wl(a[c],s);else 2===i&&Wl(a,s)}}var Kl=Vl("onInput",Yl),Xl=Vl("onChange");function Yl(e,t,n){var r=e.value,o=t.value;if(tl(r)){if(n){var i=e.defaultValue;tl(i)||i===o||(t.defaultValue=i,t.value=i)}}else o!==r&&(t.defaultValue=r,t.value=r)}function Zl(e,t,n,r,o,i){64&e?zl(r,n):256&e?ql(r,n,o,t):128&e&&Yl(r,n,o),i&&(n.$V=t)}function Jl(e,t,n){64&e?function(e,t){Ll(t.type)?(e.onchange=Fl,e.onclick=Ul):e.oninput=$l}(t,n):256&e?function(e){e.onchange=Hl}(t):128&e&&function(e,t){e.oninput=Kl,t.onChange&&(e.onchange=Xl)}(t,n)}function Ql(e){return e.type&&Ll(e.type)?!tl(e.checked):!tl(e.value)}function ep(e,t){tp(e),al(t)||(!function(e,t){e.removeChild(t)}(t,e.dom),e.dom=null)}function tp(e){var t,n=e.flags;if(481&n){var r=e.ref,o=e.props;rl(r)&&r(null);var i=e.children,a=e.childFlags;if(12&a?np(i):2===a&&tp(i),!al(o))for(var s in o)switch(s){case"onClick":case"onDblClick":case"onFocusIn":case"onFocusOut":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onMouseDown":case"onMouseMove":case"onMouseUp":case"onSubmit":case"onTouchEnd":case"onTouchMove":case"onTouchStart":Ml(s,null,e.dom)}}else if(14&n){var c=e.children,u=e.ref;4&n?(rl(_l.beforeUnmount)&&_l.beforeUnmount(e),rl(c.componentWillUnmount)&&c.componentWillUnmount(),rl(u)&&u(null),c.$UN=!0,tp(c.$LI)):(!tl(u)&&rl(u.onComponentWillUnmount)&&u.onComponentWillUnmount(e.dom,e.props||Ol),tp(c))}else if(1024&n){var l=e.children;al(l)||"object"!==(void 0===(t=l)?"undefined":Xu(t))||ep(l,e.type)}}function np(e){for(var t=0,n=e.length;t<n;t++)tp(e[t])}function rp(e,t){np(t),e.textContent=""}function op(e,t){switch(e){case"animationIterationCount":case"borderImageOutset":case"borderImageSlice":case"borderImageWidth":case"boxFlex":case"boxFlexGroup":case"boxOrdinalGroup":case"columnCount":case"fillOpacity":case"flex":case"flexGrow":case"flexNegative":case"flexOrder":case"flexPositive":case"flexShrink":case"floodOpacity":case"fontWeight":case"gridColumn":case"gridRow":case"lineClamp":case"lineHeight":case"opacity":case"order":case"orphans":case"stopOpacity":case"strokeDasharray":case"strokeDashoffset":case"strokeMiterlimit":case"strokeOpacity":case"strokeWidth":case"tabSize":case"widows":case"zIndex":case"zoom":return t;default:return t+"px"}}function ip(e,t,n,r,o,i,a){switch(e){case"onClick":case"onDblClick":case"onFocusIn":case"onFocusOut":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onMouseDown":case"onMouseMove":case"onMouseUp":case"onSubmit":case"onTouchEnd":case"onTouchMove":case"onTouchStart":Ml(e,n,r);break;case"children":case"childrenType":case"className":case"defaultValue":case"key":case"multiple":case"ref":return;case"allowfullscreen":case"autoFocus":case"autoplay":case"capture":case"checked":case"controls":case"default":case"disabled":case"hidden":case"indeterminate":case"loop":case"muted":case"novalidate":case"open":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"selected":r[e="autoFocus"===e?e.toLowerCase():e]=!!n;break;case"defaultChecked":case"value":case"volume":if(i&&"value"===e)return;var s=tl(n)?"":n;r[e]!==s&&(r[e]=s);break;case"dangerouslySetInnerHTML":var c=t&&t.__html||"",u=n&&n.__html||"";c!==u&&(tl(u)||Il(r,u)||(al(a)||(12&a.childFlags?np(a.children):2===a.childFlags&&tp(a.children),a.children=null,a.childFlags=1),r.innerHTML=u));break;default:"o"===e[0]&&"n"===e[1]?function(e,t,n,r){var o=e.toLowerCase();if(rl(n)||tl(n)){var i=r[o];i&&i.wrapped||(r[o]=n)}else{var a=n.event;a&&rl(a)&&(r[o]=function(e,t){return function(n){e(t.data,n)}}(a,n))}}(e,0,n,r):tl(n)?r.removeAttribute(e):"style"===e?function(e,t,n){var r,o,i=n.style;if(ol(t))i.cssText=t;else if(tl(e)||ol(e))for(r in t)o=t[r],i[r]=il(o)?op(r,o):o;else{for(r in t)(o=t[r])!==e[r]&&(i[r]=il(o)?op(r,o):o);for(r in e)tl(t[r])&&(i[r]="")}}(t,n,r):o&&El[e]?r.setAttributeNS(El[e],e,n):r.setAttribute(e,n)}}function ap(e,t,n,r,o){var i=!1,a=(448&t)>0;for(var s in a&&(i=Ql(n))&&Jl(t,r,n),n)ip(s,null,n[s],r,o,i,null);a&&Zl(t,e,r,n,!0,i)}function sp(e,t,n,r){var o=new t(n,r);if(e.children=o,o.$V=e,o.$BS=!1,o.context=r,o.props===Ol&&(o.props=n),o.$UN=!1,rl(o.componentWillMount)){if(o.$BR=!0,o.componentWillMount(),o.$PSS){var i=o.state,a=o.$PS;if(al(i))o.state=a;else for(var s in a)i[s]=a[s];o.$PSS=!1,o.$PS=null}o.$BR=!1}rl(_l.beforeRender)&&_l.beforeRender(o);var c,u=cp(o.render(n,o.state,r),e);return rl(o.getChildContext)&&(c=o.getChildContext()),tl(c)?o.$CX=r:o.$CX=ul(r,c),rl(_l.afterRender)&&_l.afterRender(o),o.$LI=u,o}function cp(e,t){return nl(e)?e=ml():el(e)?e=hl(e,null):(e.dom&&(e=yl(e)),14&e.flags&&(e.parentVNode=t)),e}function up(e,t,n,r,o){var i=e.flags;return 481&i?pp(e,t,n,r,o):14&i?function(e,t,n,r,o,i){var a,s=e.type,c=e.props||Ol,u=e.ref;if(i){var l=sp(e,s,c,r);e.dom=a=up(l.$LI,null,n,l.$CX,o),dp(e,u,l,n),l.$UPD=!1}else{var p=cp(s(c,r),e);e.children=p,e.dom=a=up(p,null,n,r,o),hp(c,u,a,n)}al(t)||jl(t,a);return a}(e,t,n,r,o,(4&i)>0):512&i||16&i?lp(e,t):1024&i?(up(e.children,e.type,n,r,!1),e.dom=lp(ml(),t)):void 0}function lp(e,t){var n=e.dom=document.createTextNode(e.children);return al(t)||jl(t,n),n}function pp(e,t,n,r,o){var i=e.flags,a=e.children,s=e.props,c=e.className,u=e.ref,l=e.childFlags;o=o||(32&i)>0;var p=function(e,t){return!0===t?document.createElementNS(Cl,e):document.createElement(e)}(e.type,o);if(e.dom=p,tl(c)||""===c||(o?p.setAttribute("class",c):p.className=c),al(t)||jl(t,p),0==(1&l)){var f=!0===o&&"foreignObject"!==e.type;2===l?up(a,p,n,r,f):12&l&&fp(a,p,n,r,f)}return al(s)||ap(e,i,s,p,o),rl(u)&&vp(p,u,n),p}function fp(e,t,n,r,o){for(var i=0,a=e.length;i<a;i++){var s=e[i];al(s.dom)||(e[i]=s=yl(s)),up(s,t,n,r,o)}}function dp(e,t,n,r){rl(t)&&t(n);var o=rl(n.componentDidMount),i=_l.afterMount,a=rl(i);(o||a)&&r.push(function(e,t,n,r,o){return function(){e.$UPD=!0,t&&n(r),o&&e.componentDidMount(),e.$UPD=!1}}(n,a,i,e,o))}function hp(e,t,n,r){tl(t)||(rl(t.onComponentWillMount)&&t.onComponentWillMount(e),rl(t.onComponentDidMount)&&r.push(function(e,t,n){return function(){return e.onComponentDidMount(t,n)}}(t,n,e)))}function vp(e,t,n){n.push(function(){return t(e)})}function yp(e,t,n,r,o){var i=e.children,a=e.props,s=e.className,c=e.flags,u=e.ref;if(o=o||(32&c)>0,1!==t.nodeType||t.tagName.toLowerCase()!==e.type){var l=pp(e,null,n,r,o);e.dom=l,Pl(t.parentNode,l,t)}else{e.dom=t;var p=t.firstChild,f=e.childFlags;if(0==(1&f)){for(var d=null;p;)d=p.nextSibling,8===p.nodeType&&("!"===p.data?t.replaceChild(document.createTextNode(""),p):t.removeChild(p)),p=d;if(p=t.firstChild,2===f)al(p)?up(i,t,n,r,o):(d=p.nextSibling,mp(i,p,n,r,o),p=d);else if(12&f)for(var h=0,v=i.length;h<v;h++){var y=i[h];al(p)?up(y,t,n,r,o):(d=p.nextSibling,mp(y,p,n,r,o),p=d)}for(;p;)d=p.nextSibling,t.removeChild(p),p=d}else al(t.firstChild)||function(e,t){return Boolean(t&&t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html&&Il(e,t.dangerouslySetInnerHTML.__html))}(t,a)||(t.textContent="",448&c&&(t.defaultValue=""));al(a)||ap(e,c,a,t,o),tl(s)?""!==t.className&&t.removeAttribute("class"):o?t.setAttribute("class",s):t.className=s,rl(u)&&vp(t,u,n)}}function mp(e,t,n,r,o){var i=e.flags;14&i?function(e,t,n,r,o,i){var a=e.type,s=e.ref,c=e.props||Ol;if(i){var u=sp(e,a,c,r),l=u.$LI;mp(l,t,n,u.$CX,o),e.dom=l.dom,dp(e,s,u,n),u.$UPD=!1}else{var p=cp(a(c,r),e);mp(p,t,n,r,o),e.children=p,e.dom=p.dom,hp(c,s,t,n)}}(e,t,n,r,o,(4&i)>0):481&i?yp(e,t,n,r,o):16&i?function(e,t){if(3!==t.nodeType){var n=lp(e,null);e.dom=n,Pl(t.parentNode,n,t)}else{var r=e.children;t.nodeValue!==r&&(t.nodeValue=r),e.dom=t}}(e,t):512&i?e.dom=t:function(e){throw e||(e=Zu),new Error("Inferno Error: "+e)}()}function gp(e,t,n,r,o,i){tp(e),Pl(n,up(t,null,r,o,i),e.dom)}function bp(e,t,n,r,o,i){if(e!==t){var a=0|t.flags;e.flags!==a||2048&a?gp(e,t,n,r,o,i):481&a?function(e,t,n,r,o,i){var a=t.type;if(e.type!==a)gp(e,t,n,r,o,i);else{var s,c=e.dom,u=t.flags,l=e.props,p=t.props,f=!1,d=!1;if(t.dom=c,i=i||(32&u)>0,l!==p){var h=l||Ol;if((s=p||Ol)!==Ol)for(var v in(f=(448&u)>0)&&(d=Ql(s)),s){var y=h[v],m=s[v];y!==m&&ip(v,y,m,c,i,d,e)}if(h!==Ol)for(var g in h)s.hasOwnProperty(g)||tl(h[g])||ip(g,h[g],null,c,i,d,e)}var b=e.children,_=t.children,w=t.ref,x=e.className,C=t.className;b!==_&&_p(e.childFlags,t.childFlags,b,_,c,r,o,i&&"foreignObject"!==a),f&&Zl(u,t,c,s,!1,d),x!==C&&(tl(C)?c.removeAttribute("class"):i?c.setAttribute("class",C):c.className=C),rl(w)&&e.ref!==w&&vp(c,w,r)}}(e,t,n,r,o,i):14&a?function(e,t,n,r,o,i,a){var s=t.type,c=e.key,u=t.key;if(e.type!==s||c!==u)gp(e,t,n,r,o,i);else{var l=t.props||Ol;if(a){var p=e.children;p.$UPD=!0,wp(p,p.state,t,l,n,r,o,i,!1,!1),p.$V=t,p.$UPD=!1}else{var f=!0,d=e.props,h=t.ref,v=!tl(h),y=e.children;if(t.dom=e.dom,t.children=y,v&&rl(h.onComponentShouldUpdate)&&(f=h.onComponentShouldUpdate(d,l)),!1!==f){v&&rl(h.onComponentWillUpdate)&&h.onComponentWillUpdate(d,l);var m=s(l,o);m!==Yu&&(m=cp(m,t),bp(y,m,n,r,o,i),t.children=m,t.dom=m.dom,v&&rl(h.onComponentDidUpdate)&&h.onComponentDidUpdate(d,l))}else 14&y.flags&&(y.parentVNode=t)}}}(e,t,n,r,o,i,(4&a)>0):16&a?function(e,t,n){var r,o=t.children;al(n.firstChild)?(n.textContent=o,r=n.firstChild):(r=e.dom,o!==e.children&&(r.nodeValue=o));t.dom=r}(e,t,n):512&a?t.dom=e.dom:function(e,t,n,r){var o=e.type,i=t.type,a=t.children;if(_p(e.childFlags,t.childFlags,e.children,a,o,n,r,!1),t.dom=e.dom,o!==i&&!nl(a)){var s=a.dom;o.removeChild(s),i.appendChild(s)}}(e,t,r,o)}}function _p(e,t,n,r,o,i,a,s){switch(e){case 2:switch(t){case 2:bp(n,r,o,i,a,s);break;case 1:ep(n,o);break;default:ep(n,o),fp(r,o,i,a,s)}break;case 1:switch(t){case 2:up(r,o,i,a,s);break;case 1:break;default:fp(r,o,i,a,s)}break;default:if(12&t){var c=n.length,u=r.length;0===c?u>0&&fp(r,o,i,a,s):0===u?rp(o,n):8===t&&8===e?function(e,t,n,r,o,i,a,s){var c,u,l,p,f=a-1,d=s-1,h=0,v=0,y=e[h],m=t[v];e:{for(;y.key===m.key;){if(m.dom&&(t[v]=m=yl(m)),bp(y,m,n,r,o,i),v++,++h>f||v>d)break e;y=e[h],m=t[v]}for(y=e[f],m=t[d];y.key===m.key;){if(m.dom&&(t[d]=m=yl(m)),bp(y,m,n,r,o,i),d--,h>--f||v>d)break e;y=e[f],m=t[d]}}if(h>f){if(v<=d)for(l=(p=d+1)<s?t[p].dom:null;v<=d;)(m=t[v]).dom&&(t[v]=m=yl(m)),v++,Sl(n,up(m,null,r,o,i),l)}else if(v>d)for(;h<=f;)ep(e[h++],n);else{var g=f-h+1,b=d-v+1,_=[];for(c=0;c<b;c++)_.push(0);var w=g===a,x=!1,C=0,E=0;if(b<=4||g*b<=16)for(c=h;c<=f;c++)if(y=e[c],E<b){for(u=v;u<=d;u++)if(m=t[u],y.key===m.key){if(_[u-v]=c+1,w)for(w=!1;c>h;)ep(e[h++],n);C>u?x=!0:C=u,m.dom&&(t[u]=m=yl(m)),bp(y,m,n,r,o,i),E++;break}!w&&u>d&&ep(y,n)}else w||ep(y,n);else{var O={};for(c=v;c<=d;c++)O[t[c].key]=c;for(c=h;c<=f;c++)if(y=e[c],E<b)if(cl(u=O[y.key])){if(w)for(w=!1;c>h;)ep(e[h++],n);m=t[u],_[u-v]=c+1,C>u?x=!0:C=u,m.dom&&(t[u]=m=yl(m)),bp(y,m,n,r,o,i),E++}else w||ep(y,n);else w||ep(y,n)}if(w)rp(n,e),fp(t,n,r,o,i);else if(x){var k=function(e){var t,n,r,o,i,a=e.slice(),s=[0],c=e.length;for(t=0;t<c;t++){var u=e[t];if(0!==u){if(n=s[s.length-1],e[n]<u){a[t]=n,s.push(t);continue}for(r=0,o=s.length-1;r<o;)e[s[i=(r+o)/2|0]]<u?r=i+1:o=i;u<e[s[r]]&&(r>0&&(a[t]=s[r-1]),s[r]=t)}}r=s.length,o=s[r-1];for(;r-- >0;)s[r]=o,o=a[o];return s}(_);for(u=k.length-1,c=b-1;c>=0;c--)0===_[c]?((m=t[C=c+v]).dom&&(t[C]=m=yl(m)),p=C+1,Sl(n,up(m,null,r,o,i),p<s?t[p].dom:null)):u<0||c!==k[u]?(m=t[C=c+v],p=C+1,Sl(n,m.dom,p<s?t[p].dom:null)):u--}else if(E!==b)for(c=b-1;c>=0;c--)0===_[c]&&((m=t[C=c+v]).dom&&(t[C]=m=yl(m)),p=C+1,Sl(n,up(m,null,r,o,i),p<s?t[p].dom:null))}}(n,r,o,i,a,s,c,u):function(e,t,n,r,o,i,a,s){for(var c,u=a>s?s:a,l=0;l<u;l++)(c=t[l]).dom&&(c=t[l]=yl(c)),bp(e[l],c,n,r,o,i);if(a<s)for(l=u;l<s;l++)(c=t[l]).dom&&(c=t[l]=yl(c)),up(c,n,r,o,i);else if(a>s)for(l=u;l<a;l++)ep(e[l],n)}(n,r,o,i,a,s,c,u)}else 1===t?rp(o,n):(rp(o,n),up(r,o,i,a,s))}}function wp(e,t,n,r,o,i,a,s,c,u){var l,p=e.state,f=e.props;if(n.children=e,!e.$UN){if(f!==r||r===Ol){if(!u&&rl(e.componentWillReceiveProps)){if(e.$BR=!0,e.componentWillReceiveProps(r,a),e.$UN)return;e.$BR=!1}e.$PSS&&(t=ul(t,e.$PS),e.$PSS=!1,e.$PS=null)}var d=rl(e.shouldComponentUpdate);if(c||!d||d&&e.shouldComponentUpdate(r,t,a)){rl(e.componentWillUpdate)&&(e.$BS=!0,e.componentWillUpdate(r,t,a),e.$BS=!1),e.props=r,e.state=t,e.context=a,rl(_l.beforeRender)&&_l.beforeRender(e),l=e.render(r,t,a),rl(_l.afterRender)&&_l.afterRender(e);var h,v=l!==Yu;if(rl(e.getChildContext)&&(h=e.getChildContext()),h=tl(h)?a:ul(a,h),e.$CX=h,v)bp(e.$LI,e.$LI=cp(l,n),o,i,h,s),rl(e.componentDidUpdate)&&e.componentDidUpdate(f,p),rl(_l.afterUpdate)&&_l.afterUpdate(n)}else e.props=r,e.state=t,e.context=a;n.dom=e.$LI.dom}}var xp=_l.roots;Ju&&document.body;function Cp(e,t,n){if(e!==Yu){var r,o,i=xp.length;for(o=0;o<i;o++)if(xp[o]===t){r=t.$V;break}return sl(r)?nl(e)||(e.dom&&(e=yl(e)),al(t.firstChild)?(up(e,t,kl,Ol,!1),t.$V=e,xp.push(t)):function(e,t,n){var r=t.firstChild;if(!al(r))for(nl(e)||mp(e,r,kl,Ol,!1),r=t.firstChild;r=r.nextSibling;)t.removeChild(r);kl.length>0&&Tl(kl),t.$V||_l.roots.push(t),t.$V=e,rl(n)&&n()}(e,t),r=e):tl(e)?(ep(r,t),xp.splice(o,1)):(e.dom&&(e=yl(e)),bp(r,e,t,kl,Ol,!1),r=t.$V=e),kl.length>0&&Tl(kl),rl(n)&&n(),r&&14&r.flags?r.children:void 0}}var Ep="undefined"==typeof Promise?null:Promise.resolve(),Op="undefined"==typeof requestAnimationFrame?setTimeout:requestAnimationFrame.bind(window);function kp(e,t,n){rl(t)&&(t=t(e.state,e.props,e.context));var r,o=e.$PS;if(tl(o))e.$PS=t;else for(var i in t)o[i]=t[i];if(e.$PSS||e.$BR)e.$PSS=!0,e.$BR&&rl(n)&&kl.push(n.bind(e));else if(e.$UPD){var a=e.$QU;al(a)&&(a=e.$QU=[],r=function(e,t){return function(){e.$QU=null,e.$UPD=!0,jp(e,!1,function(){for(var n=0,r=t.length;n<r;n++)t[n].call(e)}),e.$UPD=!1}}(e,a),Ep?Ep.then(r):Op(r)),rl(n)&&a.push(n)}else e.$PSS=!0,e.$UPD=!0,jp(e,!1,n),e.$UPD=!1}function jp(e,t,n){if(!e.$UN){if(t||!e.$BR){e.$PSS=!1;var r=e.$PS,o=ul(e.state,r),i=e.props,a=e.context;e.$PS=null;var s=e.$V,c=e.$LI;if(wp(e,o,s,i,c.dom&&c.dom.parentNode,kl,a,(32&s.flags)>0,t,!0),e.$UN)return;if(0==(1024&e.$LI.flags))for(var u=e.$LI.dom;!al(s=s.parentVNode);)(14&s.flags)>0&&(s.dom=u);kl.length>0&&Tl(kl)}else e.state=e.$PS,e.$PS=null;rl(n)&&n.call(e)}}var Sp=function(e,t){this.state=null,this.$BR=!1,this.$BS=!0,this.$PSS=!1,this.$PS=null,this.$LI=null,this.$V=null,this.$UN=!1,this.$CX=null,this.$UPD=!0,this.$QU=null,this.props=e||Ol,this.context=t||Ol};Sp.prototype.forceUpdate=function(e){this.$UN||jp(this,!0,e)},Sp.prototype.setState=function(e,t){this.$UN||this.$BS||kp(this,e,t)},Sp.prototype.render=function(e,t,n){},Sp.defaultProps=null;var Pp=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Tp=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n._injector=e.injector;return n._sheet=r.get("sheet"),n._changeSupport=r.get("changeSupport"),n._components=r.get("components"),n.onElementsChanged=n.onElementsChanged.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Pp(t,[{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"getChildContext",value:function(){return{changeSupport:this._changeSupport,components:this._components,injector:this._injector}}},{key:"componentWillMount",value:function(){var e=this._sheet.getRoot().id;this._changeSupport.onElementsChanged(e,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this._sheet.getRoot().id;this._changeSupport.offElementsChanged(e,this.onElementsChanged)}},{key:"render",value:function(){var e=this._sheet.getRoot(),t=e.rows,n=e.cols,r=this._components.getComponents("table.before"),o=this._components.getComponents("table.after"),i=this._components.getComponent("table.head"),a=this._components.getComponent("table.body"),s=this._components.getComponent("table.foot");return fl(1,"div","tjs-container",[r&&r.map(function(e,t){return dl(2,e,null,t)}),fl(1,"table","tjs-table",[i&&dl(2,i,{rows:t,cols:n}),a&&dl(2,a,{rows:t,cols:n}),s&&dl(2,s,{rows:t,cols:n})],0),o&&o.map(function(e,t){return dl(2,e,null,t)})],0)}}]),t}(),Rp=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ap=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=r.container;this._container=a,o.on("root.added",function(){Cp(dl(2,Tp,{injector:i}),a)}),o.on("root.remove",function(){Cp(null,a)})}return Rp(e,[{key:"getContainer",value:function(){return this._container}}]),e}();Ap.$inject=["changeSupport","components","config.renderer","eventBus","injector"];var Mp={__init__:["changeSupport","components","renderer"],changeSupport:["type",Hu],components:["type",Ku],renderer:["type",Ap]},Bp=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Dp=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._elementRegistry=t,this._eventBus=n,this._root=null,n.on("table.clear",function(){r.setRoot(null)})}return Bp(e,[{key:"setRoot",value:function(e){if(this._root){var t=this._root;this._eventBus.fire("root.remove",{root:t}),this._root=null,this._eventBus.fire("root.removed",{root:t})}e&&this._eventBus.fire("root.add",{root:e}),this._root=e,e&&this._eventBus.fire("root.added",{root:e})}},{key:"getRoot",value:function(){return this._root||this.setRoot({id:"__implicitroot",rows:[],cols:[]}),this._root}},{key:"addRow",value:function(e,t){var n=this,r=this.getRoot();if(r.cols.length!=e.cells.length)throw new Error("number of cells is not equal to number of cols");return void 0===t&&(t=r.rows.length),Ip(t,r.rows,e),e.root=r,this._elementRegistry.add(e),e.cells.forEach(function(o,i){n._elementRegistry.add(o),o.row=e,o.col=r.cols[i],Ip(t,r.cols[i].cells,o)}),this._eventBus.fire("row.add",{row:e}),e}},{key:"removeRow",value:function(e){var t=this,n=this.getRoot();"string"==typeof e&&(e=this._elementRegistry.get(e));var r=n.rows.indexOf(e);-1!==r&&(Np(r,n.rows),e.root=void 0,this._elementRegistry.remove(e),e.cells.forEach(function(e,o){t._elementRegistry.remove(e),e.col=void 0,Np(r,n.cols[o].cells)}),this._eventBus.fire("row.remove",{row:e}))}},{key:"addCol",value:function(e,t){var n=this,r=this.getRoot();if(this._elementRegistry.add(e),r.rows.length!=e.cells.length)throw new Error("number of cells is not equal to number of rows");return void 0===t&&(t=r.cols.length),Ip(t,r.cols,e),e.root=r,e.cells.forEach(function(o,i){n._elementRegistry.add(o),o.col=e,o.row=r.rows[i],Ip(t,r.rows[i].cells,o)}),this._eventBus.fire("col.add",{col:e}),e}},{key:"removeCol",value:function(e){var t=this,n=this.getRoot();"string"==typeof e&&(e=this._elementRegistry.get(e));var r=n.cols.indexOf(e);-1!==r&&(Np(r,n.cols),e.root=void 0,this._elementRegistry.remove(e),e.cells.forEach(function(e,o){t._elementRegistry.remove(e),e.row=void 0,Np(r,n.rows[o].cells)}),this._eventBus.fire("col.remove",{col:e}))}},{key:"resized",value:function(){this._eventBus.fire("sheet.resized")}}]),e}();function Ip(e,t,n){return t.splice(e,0,n)}function Np(e,t){return t.splice(e,1)}Dp.$inject=["elementRegistry","eventBus"];var Vp={__depends__:[Mp],__init__:["elementFactory","sheet"],elementFactory:["type",Fu],elementRegistry:["type",zu],eventBus:["type",A],sheet:["type",Dp]},Lp=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var $p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.injector;if(!n){var r=this._init(t),o=r.modules;n=function(e,t){return function(e){var t=[],n=[];function r(e){return t.indexOf(e)>=0}e.forEach(function e(o){if(r(o))return;(o.__depends__||[]).forEach(e);if(r(o))return;!function(e){t.push(e)}(o);(o.__init__||[]).forEach(function(e){n.push(e)})});var o=new nn(t);return n.forEach(function(e){try{o["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),o}([{config:["value",e]},Vp].concat(t||[]))}(r.config,o)}this.get=n.get,this.invoke=n.invoke,this.get("eventBus").fire("table.init"),this.get("eventBus").fire("diagram.init")}return Lp(e,[{key:"_init",value:function(e){return{modules:e.modules,config:function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["modules"])}}},{key:"destroy",value:function(){var e=this.get("eventBus");e.fire("table.destroy"),e.fire("diagram.destroy")}},{key:"clear",value:function(){var e=this.get("eventBus");e.fire("table.clear"),e.fire("diagram.clear")}}]),e}();function Fp(e){if(!e)return"<null>";var t=e.id?' id="'+e.id+'"':"";return"<"+e.$type+t+" />"}function Up(e,t){function n(t,n,r){if(t.gfx)throw new Error("already rendered "+Fp(t));return e.element(t,n,r)}function r(e,t,r){p(e,function(e){n(e,t,r)})}function o(e,t,r){p(e,function(e){n(e,t,r)})}return{handleDecision:function(t){t.id||(t.id="decision");var i=t.decisionTable;if(!i)throw new Error("no table for "+Fp(t));if(!i.output)throw new Error("missing output for "+Fp(i));var a,s,c,u,l=(u=i,e.table(u));i.input&&r(i.input,l,i),r(i.output,l,i),a=i.rule,s=l,c=i,p(a,function(e){n(e,s,c),o(e.inputEntry,e),o(e.outputEntry,e)})}}}function zp(){return fl(1,"th","annotation header",hl("Annotation"),2,{rowspan:"3"})}var Wp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function Hp(e,t){var n,r,o,i=e.elements,a=e.index;return a[t]?e:{elements:[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(i),[t]),index:Gp({},a,(n={},r=t,o=!0,r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n))}}function qp(){for(var e={elements:[],index:{}},t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){var n=void 0===t?"undefined":Wp(t);"string"===n&&t.length>0?e=Hp(e,t):"object"===n&&null!==t&&Object.keys(t).forEach(function(n){t[n]&&(e=Hp(e,n))})}),function(e,t){return e.elements.join(t)}(e," ")}function Kp(e){return Xp(e.constructor,e)}function Xp(e,t){var n=e.$inject;if(n){var r=t.context.injector,o=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n),[function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];for(var i in r){var a=n[i],s=r[i];t[a]=s}}]);r.invoke(o)}}function Yp(e,t){Object.keys(t).forEach(function(n){if("$inject"!==n&&"__init"!==n){var r=t[n];"constructor"===n&&r.call(e,e.props,e.context);var o=e[n];if(void 0!==o){if("function"!=typeof o)throw new Error("failed to mixin <"+n+">: cannot combine with non-fn component value");e[n]=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=void 0;return n.forEach(function(t){if(void 0!==(i=t.call.apply(t,[e].concat(r))))return!1}),i}.bind(e)}(e,o,r)}else e[n]=r.bind(e)}}),"$inject"in t&&Xp(t,e),"__init"in t&&t.__init.call(e,e.props,e.context)}var Zp={getSelectionClasses:function(){var e=this.state;return qp({selected:e.selected,"selected-secondary":e.selectedSecondary,focussed:e.focussed})},selectionChanged:function(e){this.setState(e)},componentWillUpdate:function(e){e.elementId!==this.props.elementId&&this.updateSelectionSubscription(!1)},componentDidUpdate:function(e){e.elementId!==this.props.elementId&&this.updateSelectionSubscription(!0)},componentDidMount:function(){this.updateSelectionSubscription(!0)},componentWillUnmount:function(){this.updateSelectionSubscription(!1)},updateSelectionSubscription:function(e){var t=this.props.elementId;t&&t&&this.eventBus[e?"on":"off"]("selection."+t+".changed",this.selectionChanged)},$inject:["eventBus"]},Jp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qp=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ef=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Yp(r,Zp),Kp(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Qp(t,[{key:"getRenderProps",value:function(){for(var e=this.props,t=e.className,n=e.elementId,r=e.coords,o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["className","elementId","coords"]),i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];var c={className:qp.apply(void 0,a.concat([this.getSelectionClasses(),t]))};return n&&(c["data-element-id"]=n),r&&(c["data-coords"]=r),Jp({},c,o)}}]),t}(),tf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var rf=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,ef),nf(t,[{key:"render",value:function(){var e=this.props.children,t=this.getRenderProps("cell");return vl(fl(1,"td",null,e,0,tf({},t)))}}]),t}(),of=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(t,Sp),of(t,[{key:"getChildContext",value:function(){return{injector:this.props.injector}}},{key:"render",value:function(){return this.props.children}}])}();var af=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={},r}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(t,ef),sf(t,[{key:"render",value:function(){var e=this.props.children,t=this.getRenderProps("cell","header-cell");return vl(fl(1,"th",null,e,0,af({},t)))}}])}();function cf(e){var t=e.row.businessObject,n=t.id,r=t.description;return dl(2,rf,{className:"annotation",elementId:n+"__annotation",children:r||"-"})}function uf(e){e.onGetComponent("cell",function(e){var t=e.cellType;return"after-label-cells"===t?zp:"after-rule-cells"===t?cf:void 0})}uf.$inject=["components"];var lf={__init__:["annotationsProvider"],annotationsProvider:["type",uf]},pf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function ff(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function df(e,t){return S({id:e.id,type:e.$type,businessObject:e},t)}var hf=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._elementFactory=t,this._eventBus=n,this._sheet=r}return pf(e,[{key:"add",value:function(e){var t=this,n=void 0;if(Nt(e,"dmn:DecisionTable"))n=this._elementFactory.createRoot(df(e)),this._sheet.setRoot(n);else if(Nt(e,"dmn:InputClause"))n=this._elementFactory.createCol(df(e)),this._sheet.addCol(n);else if(Nt(e,"dmn:OutputClause"))n=this._elementFactory.createCol(df(e)),this._sheet.addCol(n);else if(Nt(e,"dmn:DecisionRule")){e.inputEntry||(e.inputEntry=[]),e.outputEntry||(e.outputEntry=[]);var r=[].concat(ff(e.inputEntry),ff(e.outputEntry)).map(function(e){return t._elementFactory.createCell(df(e))});n=this._elementFactory.createRow(S(df(e),{cells:r})),this._sheet.addRow(n)}return this._eventBus.fire("dmnElement.added",{element:n}),n}}]),e}();hf.$inject=["elementFactory","eventBus","sheet"];var vf={__depends__:[{tableImporter:["type",hf]},Mp]},yf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function mf(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var gf={slotFill:function(e,t){var n=e.type,r=e.context,o=mf(e,["type","context"]),i=this.components.getComponent(n,r)||t;return i?vl(dl(2,i,yf({},r,o))):null},slotFills:function(e){var t=e.type,n=e.context,r=mf(e,["type","context"]);return this.components.getComponents(t,n).map(function(e){return vl(dl(2,e,yf({},n,r)))})},$inject:["components"]},bf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wf(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function xf(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Cf=function(e){function t(e,n){_f(this,t);var r=wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onElementsChanged=function(){r.forceUpdate()},Yp(r,gf),r._sheet=n.injector.get("sheet"),r._changeSupport=n.changeSupport,r}return xf(t,Sp),bf(t,[{key:"componentWillMount",value:function(){var e=this._sheet.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmout",value:function(){var e=this._sheet.getRoot();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(e){var t=this,n=this._sheet.getRoot();if(!Nt(n,"dmn:DMNElement"))return null;var r=$t(n),o=r.input,i=r.output;return fl(1,"thead",null,[fl(1,"tr",null,[this.slotFills({type:"cell",context:{cellType:"before-label-cells"}}),this.slotFill({type:"cell",context:{cellType:"input-label"}},Of),this.slotFill({type:"cell",context:{cellType:"output-label"}},jf),this.slotFills({type:"cell",context:{cellType:"after-label-cells"}})],0),fl(1,"tr",null,[o&&o.map(function(e){return t.slotFill({type:"cell",context:{cellType:"input-header",input:e},key:e.id},Ef)}),i.map(function(e){return t.slotFill({type:"cell",context:{cellType:"output-header",output:e},key:e.id},kf)})],0),fl(1,"tr",null,[o&&o.map(function(e,n){var r=e.inputExpression;return t.slotFill({type:"cell",context:{cellType:"input-header-type-ref",element:r},className:"input-cell",key:e.id},Sf)}),i.map(function(e){return t.slotFill({type:"cell",context:{cellType:"output-header-type-ref",element:e},className:"output-cell",key:e.id},Sf)})],0)],4)}}]),t}();function Ef(e){var t=e.input,n=e.className,r=t.label,o=t.inputExpression;return fl(1,"th",(n||"")+" input-cell",r?fl(1,"span","input-label",r,0,{title:"Input Label"}):fl(1,"span","input-expression",o.text||"-",0,{title:"Input Expression"}),0,null,t.id)}var Of=function(e){function t(e,n){_f(this,t);var r=wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._sheet=n.injector.get("sheet"),r}return xf(t,Sp),bf(t,[{key:"render",value:function(){var e=this._sheet.getRoot().businessObject,t=e.input;if(!t||!t.length)return null;var n=e.input.length;return fl(1,"th","input-cell inputs-label header",hl("Input"),2,{colspan:n})}}]),t}();function kf(e){var t=e.output,n=e.className,r=t.label,o=t.name;return fl(1,"th",(n||"")+" output-cell",r?fl(1,"span","output-label",r,0,{title:"Output Label"}):fl(1,"span","output-name",o||"-",0,{title:"Output Name"}),0,null,t.id)}var jf=function(e){function t(e,n){_f(this,t);var r=wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._sheet=n.injector.get("sheet"),r}return xf(t,Sp),bf(t,[{key:"render",value:function(){var e=this._sheet.getRoot().businessObject.output.length;return fl(1,"th","output-cell outputs-label header",hl("Output"),2,{colspan:e})}}]),t}();function Sf(e){return fl(1,"th",e.className+" type-ref",e.element.typeRef,0,{title:"Data Type"})}function Pf(e){e.onGetComponent("table.head",function(){return Cf})}Pf.$inject=["components"];var Tf={__init__:["decisionTableHeadProvider"],decisionTableHeadProvider:["type",Pf]},Rf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Af=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Rf(t,[{key:"componentWillMount",value:function(){var e=this.context.injector;this._sheet=e.get("sheet")}},{key:"render",value:function(){var e=this._sheet.getRoot();if(!Nt(e,"dmn:DMNElement"))return null;var t=e.businessObject.$parent,n=t.id;return fl(1,"header","decision-table-properties",[fl(1,"h3","decision-table-name",t.name,0,{title:"Decision Name"}),fl(1,"h5","decision-table-id",n,0,{title:"Decision Id"})],4)}}]),t}();var Mf=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("table.before",function(){return Af})};Mf.$inject=["components"];var Bf={__init__:["decisionTableProperties"],decisionTableProperties:["type",Mf]},Df=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var If=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Df(t,[{key:"render",value:function(){var e=this.props,t=e.row,n=e.rowIndex,r=this.context.components.getComponents("cell-inner",{cellType:"rule-index",row:t,rowIndex:n});return fl(1,"td","rule-index",[r&&r.map(function(e){return dl(2,e,{row:t,rowIndex:n})}),n+1],0,{"data-row-id":t.id})}}]),t}();var Nf=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("cell",function(e){if("before-rule-cells"===e.cellType)return If})};Nf.$inject=["components"];var Vf={__init__:["decisionRuleIndices"],decisionRuleIndices:["type",Nf]},Lf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var $f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Lf(t,[{key:"render",value:function(e){var t=e.rows,n=e.cols,r=this.context.components;return fl(1,"tbody",null,t.map(function(e,t){var o=r.getComponent("row",{rowType:"rule"});return o&&dl(2,o,{row:e,rowIndex:t,cols:n},e.id)}),0)}}]),t}(),Ff=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Uf=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Yp(r,gf),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Ff(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.row,r=t.rowIndex,o=t.cols,i=n.cells;return fl(1,"tr",null,[this.slotFills({type:"cell",context:{cellType:"before-rule-cells",row:n,rowIndex:r}}),i.map(function(t,i){return e.slotFill({type:"cell",context:{cellType:"rule",cell:t,rowIndex:r,colIndex:i},key:t.id,row:n,col:o[i]})}),this.slotFills({type:"cell",context:{cellType:"after-rule-cells",row:n,rowIndex:r}})],0)}}]),t}(),zf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Wf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),zf(t,[{key:"render",value:function(){var e=this.props.cell;return Nt(e,"dmn:UnaryTests")?dl(2,rf,{className:"input-cell",elementId:e.id,children:e.businessObject.text}):dl(2,rf,{className:"output-cell",elementId:e.id,children:e.businessObject.text})}}]),t}();var Gf=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("table.body",function(){return $f}),t.onGetComponent("row",function(e){if("rule"===e.rowType)return Uf}),t.onGetComponent("cell",function(e){if("rule"===e.cellType)return Wf})};Gf.$inject=["components"];var Hf={__init__:["decisionRules"],decisionRules:["type",Gf]},qf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Kf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),qf(t,[{key:"componentWillMount",value:function(){var e=this.context.injector;this._sheet=e.get("sheet")}},{key:"render",value:function(){var e=this._sheet.getRoot().businessObject,t=e.hitPolicy;return fl(1,"th","hit-policy header",[t.charAt(0),function(e){switch(e){case"SUM":return"+";case"MIN":return"<";case"MAX":return">";case"COUNT":return"#";default:return""}}(e.aggregation)],0,{rowspan:"3",title:"Hit Policy = "+t})}}]),t}();function Xf(e){e.onGetComponent("cell",function(e){if("before-label-cells"===e.cellType)return Kf})}Xf.$inject=["components"];var Yf={__init__:["hitPolicyProvider"],hitPolicyProvider:["type",Xf]},Zf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Jf=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.onClick=function(){r._eventBus.fire("showDrd")};var o=n.injector;return r._eventBus=o.get("eventBus"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Zf(t,[{key:"render",value:function(){var e=this;return fl(1,"div","view-drd",fl(1,"button","view-drd-button",hl("View DRD"),2,{onClick:this.onClick}),2,null,null,function(t){return e.node=t})}}]),t}(),Qf=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ed=function(){function e(t,n,r,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._injector=r,this._sheet=o,t.onGetComponent("table.before",function(){if(i.canViewDrd())return Jf}),n.on("showDrd",function(){var e=r.get("_parent",!1),t=td(o.getRoot());if(t){var n=e.getView(t);e.open(n)}})}return Qf(e,[{key:"canViewDrd",value:function(){var e=this._injector.get("_parent",!1);if(!e)return!1;var t=td(this._sheet.getRoot());return!!e.getView(t)}}]),e}();function td(e){var t=e.businessObject;if(t)return t.$parent.$parent}ed.$inject=["components","eventBus","injector","sheet"];var nd={__init__:["viewDrd"],viewDrd:["type",ed]},rd=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var od=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.onClick=function(){r._eventBus.fire("poweredBy.show")};var o=n.injector;return r._eventBus=o.get("eventBus"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),rd(t,[{key:"render",value:function(){var e=this;return fl(1,"div","powered-by-logo",fl(1,"img","logo",null,1,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC"}),2,{onClick:this.onClick,title:"Powered by bpmn.io"},null,function(t){return e.node=t})}}]),t}(),id=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ad=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1},n.onClick=n.onClick.bind(n),n.onShow=n.onShow.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),id(t,[{key:"onClick",value:function(){this.setState({show:!1})}},{key:"onShow",value:function(){this.setState({show:!0})}},{key:"componentWillMount",value:function(){(this._eventBus=this.context.injector.get("eventBus")).on("poweredBy.show",this.onShow)}},{key:"componentWillUnmount",value:function(){this._eventBus.off("poweredBy.show",this.onShow)}},{key:"render",value:function(){return this.state.show&&fl(1,"div","powered-by-overlay",fl(1,"div","powered-by-overlay-content",[fl(1,"div",null,fl(1,"img","logo",null,1,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC"}),2),fl(1,"div",null,[hl("Web-based tooling for BPMN, DMN and CMMN diagrams powered by "),fl(1,"a",null,hl("bpmn.io"),2,{href:"http://bpmn.io",target:"_blank"}),hl(".")],4)],4,{onClick:function(e){return e.stopPropagation()}}),2,{onClick:this.onClick})}}]),t}();var sd=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("table.before",function(){return od}),t.onGetComponent("table.before",function(){return ad})};sd.$inject=["components","eventBus"];var cd={__init__:["poweredBy"],poweredBy:["type",sd]},ud=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function ld(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var pd=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=t._createContainer(),r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,S(e,{renderer:{container:n}})));return r._container=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,$p),ud(t,[{key:"open",value:function(e,t){var n;try{return this._decision&&this.clear(),this._decision=e,function(e,t,n){var r=e.get("tableImporter"),o=e.get("eventBus"),i=e.get("sheet"),a=e.get("modeling",!1),s=void 0,c=[];o.fire("import.render.start",{decision:t});try{!function(e){new Up({create:function(e,t,n,o){return r.create(e,t,n,o)},table:function(e){return r.add(e)},element:function(e,t,n){return r.add(e,t,n)},error:function(e,t){c.push({message:e,context:t})}},{canAddMissingEntries:a}).handleDecision(e)}(t)}catch(e){s=e}o.fire("import.render.complete",{error:s,warnings:c}),o.fire("elements.changed",{elements:[i.getRoot()]}),n(s,c)}(this,e,t)}catch(e){n=e}return t(n)}},{key:"_init",value:function(e){var t=e.modules,n=e.additionalModules,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["modules","additionalModules"]),o=t||this.getModules(),i=n||[],a=[{decisionTable:["value",this]}];return{modules:[cd].concat(ld(o),ld(i),a),config:r}}},{key:"on",value:function(e,t,n,r){return this.get("eventBus").on(e,t,n,r)}},{key:"off",value:function(e,t){this.get("eventBus").off(e,t)}},{key:"_emit",value:function(e,t){return this.get("eventBus").fire(e,t)}},{key:"attachTo",value:function(e){if(!e)throw new Error("parentNode required");this.detach();var t=this._container;e.appendChild(t),this._emit("attach",{})}},{key:"detach",value:function(){var e=this._container;e.parentNode&&(this._emit("detach",{}),xt(e))}},{key:"destroy",value:function(){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.detach()}},{key:"getModules",value:function(){return t._getModules()}}],[{key:"_getModules",value:function(){return[lf,vf,Tf,Bf,Vf,Hf,Yf,nd]}},{key:"_createContainer",value:function(){return ht('<div class="dmn-decision-table-container"></div>')}}]),t}(),fd=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var dd=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.handleClick=function(e){e.stopPropagation(),r.addRule()},Kp(r),r.addRule=r.addRule.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),fd(t,[{key:"componentWillMount",value:function(){this._eventBus=this.context.injector.get("eventBus")}},{key:"addRule",value:function(){this._eventBus.fire("addRule")}},{key:"render",value:function(){var e=this.props.cols,t=[fl(1,"td","add-rule-add",fl(1,"span","dmn-icon-plus action-icon",null,1,{title:"Add Rule"}),2)],n=this.sheet.getRoot().businessObject;n.input&&n.input.length||t.push(fl(1,"td","input-cell",hl("-"),2));for(var r=0;r<e.length+1;r++){var o="add-rule",i=e[r]&&e[r].businessObject;i&&(i.$instanceOf("dmn:InputClause")&&(o+=" input-cell"),i.$instanceOf("dmn:OutputClause")&&(o+=" output-cell")),t.push(fl(1,"td",o,hl("-"),2))}return fl(1,"tfoot","actionable add-rule",fl(1,"tr",null,t,0),2,{onClick:this.handleClick})}}]),t}();dd.$inject=["sheet"];var hd=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("table.foot",function(){return dd}),r.on("addRule",function(){n.trigger("addRule")})};hd.$inject=["components","editorActions","eventBus"];var vd=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var yd=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._elementRegistry=t,this._eventBus=n,this._renderer=r,this._selection=void 0,n.on("diagram.clear",function(){o._selection=void 0})}return vd(e,[{key:"select",value:function(e){s(e)&&(e=this._elementRegistry.get(e));var t=this._selection;t!==e&&(this._selection=e,this._eventBus.fire("selection.changed",{oldSelection:t,selection:e}))}},{key:"deselect",value:function(){var e=this._selection;this._selection=void 0,this._eventBus.fire("selection.changed",{oldSelection:e,selection:this._selection})}},{key:"get",value:function(){return this._selection}},{key:"hasSelection",value:function(){return!!this._selection}}]),e}();yd.$inject=["elementRegistry","eventBus","renderer"];var md=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._elementRegistry=t,this._renderer=r,this._selection=o,n.on(["cell.click","cell.contextmenu"],function(e){var n=e.id,r=t.get(n);r&&o.select(r)}),n.on("row.remove",function(e){var t=e.row,n=o.get();n&&t===n.row&&o.deselect()}),n.on("col.remove",function(e){var t=e.col,n=o.get();n&&t===n.col&&o.deselect()})};md.$inject=["elementRegistry","eventBus","renderer","selection"];var gd={__init__:["selection","selectionBehavior"],selection:["type",yd],selectionBehavior:["type",md]},bd=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var _d=["click","dblclick","contextmenu","mousedown","mouseup","mouseenter","mouseleave","mouseout","mouseover","mousemove","focusin","focusout","drag","dragstart","dragend","dragover","dragenter","dragleave","drop"],wd=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._handleEvent=function(e){var t=e.target,n=e.type,o=st(t,"[data-element-id]",!0);if(o){var i=o.getAttribute("data-element-id");if(i){var a=r._eventBus.createEvent({id:i,event:e,node:o,target:o});r._eventBus.fire("cell."+n,a),a.defaultPrevented&&e.preventDefault(),a.cancelBubble&&e.stopPropagation()}}},this._eventBus=n,this._container=t.container,n.on("table.init",function(){r._addEventListeners(_d)}),n.on("table.destroy",function(){r._removeEventListeners(_d)})}return bd(e,[{key:"_addEventListeners",value:function(e){var t=this,n=this._container;e.forEach(function(e){n.addEventListener(e,t._handleEvent)})}},{key:"_removeEventListeners",value:function(e){var t=this,n=this._container;e.forEach(function(e){n.removeEventListener(e,t._handleEvent)})}}]),e}();wd.$inject=["config.renderer","eventBus"];var xd={__init__:["interactionEvents"],interactionEvents:["type",wd]},Cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed=function(e,t){return e^t};var Od=/\b(Array|Date|Object|Math|JSON)\b/g,kd=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length;n++)~t.indexOf(e[n])||t.push(e[n]);return t}(function(e){return e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(Od,"").match(/[a-zA-Z_]\w*/g)||[]}(e));return t&&"string"==typeof t&&(t=function(e){return function(t){return e+t}}(t)),t?function(e,t,n){return e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g,function(e){return"("==e[e.length-1]?n(e):~t.indexOf(e)?n(e):e})}(e,n,t):n};var jd=Sd;function Sd(e,t){if(!(this instanceof Sd))return new Sd(e,t);if(this.node=this.start=this.peeked=e,this.root=t,this.closingTag=!1,this._revisit=!0,this._selects=[],this._rejects=[],e&&this.higher(e))throw new Error("root must be a parent or ancestor to node")}function Pd(e,t){var n="nextSibling"==e;return function(r,o,i){r=this.compile(r),o=o&&o>0?o:1;for(var a=this.node,s=this.closingTag,c=this._revisit;a;){if(Ed(n,s)&&a[t])a=a[t],s=!n;else if(1==a.nodeType&&!a[t]&&Ed(n,s)){if(s=n,!c)continue}else if(a[e])a=a[e],s=!n;else if(a=a.parentNode,s=n,!c)continue;if(!a||this.higher(a,this.root))break;if(r(a)&&this.selects(a,i)&&this.rejects(a,i)){if(--o)continue;return i||(this.node=a),this.closingTag=s,a}}return null}}Sd.prototype.reset=function(e){return this.node=e||this.start,this},Sd.prototype.revisit=function(e){return this._revisit=void 0==e||e,this},Sd.prototype.opening=function(){return 1==this.node.nodeType&&(this.closingTag=!1),this},Sd.prototype.atOpening=function(){return!this.closingTag},Sd.prototype.closing=function(){return 1==this.node.nodeType&&(this.closingTag=!0),this},Sd.prototype.atClosing=function(){return this.closingTag},Sd.prototype.next=Pd("nextSibling","firstChild"),Sd.prototype.previous=Sd.prototype.prev=Pd("previousSibling","lastChild"),Sd.prototype.select=function(e){return e=this.compile(e),this._selects.push(e),this},Sd.prototype.selects=function(e,t){var n=this._selects,r=n.length;if(!r)return!0;for(var o=0;o<r;o++)if(n[o].call(this,e,t))return!0;return!1},Sd.prototype.reject=function(e){return e=this.compile(e),this._rejects.push(e),this},Sd.prototype.rejects=function(e,t){var n=this._rejects,r=n.length;if(!r)return!0;for(var o=0;o<r;o++)if(n[o].call(this,e,t))return!1;return!0},Sd.prototype.higher=function(e){var t=this.root;if(!t)return!1;for(e=e.parentNode;e&&e!=t;)e=e.parentNode;return e!=t},Sd.prototype.compile=function(e){switch(void 0===e?"undefined":Cd(e)){case"number":return function(t){return e==t.nodeType};case"string":return new Function("node","return "+kd(e,"node."));case"function":return e;default:return function(){return!0}}},Sd.prototype.peak=Sd.prototype.peek=function(e,t){return 1==arguments.length&&(t=e,e=!0),(t=void 0==t?1:t)?t>0?this.next(e,t,!0):this.prev(e,Math.abs(t),!0):this.node},Sd.prototype.use=function(e){return e(this),this};var Td=window.getSelection();function Rd(e){Td.removeAllRanges(),Td.addRange(e)}function Ad(){return Td}function Md(e,t){Rd(function(e,t){var n,r=t.start,o=t.end,i=document.createRange(),a=jd(e.firstChild,e),s=a.node,c=!1,u=0;for(;s;){if(u===r&&(c?i.setStartAfter(s):i.setStartBefore(s)),u===o)return c?i.setEndAfter(s):i.setEndBefore(s),i;if(c||(Id(s)||s.previousSibling&&(Nd(s)||Vd(s)))&&u++,Dd(s)){if(n=s.textContent.length,u<=r&&u+n>r&&i.setStart(s,r-u),u+n>o)return i.setEnd(s,o-u),i;u+=n}s=a.next(),c=a.closingTag}u<=r&&(e.lastChild?i.setStartAfter(e.lastChild):i.setStart(e,0));e.lastChild?i.setEndAfter(e.lastChild):i.setEnd(e,0);return i}(e,t))}function Bd(e){if(!function(e){if(!Td.rangeCount)return null;var t=Td.focusNode;return Dd(t)&&(t=t.parentNode),e==t||e.contains(t)}(e))return null;var t,n,r=Td.getRangeAt(0),o=r.startContainer,i=r.endContainer,a=r.startOffset,s=r.endOffset,c=jd(e.firstChild,e),u=c.node,l=!1,p=0;function f(e,t){return 1===arguments.length&&(t=e),e.parentNode===i&&t==i.childNodes[s]}function d(e,t){return 1===arguments.length&&(t=e),e.parentNode===o&&t==o.childNodes[a]}for(;u&&(d(u)&&(n=p),!f(u));){if(l||(Id(u)||t&&t.nextSibling==u&&(Nd(u)||Vd(u)))&&p++,Dd(u)){if(o===u&&(n=p+a),i===u){p+=s;break}p+=u.textContent.length}if((Dd(u)||l)&&(d(u,u.nextSibling)&&(n=p),f(u,u.nextSibling)))break;t=u,u=c.next(),l=c.closingTag}return{start:void 0===n?p:n,end:p}}function Dd(e){return 3===e.nodeType}function Id(e){return 1===e.nodeType&&"BR"===e.nodeName}function Nd(e){return 1===e.nodeType&&"DIV"===e.nodeName}function Vd(e){return 1===e.nodeType&&"P"===e.nodeName}var Ld=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$d="[contenteditable]",Fd="[data-element-id]";function Ud(e){return e.getAttribute("data-element-id")}function zd(e,t){return _t('[data-element-id="'+Ui(e)+'"]',t)}function Wd(e){return st(e,Fd,!0)}function Gd(e){var t=$d;return bt(e,t)?e:_t(t,e)}var Hd=500,qd={above:!0,below:!0,right:!0,left:!0};function Kd(e,t,n,r,o){var i=e.container,a=null;function s(e,n){t.fire("selection."+e+".changed",n),t.fire("cellSelection.changed",{elementId:e,selection:n})}function c(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a!==e&&s(a,{selected:!1,focussed:!1}),a=e,e&&s(e,{selected:!0,focussed:t}),e?r.select(e):r.deselect()}t.on("cell.click",Hd,function(e){var t=e.target;if(!st(t,".no-deselect",!0)){var n=Wd(t);c(n&&Ud(n),!e.defaultPrevented),e.stopPropagation()}}),t.on("cell.focusin",Hd,function(e){var t=Ud(e.target),n=!e.defaultPrevented;return e.stopPropagation(),c(t,n)}),t.on("cell.focusout",Hd,function(e){s(Ud(e.target),{focussed:!1})}),t.on("cellSelection.changed",function(e){var t=e.elementId,n=e.selection,r=zd(t,i);n.focussed&&r&&function(e){var t=Gd(e);if(t&&document.body.contains(t)&&document.activeElement!==t){t.focus();var n=Bd(t);n&&0!==n.end||Md(t,{start:5e3,end:5e3})}}(r)}),t.on("selection.changed",function(e){var t=e.selection,n=e.oldSelection,r=t&&t.id,o=n&&n.id;r&&r!==a?c(t.id):o&&o===a&&c()}),this.isCellSelected=function(){return!!a},this.getCellSelection=function(){return a},this.selectCell=function(e){if(a){if(!(e in qd))throw new Error("direction must be any of { above, below, left, right }");var t=function(e){var t=e.getAttribute("data-coords");if(!t)return null;var n=t.split(":"),r=Ld(n,2);return{row:r[0],col:r[1]}}(zd(a,i));if(!t)return!1;var n=function(e,t){var n=e.row+":"+e.col;return _t('[data-coords="'+Ui(n)+'"]',t)}(function(e,t){var n=e.row,r=e.col;if("above"===t||"below"===t){var o=parseInt(n,10);if(isNaN(o))return e;var i="above"===t?o-1:o+1;return{col:r,row:i}}if("left"===t||"right"===t){var a=parseInt(r,10);if(isNaN(a))return e;var s="left"===t?a-1:a+1;return{row:n,col:s}}throw new Error("invalid direction <"+t+">")}(t,e),i);if(!n)return!1;var r=Ud(n);return r&&c(r,{focussed:!0,selected:!0}),!0}},t.on("contextMenu.close",function(){if(a)return c(a)})}Kd.$inject=["config.renderer","eventBus","sheet","selection","elementRegistry"];var Xd={__depends__:[xd,gd],__init__:["cellSelection"],cellSelection:["type",Kd]},Yd=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Zd=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._sheet=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,mc),Yd(t,[{key:"init",value:function(){var e=this;this.addRule("col.move",2e3,function(t){var n=t.col,r=t.index,o=e._sheet.getRoot().businessObject.input;return Vt(n)?r<o.length:r>=o.length}),this.addRule("col.remove",2e3,function(t){var n=t.col,r=e._sheet.getRoot().cols;return!Lt(n)||r.filter(function(e){return Lt(e)}).length>1}),this.addRule("paste",2e3,function(t){var n=t.data,r=t.target;if(!n||!r)return!1;var o=n.root;return r instanceof Du?e.canPasteRows(o):r instanceof Iu&&e.canPasteCols(o,r)})}},{key:"canPasteRows",value:function(e){var t=this._sheet.getRoot().cols;return d(e,function(e){return"row"===e.type&&(e.cells.length===t.length&&d(e.cells,function(e,n){return Vt(t[n])?"dmn:UnaryTests"===e.businessObject.$type:"dmn:LiteralExpression"===e.businessObject.$type}))})}},{key:"canPasteCols",value:function(e,t){var n=this._sheet.getRoot().rows;return d(e,function(e){return"col"===e.type&&(e.cells.length===n.length&&(Vt(t)?"dmn:InputClause"===e.businessObject.$type:"dmn:OutputClause"===e.businessObject.$type))})}}]),t}();Zd.$inject=["eventBus","sheet"];var Jd={__depends__:[{__depends__:[li]}],__init__:["decisionTableModelingRules"],decisionTableModelingRules:["type",Zd]},Qd=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var eh=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._clipboard=t,this._modeling=n,this._sheet=r}return Qd(e,[{key:"execute",value:function(e){var t=e.data;return e.oldData=this._clipboard.get(),this._clipboard.set(t),this._sheet.getRoot()}},{key:"postExecute",value:function(e){var t=this;e.elements.forEach(function(e){e instanceof Du?t._modeling.removeRow(e):e instanceof Iu&&t._modeling.removeCol(e)})}},{key:"revert",value:function(e){var t=e.oldData;return this._clipboard.set(t),this._sheet.getRoot()}}]),e}();eh.$inject=["clipboard","modeling","sheet"];var th=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function nh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rh(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var oh=[function(e,t,n,r){var o=n,i=th({},t,{type:function(e){if(e instanceof Du)return"row";if(e instanceof Iu)return"col";if(e instanceof Nu)return"cell";throw new Error("cannot deduce element type: #"+e.id)}(e)});if(e instanceof Du||e instanceof Iu){var a=r(e.cells,o);i.cells=a.root,o=a.descriptorCache}return{root:i,descriptorCache:o}},function(e,t,n){var o=e.businessObject;if(!o)return{root:t,descriptorCache:n};var i=function e(t,n){var o,i;var a=t.id;if(a&&(o=n.boCache||{},i=o[a]))return{root:i,descriptorCache:n};var s={$type:t.$type};a&&(s.id=a,o=th({},o,nh({},a,s)),n=th({},n,{boCache:o}));t.$descriptor.properties.forEach(function(o){var i=t[o.name];if(i){if(r(i)&&(i=i.map(function(t){var r=e(t,n);return n=r.descriptorCache,r.root})),i.$type){var a=e(i,n);n=a.descriptorCache,i=a.root}s[o.name]=i}});return{root:s,descriptorCache:n}}(o,n);return{root:th({},t,{businessObject:i.root}),descriptorCache:i.descriptorCache}}],ih=[function(e,t,n){var o=e.root.businessObject;if(!o)return{root:t,reviveCache:n};var i=function e(t,n){var o=t.root;var i=o.id;var a=void 0,s=void 0;if(i&&(a=n.boCache||{},s=a[i]))return{root:s,reviveCache:n};var c={};y(o).forEach(function(t){var i=void 0,s=void 0;o[t].$type?(s=e({root:o[t]},n),i=s.root,n=s.reviveCache,a=n.boCache||{}):i=r(o[t])?o[t].map(function(t){return s=e({root:t},n),n=s.reviveCache,a=n.boCache||{},s.root}):o[t],c[t]=i});var u=c.$type;delete c.$type;n._keepIds&&!n._model.ids.assigned(c.id)||delete c.id;var l=n._dmnFactory.create(u,c);p(c,function(e){e.$type&&(e.$parent=l),r(e)&&e.forEach(function(e){return e.$parent=l})});i&&(a=th({},a,nh({},i,l)),n=th({},n,{boCache:a}));return{root:l,reviveCache:n}}({root:o,descriptorCache:e.descriptorCache},n);return{root:th({},t,{businessObject:i.root}),reviveCache:i.reviveCache}},function(e,t,n,r){var o=e.root,i=e.descriptorCache,a=th({},t);t.businessObject&&t.businessObject.id&&(a.id=t.businessObject.id);if("row"===o.type||"col"===o.type){var s=r({root:o.cells,descriptorCache:i},n);a.cells=s.root,n=s.reviveCache}var c=new(function(e){switch(e.type){case"row":return Du;case"cell":return Nu;case"col":return Iu;default:throw new Error("unknown element type: #"+e.type)}}(o))(a);c instanceof Du?c.cells.forEach(function(e){e.row=c}):c instanceof Iu&&c.cells.forEach(function(e){e.col=c});return{root:c,reviveCache:n}}];function ah(e,t,n){return n=n||oh,t=t||{},r(e)?function(e,t,n){return f(e,function(e,t){var r=e.descriptorCache,o=e.root,i=sh(t,r,n),a=i.root,s=i.descriptorCache;return{root:[].concat(rh(o),[a]),descriptorCache:th({},r,s)}},{root:[],descriptorCache:t})}(e,t,n):sh(e,t,n)}function sh(e,t,n){var r=e.id,o={id:r},i=t.elements||{},a=i[r];if(a)return{root:a,descriptorCache:t};var s=function(e,t,n,r){function o(e,t){return ah(e,t,n)}return f(n,function(t,n){return n(e,t.root,t.descriptorCache,o)},{root:t,descriptorCache:r})}(e,o,n,th({},t,{elements:i}));return{root:s.root,descriptorCache:th({},s.descriptorCache,{elements:th({},s.descriptorCache.elements,nh({},r,s.root))})}}function ch(e,t,n){return n=n||ih,t=t||{},r(e.root)?function(e,t,n){var r=e.root,o=e.descriptorCache;return f(r,function(e,t){var r=e.reviveCache,i=e.root,a=uh({root:t,descriptorCache:o},r,n),s=a.root,c=a.reviveCache;return{root:[].concat(rh(i),[s]),reviveCache:c}},{root:[],reviveCache:t})}(e,t,n):uh(e,t,n)}function uh(e,t,n){var r=e.root.id,o=t.elements||{},i=o[r];if(i)return{root:i,reviveCache:t};var a=function(e,t,n,r){function o(e,t){return ch(e,t,n)}return f(n,function(t,n){return n(e,t.root,t.reviveCache,o)},{root:t,reviveCache:r})}(e,{id:r},n,th({},t,{elements:o}));return{root:a.root,reviveCache:th({},a.reviveCache,{elements:th({},a.reviveCache.elements,nh({},r,a.root))})}}var lh=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ph=function(){function e(t,n,r,o,i,a,s,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._clipboard=t,this._dmnFactory=n,this._elementFactory=r,this._elementRegistry=o,this._eventBus=i,this._model=a,this._modeling=s,this._sheet=c}return lh(e,[{key:"postExecute",value:function(e){var t=this,n=e.element,r=e.after,o=this._clipboard.get();if(!o)throw new Error("missing clipboard data");var i=this._sheet.getRoot(),a=ch(o.elements,{_dmnFactory:this._dmnFactory,_keepIds:o.keepIds,_model:this._model}).root;if(n instanceof Du){var s=i.rows.indexOf(n);if(-1===s)return;a.forEach(function(e){r&&s++,t._modeling.addRow(e,s)})}else if(n instanceof Iu){var c=i.cols.indexOf(n);if(-1===c)return;a.forEach(function(e){r&&c++,t._modeling.addCol(e,c)})}return e.oldElements=this._clipboard.get(),this._sheet.getRoot()}},{key:"revert",value:function(e){}}]),e}();ph.$inject=["clipboard","dmnFactory","elementFactory","elementRegistry","eventBus","moddle","modeling","sheet"];var fh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dh=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var hh=function(){function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._clipboard=t,this._commandStack=n,this._eventBus=r,this._modeling=o,this._sheet=i,this._rules=a,n.registerHandler("cut",eh),n.registerHandler("paste",ph)}return dh(e,[{key:"copy",value:function(e){r(e)||(e=[e]);var t={elements:ah(e)};this._eventBus.fire("copyCutPaste.copy",{data:t}),this._clipboard.set(t)}},{key:"cut",value:function(e){r(e)||(e=[e]);var t={elements:ah(e),keepIds:!0},n={elements:e,data:t};this._eventBus.fire("copyCutPaste.cut",{data:t}),this._commandStack.execute("cut",n)}},{key:"pasteBefore",value:function(e){return this._paste(e,{before:!0})}},{key:"pasteAfter",value:function(e){return this._paste(e,{after:!0})}},{key:"_paste",value:function(e,t){var n=this._clipboard.get();if(n)return!!this._rules.allowed("paste",{data:n.elements,target:e})&&(this._commandStack.execute("paste",fh({element:e},t)),!0)}},{key:"pasteAt",value:function(e){}}]),e}();hh.$inject=["clipboard","commandStack","eventBus","modeling","sheet","rules"];var vh={__depends__:[os,Jd],__init__:["copyCutPaste"],copyCutPaste:["type",hh]};var yh=function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var s={addRule:function(){return r.addRow({type:"dmn:DecisionRule"})},addRuleAbove:function(e){var t=e&&e.rule;if(t||o.hasSelection()){t=t||o.get().row;var n=a.getRoot().rows.indexOf(t);if(-1!==n)return r.addRow({type:"dmn:DecisionRule"},n)}},addRuleBelow:function(e){var t=e&&e.rule;if(t||o.hasSelection()){t=t||o.get().row;var n=a.getRoot().rows.indexOf(t);if(-1!==n)return r.addRow({type:"dmn:DecisionRule"},n+1)}},removeRule:function(e){var t=e&&e.rule;(t||o.hasSelection())&&(t=t||o.get().row,r.removeRow(t))},addInput:function(){var e=a.getRoot().businessObject.input;return r.addCol({type:"dmn:InputClause"},e?e.length:0)},addInputLeft:function(e){var t=e&&e.input;if(t||o.hasSelection()){t=t||o.get().col;var n=a.getRoot().cols.indexOf(t);if(-1!==n)return r.addCol({type:"dmn:InputClause"},n)}},addInputRight:function(e){var t=e&&e.input;if(t||o.hasSelection()){t=t||o.get().col;var n=a.getRoot().cols.indexOf(t);if(-1!==n)return r.addCol({type:"dmn:InputClause"},n+1)}},removeInput:function(e){var t=e&&e.input;(t||o.hasSelection())&&(t=t||o.get().col,r.removeCol(t))},addOutput:function(){var e=a.getRoot().businessObject,t=e.input,n=e.output;return r.addCol({type:"dmn:OutputClause"},t.length+n.length)},addOutputLeft:function(e){var t=e&&e.output;if(t||o.hasSelection()){t=t||o.get().col;var n=a.getRoot().cols.indexOf(t);if(-1!==n)return r.addCol({type:"dmn:OutputClause"},n)}},addOutputRight:function(e){var t=e&&e.output;if(t||o.hasSelection()){t=t||o.get().col;var n=a.getRoot().cols.indexOf(t);if(-1!==n)return r.addCol({type:"dmn:OutputClause"},n+1)}},removeOutput:function(e){var t=e&&e.output;(t||o.hasSelection())&&(t=t||o.get().col,r.removeCol(t))},addClause:function(){if(o.hasSelection()){var e=o.get().col;return Nt(e,"dmn:InputClause")?s.addInput({input:e}):Nt(e,"dmn:OutputClause")?s.addOutput({output:e}):void 0}},addClauseLeft:function(){if(o.hasSelection()){var e=o.get().col;return Nt(e,"dmn:InputClause")?s.addInputLeft({input:e}):Nt(e,"dmn:OutputClause")?s.addOutputLeft({output:e}):void 0}},addClauseRight:function(){if(o.hasSelection()){var e=o.get().col;return Nt(e,"dmn:InputClause")?s.addInputRight({input:e}):Nt(e,"dmn:OutputClause")?s.addOutputRight({output:e}):void 0}},removeClause:function(){if(o.hasSelection()){var e=o.get().col;return Nt(e,"dmn:InputClause")?s.removeInput({input:e}):Nt(e,"dmn:OutputClause")?s.removeOutput({output:e}):void 0}},selectCellAbove:function(){return i.selectCell("above")},selectCellBelow:function(){return i.selectCell("below")},copy:function(e){var n=e.element;t.copy(n)},cut:function(e){var n=e.element;t.cut(n)},pasteBefore:function(e){var n=e.element;return t.pasteBefore(n)},pasteAfter:function(e){var n=e.element;return t.pasteAfter(n)}};n.register(s)};yh.$inject=["copyCutPaste","editorActions","modeling","selection","cellSelection","sheet"];var mh=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var gh=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._actions={undo:function(){t.undo()},redo:function(){t.redo()},select:function(e){var t=e.cell;o.select(t)},deselect:function(){o.deselect()},addRow:function(e){var t=e.attrs,n=e.index;r.addRow(t,n)},removeRow:function(e){var t=e.row;r.removeRow(t)},moveRow:function(e){var t=e.row,n=e.index;r.moveRow(t,n)},addCol:function(e){var t=e.attrs,n=e.index;r.addCol(t,n)},removeCol:function(e){var t=e.col;r.removeCol(t)},moveCol:function(e){var t=e.col,n=e.index;r.moveCol(t,n)}}}return mh(e,[{key:"trigger",value:function(e,t){if(!this._actions[e])throw bh(e,"is not a registered action");return this._actions[e](t)}},{key:"register",value:function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);p(e,function(e,t){n._registerAction(t,e)})}},{key:"_registerAction",value:function(e,t){if(this.isRegistered(e))throw bh(e,"is already registered");this._actions[e]=t}},{key:"unregister",value:function(e){if(!this.isRegistered(e))throw bh(e,"is not a registered action");this._actions[e]=void 0}},{key:"isRegistered",value:function(e){return!!this._actions[e]}}]),e}();function bh(e,t){return new Error(e+" "+t)}gh.$inject=["commandStack","eventBus","modeling","selection"];var _h={__depends__:[gd],__init__:["editorActions"],editorActions:["type",gh]},wh={__depends__:[Xd,vh,_h,gd],__init__:["decisionTableEditorActions"],decisionTableEditorActions:["type",yh]},xh={__depends__:[wh],__init__:["addRule"],addRule:["type",hd]},Ch=/["'&<>]/,Eh=function(e){var t,n=""+e,r=Ch.exec(n);if(!r)return n;var o="",i=0,a=0;for(i=r.index;i<n.length;i++){switch(n.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}a!==i&&(o+=n.substring(a,i)),a=i+1,o+=t}return a!==i?o+n.substring(a,i):o};var Oh=function(e,t,n){var r=e.start,o=r,i=n.length-t.length,a=(n.length,t.length,t.substring(r));return n.lastIndexOf(a)===n.length-a.length&&(t=t.substring(0,t.length-a.length),n=n.substring(0,n.length-a.length)),(i=function(e,t){var n,r,o,i,a,s=0,c=0;for(t.length>e.length?(r=t,i=e):(r=e,i=t);s<r.length;)o=r.charAt(s),a=i.charAt(c),o!==a?(n||(n={l_start:s,s_start:c}),s++):(n&&!n.complete&&(n.l_end=s,n.s_end=c,n.complete=!0),c++,s++);if(n&&!n.complete&&(n.complete=!0,n.s_end=i.length,n.l_end=r.length),n)return t.length>e.length?{newStart:n.l_start,newEnd:n.l_end,type:"add"}:{newStart:n.s_start,newEnd:n.s_end,type:t.length<e.length?"remove":"replace"}}(t,n))&&(o="remove"===i.type?i.newStart:i.newEnd),kh(o)};function kh(e,t){return{start:e,end:void 0===t?e:t}}var jh=kh;Oh.range=jh;var Sh=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ph=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r,o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.onFocus=function(){var e=o.props.onFocus;o.setState({focussed:!0}),"function"==typeof e&&e()},o.onBlur=function(){var e=o.props.onBlur;o.setState({focussed:!1}),"function"==typeof e&&e()},o.onKeydown=function(e){if(13===e.which){if(e.preventDefault(),o.props.ctrlForNewline&&!function(e){return e.metaKey||e.ctrlKey}(e))return;e.stopPropagation(),function(){var e=Ad().getRangeAt(0);if(!e)return;var t=e.cloneRange(),n=document.createElement("br");t.deleteContents(),t.insertNode(n),t.setStartAfter(n),t.setEndAfter(n),Rd(t)}(),o.onInput(e)}},o.onInput=function(e){var t=o.props.onInput;"function"==typeof t&&t(Th(o.node))},o.onPaste=Rh,o.onKeypress=Rh,o.state={},((r=window.navigator.userAgent).indexOf("MSIE ")>0||r.indexOf("Trident/")>0)&&(o.onPaste=o.onKeypress=function(e){var t=o.node.innerHTML;setTimeout(function(){var n=o.node.innerHTML;t!==n&&o.onInput(e)},0)}),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Sh(t,[{key:"componentWillUpdate",value:function(e,t){var n=this.node,r=t.focussed&&Bd(n);this.selected=r&&{range:r,text:Th(n)}}},{key:"componentDidUpdate",value:function(){var e=this.selected;if(e){var t=e.range,n=e.text,r=this.node,o=Th(r);Md(r,o!==n?Oh(t,n,o):t)}}},{key:"render",value:function(e){var t=this,n=e.value,r=e.className;return n=Eh(n).replace(/\r?\n/g,"<br/>")+"<br/>",fl(1,"div",[r||"","content-editable"].join(" "),null,1,{contentEditable:"true",spellcheck:"false",onInput:this.onInput,onKeypress:this.onKeypress,onPaste:this.onPaste,onFocus:this.onFocus,onBlur:this.onBlur,onKeydown:this.onKeydown,dangerouslySetInnerHTML:{__html:n}},null,function(e){return t.node=e})}}]),t}();function Th(e){return e.innerText.replace(/\n$/,"")}function Rh(){}var Ah=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Mh=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.onFocus=function(){r.setState({focussed:!0});var e=r.props.onFocus;"function"==typeof e&&e()},r.onBlur=function(e){r.setState({focussed:!1}),r.state.invalid&&r.setState({changing:!1,invalid:!1});var t=r.props.onBlur;"function"==typeof t&&t()},r.state={changing:!1,focussed:!1};var o=n.injector.get("debounceInput");return r.inputChanged=o(function(e){var t=r.props.onChange;"function"==typeof t&&t(e);var n=r.state.changing;r.setState({changing:n!==e&&n})}),r.onInput=function(e){var t=(r.props.validate||function(){})(e);r.setState({changing:e,invalid:t}),t||r.inputChanged(e)},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Ah(t,[{key:"getClassName",value:function(){var e=this.props.className,t=this.state,n=t.focussed,r=t.invalid;return e+=" editable",n&&(e+=" focussed"),r&&(e+=" invalid"),e}},{key:"getDisplayValue",value:function(){var e=this.props.value,t=this.state,n=t.focussed,r=t.changing;return"string"==typeof r&&(e=r),e||(e=n?"":"-"),e}},{key:"getEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return dl(2,Ph,{className:e.className,ctrlForNewline:e.ctrlForNewline,onFocus:this.onFocus,onBlur:this.onBlur,onInput:this.onInput,value:this.getDisplayValue()})}}]),t}(),Bh=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Dh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ih(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Nh(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Vh=function(e){function t(e,n){Dh(this,t);var r=Ih(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onElementsChanged=function(){r.forceUpdate()},r.setAnnotationValue=function(e){var t=r.props.row;r.modeling.editAnnotation(t.businessObject,e)},Kp(r),r}return Nh(t,Sp),Bh(t,[{key:"componentWillMount",value:function(){var e=this.props.row;this.changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.props.row;this.changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.props,t=e.row,n=e.rowIndex,r=t.businessObject,o=r.description,i=r.id;return dl(2,rf,{className:"annotation",onChange:this.setAnnotationValue,coords:n+":annotation",value:o,elementId:i+"__annotation","data-row-id":t.id,children:dl(2,Lh,{ctrlForNewline:!0,className:"annotation-editor",onChange:this.setAnnotationValue,value:o})})}}]),t}();Vh.$inject=["changeSupport","modeling"];var Lh=function(e){function t(){return Dh(this,t),Ih(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Nh(t,Mh),Bh(t,[{key:"render",value:function(){return fl(1,"div",this.getClassName(),this.getEditor(),0)}}]),t}();function $h(e){e.onGetComponent("cell",function(e){var t=e.cellType;return"after-label-cells"===t?zp:"after-rule-cells"===t?Vh:void 0})}$h.$inject=["components"];var Fh=300;function Uh(e){return function(t){return!1!==e?O(t,i(e)?e:Fh):t}}Uh.$inject=["config.debounceInput"];var zh={debounceInput:["factory",Uh]},Wh={__depends__:[zh],__init__:["annotationsProvider"],annotationsProvider:["type",$h]},Gh=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Hh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qh(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Kh(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Xh=function(e){function t(e,n){Hh(this,t);var r=qh(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Yh.call(r),r.state={isOpen:!1,position:{x:0,y:0}},Kp(r),r}return Kh(t,Sp),Gh(t,[{key:"componentDidMount",value:function(){this.eventBus.on("contextMenu.open",this.open),this.eventBus.on("contextMenu.close",this.close)}},{key:"componentWillUnmount",value:function(){this.eventBus.off("contextMenu.open",this.open),this.eventBus.off("contextMenu.close",this.close)}},{key:"render",value:function(){var e=this.state,t=e.isOpen,n=e.context,r=e.position;if(!t)return null;var o=this.components.getComponents("context-menu",n);return o.length?dl(2,Zh,{className:"context-menu no-deselect",context:n,position:r,offset:n.offset||{x:0,y:0},autoFocus:!1!==n.autoFocus,autoClose:!1!==n.autoClose,components:o,onClose:this.triggerClose}):null}}]),t}(),Yh=function(){var e=this;this.open=function(t){var n=t.position,r=t.context;e.close(),e.setState({isOpen:!0,position:n||{x:0,y:0},context:r||{}})},this.close=function(){e.state.isOpen&&e.setState({context:void 0,isOpen:!1,position:{x:0,y:0}})},this.triggerClose=function(){e.eventBus.fire("contextMenu.close")}};Xh.$inject=["eventBus","components"];var Zh=function(e){function t(e,n){Hh(this,t);var r=qh(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onGlobalClick=function(e){r.checkClose(e.target)},r.onGlobalKey=function(e){var t=e.which;13!==t&&27!==t||(e.stopPropagation(),e.preventDefault(),r.close())},r.onFocusChanged=function(e){r.checkClose(e.target)},r.setNode=function(e){r.node=e;var t,n=r.props.autoFocus;e&&(r.updatePosition(),n&&(t=_t(Qh,e))&&(t.focus(),"contentEditable"in t&&Md(t,{start:1e5,end:1e5}),bt(t,"[type=text], textarea")&&(t.selectionStart=1e5)))},Kp(r),r}return Kh(t,Sp),Gh(t,[{key:"close",value:function(){var e=this.props.onClose;a(e)&&e()}},{key:"checkClose",value:function(e){if(this.props.autoClose){var t=this.node;t&&t!==e&&(t.contains(e)||this.close())}}},{key:"componentDidMount",value:function(){document.addEventListener("focusin",this.onFocusChanged),document.addEventListener("keydown",this.onGlobalKey),document.addEventListener("click",this.onGlobalClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("focusin",this.onFocusChanged),document.removeEventListener("keydown",this.onGlobalKey),document.removeEventListener("click",this.onGlobalClick)}},{key:"updatePosition",value:function(){var e=this.props,t=e.position,n=e.offset,r=this.node.getBoundingClientRect();t.width||(t.width=0),t.height||(t.height=0);var o=this.renderer.getContainer(),i=o.getBoundingClientRect();i.width>i.height?(this.node.classList.add("horizontal"),this.node.classList.remove("vertical")):(this.node.classList.add("vertical"),this.node.classList.remove("horizontal"));var a=o.scrollLeft,s=o.scrollTop,c={};if(t.x+t.width/2>i.width/2){var u=t.x-i.left-r.width+n.x+a;u=Jh(u,0+a,i.width-r.width+a),c.left=u+"px"}else{var l=window.scrollX-i.left+t.x+t.width-n.x+a;l=Jh(l,0+a,i.width-r.width+a),c.left=l+"px"}var p=void 0;t.y+t.height/2>i.height/2?(p=Jh(p=t.y-i.top-r.height+n.y+s,0+s,i.height-r.height+s),c.top=p+"px"):(p=Jh(p=window.scrollY-i.top+t.y-n.y+s,0+s,i.height-r.height+s),c.top=p+"px"),c.overflowY="auto",c.maxHeight=i.height-p+s+"px",S(this.node.style,c)}},{key:"render",value:function(){var e=this.props,t=e.context,n=e.components;return fl(1,"div",e.className,n.map(function(e,n){return dl(2,e,{context:t},n)}),0,{onContextMenu:function(e){return e.preventDefault()}},null,this.setNode)}}]),t}();function Jh(e,t,n){return Math.max(t,Math.min(n,e))}Zh.$inject=["renderer"];var Qh="\n  input[type=text],\n  input[type=number],\n  input[type=button],\n  input[type=submit],\n  [contenteditable],\n  [tabindex],\n  a[href],\n  textarea,\n  button\n";var ev=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var tv=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventBus=n,t.onGetComponent("table.before",function(){return Xh})}return ev(e,[{key:"open",value:function(e,t){this._eventBus.fire("contextMenu.open",{position:e,context:t})}},{key:"close",value:function(){this._eventBus.fire("contextMenu.close")}}]),e}();tv.$inject=["components","eventBus","renderer"];var nv={__init__:["contextMenu"],contextMenu:["type",tv]};function rv(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function ov(e){return e.shiftKey}var iv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var av=function(){function e(t,n,r,o,i,a,s){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._clearClipboard=function(){c._clipboard.clear()},this._registerBindings=function(){[function(e,t){if(rv(t)&&67===e){var n=c._getSelectedCell();if(!n)return;return ov(t)?c._editorActions.trigger("copy",{element:n.col}):c._editorActions.trigger("copy",{element:n.row}),!0}},function(e,t){if(rv(t)&&88===e){var n=c._getSelectedCell();if(!n)return;return ov(t)?c._editorActions.trigger("cut",{element:n.col}):c._editorActions.trigger("cut",{element:n.row}),!0}},function(e,t){var n=void 0;if(rv(t)&&86===e){var r=c._getSelectedCell();if(!r)return;ov(t)?(n=c._editorActions.trigger("pasteAfter",{element:r.col}))&&c._cellSelection.selectCell("right"):(n=c._editorActions.trigger("pasteAfter",{element:r.row}))&&c._cellSelection.selectCell("below")}return void 0!==n}].forEach(function(e){c._keyboard.addListener(e)})},this._clipboard=r,this._cellSelection=o,this._elementRegistry=i,this._editorActions=a,this._keyboard=t.get("keyboard",!1),this._renderer=s,this._keyboard&&(n.on("keyboard.init",this._registerBindings),n.on("keyboard.bind",function(){pt.bind(document,"copy",c._clearClipboard,!0),pt.bind(document,"cut",c._clearClipboard,!0)}),n.on("keyboard.unbind",function(){pt.unbind(document,"copy",c._clearClipboard,!0),pt.unbind(document,"cut",c._clearClipboard,!0)}))}return iv(e,[{key:"_getSelectedCell",value:function(){var e=this._cellSelection.getCellSelection();if(e){var t=this._elementRegistry.get(e);if(t){var n=zd(e,this._renderer.getContainer()),r=Gd(n);if(document.activeElement===r){var o=Bd(n);if(!o||o.start===o.end)return t}}}}}]),e}();av.$inject=["injector","eventBus","clipboard","cellSelection","elementRegistry","editorActions","renderer"];var sv={__depends__:[os,Xd],__init__:["copyCutPasteKeyBindings"],copyCutPasteKeyBindings:["type",av]},cv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var uv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onClick=function(e){r.editorActions.trigger("addInput")},Kp(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),cv(t,[{key:"render",value:function(){return fl(1,"th","input-cell create-inputs header actionable",[hl("Input "),fl(1,"span","add-input dmn-icon-plus action-icon",null,1,{title:"Add Input"})],4,{onClick:this.onClick,rowspan:"3",title:"Add Input"})}}]),t}();uv.$inject=["editorActions"];var lv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var pv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onClick=function(e){r.editorActions.trigger("addInput")},Kp(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),lv(t,[{key:"render",value:function(){return fl(1,"td","input-cell create-inputs",hl("-"),2,{onClick:this.onClick,title:"Add Input"})}}]),t}();pv.$inject=["editorActions"];var fv=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("cell",500,function(e){var t=e.cellType,r=n.getRoot().businessObject;if(!r.input||!r.input.length)return"before-label-cells"===t?uv:"before-rule-cells"===t?pv:void 0})};fv.$inject=["components","sheet"];var dv={__depends__:[wh],__init__:["createInputsProvider"],createInputsProvider:["type",fv]},hv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var vv=function(){function e(t,n,r,o,i,a,s,c,u){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._contextMenu=n,this._clipboard=r,this._editorActions=o,this._elementRegistry=a,this._eventBus=i,this._modeling=s,this._sheet=c,this._rules=u,this._getEntries=this._getEntries.bind(this),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"context-menu"===e.contextMenuType){var n=l._getEntries(e),r=function(e){return e instanceof Nu}(l._elementRegistry.get(e.id))&&t.getComponents("context-menu-cell-additional",e);if(r&&r.length){var o=fl(1,"div","context-menu-group context-menu-group-cell",[fl(1,"h4","context-menu-group-title",hl("Cell"),2),r],0);return function(){return fl(1,"div","context-menu-flex",(n||[]).concat([o]),0)}}return function(){return fl(1,"div","context-menu-flex",n||[],0)}}}),i.on("cell.contextmenu",function(e){var t=e.event,r=e.id;e.node;t.preventDefault(),n.open({x:t.pageX,y:t.pageY},{contextMenuType:"context-menu",id:r})})}return hv(e,[{key:"_getEntries",value:function(e){var t=this,n=function(e){t._editorActions.trigger("addRuleAbove",{rule:e}),t._contextMenu.close()},r=function(e){t._editorActions.trigger("addRuleBelow",{rule:e}),t._contextMenu.close()},o=function(e){t._editorActions.trigger("removeRule",{rule:e}),t._contextMenu.close()},i=function(e){t._editorActions.trigger("addInputLeft",{input:e}),t._contextMenu.close()},a=function(e){t._editorActions.trigger("addInputRight",{input:e}),t._contextMenu.close()},s=function(e){t._editorActions.trigger("removeInput",{input:e}),t._contextMenu.close()},c=function(e){t._editorActions.trigger("addOutputLeft",{output:e}),t._contextMenu.close()},u=function(e){t._editorActions.trigger("addOutputRight",{output:e}),t._contextMenu.close()},l=function(e){t._editorActions.trigger("removeOutput",{output:e}),t._contextMenu.close()},p=function(e){t._editorActions.trigger("copy",{element:e}),t._contextMenu.close()},f=function(e){t._editorActions.trigger("cut",{element:e}),t._contextMenu.close()},d=function(e){t._editorActions.trigger("pasteBefore",{element:e}),t._contextMenu.close()},h=function(e){t._editorActions.trigger("pasteAfter",{element:e}),t._contextMenu.close()},v=e&&e.id;if(!v)return null;var y=this._elementRegistry.get(v);if(!y)return null;var m=this._clipboard.get()||{},g=[];if(Nt(y.row,"dmn:DecisionRule")){var b=this._rules.allowed("paste",{data:m.elements,target:y.row});g.push(fl(1,"div","context-menu-group context-menu-group-rule",[fl(1,"h4","context-menu-group-title",hl("Rule"),2),fl(1,"div","context-menu-group-entry context-menu-entry-add-rule-above",[fl(1,"span","context-menu-group-entry-icon dmn-icon-up"),hl("Add Above")],4,{onClick:function(){return n(y.row)}}),fl(1,"div","context-menu-group-entry context-menu-entry-add-rule-below",[fl(1,"span","context-menu-group-entry-icon dmn-icon-down"),hl("Add Below")],4,{onClick:function(){return r(y.row)}}),fl(1,"div","context-menu-group-entry context-menu-entry-remove-rule",[fl(1,"span","context-menu-group-entry-icon dmn-icon-clear"),hl("Remove")],4,{onClick:function(){return o(y.row)}}),fl(1,"div","context-menu-group-entry context-menu-entry-copy-rule",[fl(1,"span","context-menu-group-entry-icon dmn-icon-copy"),hl("Copy")],4,{onClick:function(){return p(y.row)}}),fl(1,"div","context-menu-group-entry context-menu-entry-cut-rule",[fl(1,"span","context-menu-group-entry-icon dmn-icon-cut"),hl("Cut")],4,{onClick:function(){return f(y.row)}}),fl(1,"div","context-menu-group-entry "+(b?"":"disabled")+" context-menu-entry-paste-rule-above",[fl(1,"span","context-menu-group-entry-icon dmn-icon-paste"),hl("Paste Above")],4,{onClick:function(){return d(y.row)}}),fl(1,"div","context-menu-group-entry "+(b?"":"disabled")+" context-menu-entry-paste-rule-below",[fl(1,"span","context-menu-group-entry-icon dmn-icon-paste"),hl("Paste Below")],4,{onClick:function(){return h(y.row)}})],4))}if(Nt(y,"dmn:InputClause")||Nt(y.col,"dmn:InputClause")){var _=Nt(y,"dmn:InputClause")?y:y.col,w=this._rules.allowed("col.remove",{col:y.col||y}),x=this._rules.allowed("paste",{data:m.elements,target:y.col||y});g.push(fl(1,"div","context-menu-group context-menu-group-input",[fl(1,"h4","context-menu-group-title",hl("Input"),2),fl(1,"div","context-menu-group-entry context-menu-entry-add-input-left",[fl(1,"span","context-menu-group-entry-icon dmn-icon-left"),hl("Add Left")],4,{onClick:function(){return i(_)}}),fl(1,"div","context-menu-group-entry context-menu-entry-add-input-right",[fl(1,"span","context-menu-group-entry-icon dmn-icon-right"),hl("Add Right")],4,{onClick:function(){return a(_)}}),fl(1,"div","context-menu-group-entry "+(w?"":"disabled")+" context-menu-entry-remove-input",[fl(1,"span","context-menu-group-entry-icon dmn-icon-clear"),hl("Remove")],4,{onClick:function(){return s(_)}}),fl(1,"div","context-menu-group-entry context-menu-entry-copy-input",[fl(1,"span","context-menu-group-entry-icon dmn-icon-copy"),hl("Copy")],4,{onClick:function(){return p(_)}}),fl(1,"div","context-menu-group-entry "+(w?"":"disabled")+" context-menu-entry-cut-input",[fl(1,"span","context-menu-group-entry-icon dmn-icon-cut"),hl("Cut")],4,{onClick:function(){return f(_)}}),fl(1,"div","context-menu-group-entry "+(x?"":"disabled")+" context-menu-entry-paste-input-left",[fl(1,"span","context-menu-group-entry-icon dmn-icon-paste"),hl("Paste Left")],4,{onClick:function(){return d(_)}}),fl(1,"div","context-menu-group-entry "+(x?"":"disabled")+" context-menu-entry-paste-input-right",[fl(1,"span","context-menu-group-entry-icon dmn-icon-paste"),hl("Paste Right")],4,{onClick:function(){return h(_)}})],4))}else if(Nt(y,"dmn:OutputClause")||Nt(y.col,"dmn:OutputClause")){var C=Nt(y,"dmn:OutputClause")?y:y.col,E=this._rules.allowed("col.remove",{col:y.col||y}),O=this._rules.allowed("paste",{data:m.elements,target:y.col||y});g.push(fl(1,"div","context-menu-group context-menu-group-output",[fl(1,"h4","context-menu-group-title",hl("Output"),2),fl(1,"div","context-menu-group-entry context-menu-entry-add-output-left",[fl(1,"span","context-menu-group-entry-icon dmn-icon-left"),hl("Add Left")],4,{onClick:function(){return c(C)}}),fl(1,"div","context-menu-group-entry context-menu-entry-add-output-right",[fl(1,"span","context-menu-group-entry-icon dmn-icon-right"),hl("Add Right")],4,{onClick:function(){return u(C)}}),fl(1,"div","context-menu-group-entry "+(E?"":"disabled")+" context-menu-entry-remove-output",[fl(1,"span","context-menu-group-entry-icon dmn-icon-clear"),hl("Remove")],4,{onClick:function(){return l(C)}}),fl(1,"div","context-menu-group-entry context-menu-entry-copy-output",[fl(1,"span","context-menu-group-entry-icon dmn-icon-copy"),hl("Copy")],4,{onClick:function(){return p(C)}}),fl(1,"div","context-menu-group-entry "+(E?"":"disabled")+" context-menu-entry-cut-output",[fl(1,"span","context-menu-group-entry-icon dmn-icon-cut"),hl("Cut")],4,{onClick:function(){return f(C)}}),fl(1,"div","context-menu-group-entry "+(O?"":"disabled")+" context-menu-entry-paste-output-left",[fl(1,"span","context-menu-group-entry-icon dmn-icon-paste"),hl("Paste Left")],4,{onClick:function(){return d(C)}}),fl(1,"div","context-menu-group-entry "+(O?"":"disabled")+" context-menu-entry-paste-output-right",[fl(1,"span","context-menu-group-entry-icon dmn-icon-paste"),hl("Paste Right")],4,{onClick:function(){return h(C)}})],4))}return g}}]),e}();vv.$inject=["components","contextMenu","clipboard","editorActions","eventBus","elementRegistry","modeling","sheet","rules"];var yv=["row.add","row.remove","col.add","col.remove"],mv=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.on("commandStack.executed",function(e){var n=e.command;-1!==yv.indexOf(n)&&t.close()}),n.on("commandStack.reverted",function(){t.close()})};mv.$inject=["contextMenu","eventBus"];var gv={__depends__:[wh,nv,Jd],__init__:["decisionTableContextMenu","contextMenuCloseBehavior"],decisionTableContextMenu:["type",vv],contextMenuCloseBehavior:["type",mv]},bv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var _v=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onClick=function(e){var t=r.props.output;r._eventBus.fire("output.edit",{event:e,output:t})},r.onContextmenu=function(e){var t=r.props.output.id;r._eventBus.fire("cell.contextmenu",{event:e,id:t})},r.onElementsChanged=function(){r.forceUpdate()},Yp(r,gf),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),bv(t,[{key:"componentWillMount",value:function(){var e=this.context.injector;this._changeSupport=this.context.changeSupport,this._eventBus=e.get("eventBus"),this._elementRegistry=e.get("elementRegistry");var t=this.props.output;this._changeSupport.onElementsChanged(t.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.props.output;this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.props.output,t=e.get("label"),n=e.get("name");return fl(1,"th","output-cell output-editor",[this.slotFills({type:"cell-inner",context:{cellType:"output-cell",col:this._elementRegistry.get(e.id)},col:e}),t?fl(1,"span","output-label",t,0,{title:"Output Label"}):fl(1,"span","output-name",n||"-",0,{title:"Output Expression"})],0,{"data-col-id":e.id,onClick:this.onClick,onContextmenu:this.onContextmenu})}}]),t}(),wv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var xv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onInput=function(e){var t=r.props.onInput;"function"==typeof t&&t(e.target.value)},r.onKeyDown=function(e){var t=r.props.onKeyDown;"function"==typeof t&&t(e)},r.onKeyUp=function(e){var t=r.props.onKeyUp;"function"==typeof t&&t(e)},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),wv(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.placeholder,r=e.type,o=e.value;return fl(64,"input",[t||"","dms-input"].join(" "),null,1,{placeholder:n||"",onInput:this.onInput,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,spellcheck:"false",type:r||"text",value:o})}}]),t}(),Cv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ev=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.setName=function(e){e=e||void 0,r.handleChange({name:e})},r.setLabel=function(e){e=e||void 0,r.handleChange({label:e})},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Cv(t,[{key:"handleChange",value:function(e){var t=this.props.onChange;"function"==typeof t&&t(e)}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.label;return fl(1,"div","dms-container ref-output-editor",[fl(1,"p","dms-fill-row",[fl(1,"label","dms-label",hl("Output Name"),2),dl(2,xv,{className:"ref-output-name",value:t||"",onInput:this.setName})],4),fl(1,"p","dms-fill-row",[fl(1,"label","dms-label",hl("Output Label"),2),dl(2,xv,{className:"ref-output-label",value:n||"",onInput:this.setLabel})],4)],4)}}]),t}(),Ov=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var jv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.persistChanges=function(){var e=r.props.context.output,t=r.state.unsaved;t&&(r.modeling.updateProperties(e,t),r.setState({unsaved:!1}))},r.handleChange=function(e){r.setState({unsaved:Ov({},r.state.unsaved,e)},r.persistChanges)},r.state={},Kp(r),r.persistChanges=r.debounceInput(r.persistChanges),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),kv(t,[{key:"getValue",value:function(e){var t=this.props.context.output,n=this.state.unsaved;return n&&n[e]||t.get(e)}},{key:"render",value:function(){return fl(1,"div","context-menu-container output-edit",dl(2,Ev,{name:this.getValue("name"),label:this.getValue("label"),onChange:this.handleChange}),2)}}]),t}();jv.$inject=["debounceInput","modeling"];var Sv=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("cell",function(e){if("output-header"===e.cellType)return _v}),t.onGetComponent("context-menu",function(){if("output-edit"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).contextMenuType)return jv}),r.on("output.edit",function(e){var t=e.event,r=e.output,i=t.target,a=st(i,"th",!0).getBoundingClientRect(),s=a.left,c=a.top,u=a.width,l=a.height,p=o.getContainer();n.open({x:s+p.parentNode.scrollLeft,y:c+p.parentNode.scrollTop,width:u,height:l},{contextMenuType:"output-edit",output:r,offset:{x:4,y:4}})})};Sv.$inject=["components","contextMenu","eventBus","renderer"];var Pv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Tv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onClick=function(e){var t=r.props.input;r._eventBus.fire("input.edit",{event:e,input:t})},r.onContextmenu=function(e){var t=r.props.input.id;r._eventBus.fire("cell.contextmenu",{event:e,id:t})},r.onElementsChanged=function(){r.forceUpdate()},Yp(r,gf),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Pv(t,[{key:"componentWillMount",value:function(){var e=this.context.injector;this._changeSupport=this.context.changeSupport,this._sheet=e.get("sheet"),this._eventBus=e.get("eventBus"),this._elementRegistry=e.get("elementRegistry");var t=this._sheet.getRoot(),n=this.props.input;this._changeSupport.onElementsChanged(t.id,this.onElementsChanged),this._changeSupport.onElementsChanged(n.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this._sheet.getRoot(),t=this.props.input;this._changeSupport.offElementsChanged(e.id,this.onElementsChanged),this._changeSupport.offElementsChanged(t.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.props.input,t=e.inputExpression,n=e.get("label"),r=e.get("inputVariable"),o=t.get("expressionLanguage")||"FEEL",i=!n&&"FEEL"!=o;return fl(1,"th","input-cell input-editor",[this.slotFills({type:"cell-inner",context:{cellType:"input-cell",col:this._elementRegistry.get(e.id)},col:e}),n?fl(1,"span","input-label",n,0,{title:"Input Label"}):fl(1,"span","input-expression",t.text||"-",0,{title:"Input Expression"}),r&&fl(1,"span","dms-badge dmn-variable-name input-variable",r,0,{title:"Input Variable"}),i&&fl(1,"span","dms-badge dmn-expression-language input-expression-language",[fl(1,"span","dms-badge-icon dmn-icon-file-code"),fl(1,"span","dms-badge-label",o,0)],4,{title:"Input Expression Language = "+o})],0,{"data-col-id":e.id,onClick:this.onClick,onContextmenu:this.onContextmenu})}}]),t}(),Rv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Av=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));Mv.call(r),Kp(r);var o=e.value;return r.state={value:o,optionsVisible:!1},r._portalEl=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Rv(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onGlobalClick),document.addEventListener("focusin",this.onFocusChanged),this.keyboard.addListener(this.onKeyboard)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("focusin",this.onFocusChanged),document.removeEventListener("click",this.onGlobalClick),this.keyboard.removeListener(this.onKeyboard),this.removePortalEl()}},{key:"componentWillReceiveProps",value:function(e){var t=e.value;this.setState({value:t})}},{key:"componentWillUpdate",value:function(e,t){t.optionsVisible?this._portalEl||this.addPortalEl():this._portalEl&&this.removePortalEl()}},{key:"componentDidUpdate",value:function(){if(this.state.optionsVisible&&this.inputNode){var e=this.inputNode.getBoundingClientRect(),t=e.top,n=e.left,r=e.width,o=e.height;S(this._portalEl.style,{top:t+o+"px",left:n+"px",width:r+"px"})}}},{key:"addPortalEl",value:function(){this._portalEl=ht('<div class="dms-select-options"></div>'),this.renderer.getContainer().appendChild(this._portalEl)}},{key:"removePortalEl",value:function(){this._portalEl&&(xt(this._portalEl),this._portalEl=null)}},{key:"focusInput",value:function(){var e=this.inputNode;e.focus(),"selectionStart"in e&&(e.selectionStart=1e5)}},{key:"checkClose",value:function(e){!this._portalEl||this._portalEl.contains(e)||this.parentNode.contains(e)||this.setOptionsVisible(!1)}},{key:"select",value:function(e){var t=this.props.options,n=this.state.value;if(t){var r=t.filter(function(e){return e.value===n})[0],o=r?t.indexOf(r):-1,i=-1===o?1===e?0:t.length-1:(o+e)%t.length,a=t[i<0?t.length+i:i];this.onChange(a.value)}}},{key:"setOptionsVisible",value:function(e){this.setState({optionsVisible:e})}},{key:"renderOptions",value:function(e,t){var n=this;return fl(1,"div","options",e.map(function(e){return fl(1,"div",["option",t===e?"active":""].join(" "),e.label,0,{"data-value":e.value,onClick:function(t){return n.onOptionClick(e.value,t)}})}),0)}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.className,i=r.options,a=r.noInput,s=this.state,c=s.optionsVisible,u=s.value,l=!!i&&i.filter(function(e){return e.value===u})[0],p=l?l.label:u;return fl(1,"div",[o||"","dms-input-select"].join(" "),[a?fl(1,"div","dms-input",p,0,{tabindex:"0",onKeyDown:this.onKeyDown},null,function(e){return n.inputNode=e}):fl(64,"input","dms-input",null,1,{onInput:this.onInput,onKeyDown:this.onKeyDown,spellcheck:"false",type:"text",value:u},null,function(e){return n.inputNode=e}),fl(1,"span",["dms-input-select-icon",c?"dmn-icon-up":"dmn-icon-down"].join(" ")),c&&(e=this.renderOptions(i,l),t=this._portalEl,fl(1024,t,null,e,0,null,nl(e)?null:e.key,null))],0,{onClick:this.onInputClick},null,function(e){return n.parentNode=e})}}]),t}(),Mv=function(){var e=this;this.onChange=function(t){e.setState({value:t});var n=e.props.onChange;"function"==typeof n&&n(t)},this.onInputClick=function(t){t.preventDefault(),t.stopPropagation(),e.setOptionsVisible(!e.state.optionsVisible),e.focusInput()},this.onInput=function(t){var n=t.target.value;e.onChange(n)},this.onOptionClick=function(t,n){n.preventDefault(),n.stopPropagation(),e.setOptionsVisible(!1),e.onChange(t),e.focusInput()},this.onFocusChanged=function(t){e.checkClose(t.target)},this.onGlobalClick=function(t){e.checkClose(t.target)},this.onKeyDown=function(t){var n=e.state.optionsVisible,r=t.which;40!==r&&38!==r||(t.stopPropagation(),t.preventDefault(),n?e.select(40===r?1:-1):e.setOptionsVisible(!0)),n&&(13!==r&&27!==r||(t.stopPropagation(),t.preventDefault(),e.setOptionsVisible(!1)))},this.onKeyboard=function(t){if(e.state.optionsVisible)return 27===t?(e.setOptionsVisible(!1),!0):void 0}};Av.$inject=["keyboard","renderer"];var Bv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Dv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.setExpressionLanguage=function(e){r.handleChange({expressionLanguage:e})},r.makeScript=function(e){e.preventDefault(),e.stopPropagation(),r.setExpressionLanguage("FEEL")},r.handleValue=function(e){var t=r.props.expressionLanguage,n={text:e};Iv(e)&&!t&&(n.expressionLanguage="FEEL"),Iv(e)||"FEEL"!==t||(n.expressionLanguage=void 0),r.handleChange(n)},r.handleLanguageChange=function(e){r.setExpressionLanguage(e)},r.handleLabelChange=function(e){var t=e||void 0;r.handleChange({label:t})},r.handleInputVariableChange=function(e){var t=e||void 0;r.handleChange({inputVariable:t})},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Bv(t,[{key:"handleChange",value:function(e){var t=this.props.onChange;"function"==typeof t&&t(e)}},{key:"render",value:function(){var e=this.props,t=e.expressionLanguage,n=e.inputVariable,r=e.label,o=e.text,i=t||Iv(o),a=[!Iv(o)&&"","FEEL","JUEL","JavaScript","Groovy","Python"].filter(s).map(function(e){return{label:e,value:e}});return fl(1,"div","dms-container ref-input-editor",[fl(1,"h4","dms-heading",hl("Input Expression"),2),dl(2,Ph,{placeholder:"enter expression",ctrlForNewline:!0,className:["ref-text","dms-input",i?"dms-script-input script-editor":"","dms-fit-row"].join(" "),onInput:this.handleValue,value:o||""}),!i&&fl(1,"p","dms-hint",[hl("Enter simple "),fl(1,"code",null,hl("FEEL"),2),hl(" expression or "),fl(1,"a","ref-make-script",hl("change to script"),2,{href:"#",onClick:this.makeScript}),hl(".")],4),i&&fl(1,"p","dms-hint",hl("Enter script."),2),i&&fl(1,"p",null,[fl(1,"label","dms-label",hl("Expression Language"),2),dl(2,Av,{className:"ref-language",value:t||"",onChange:this.handleLanguageChange,options:a})],4),fl(1,"hr","dms-hrule"),fl(1,"p","dms-fill-row",[fl(1,"label","dms-label",hl("Input Label"),2),dl(2,xv,{className:"ref-input-label",value:r||"",onInput:this.handleLabelChange})],4),fl(1,"p","dms-fill-row",[fl(1,"label","dms-label",hl("Input Variable"),2),dl(2,xv,{className:"ref-input-variable",value:n||"",onInput:this.handleInputVariableChange,placeholder:"cellInput"})],4)],0)}}]),t}();function Iv(e){return e&&e.split(/\n/).length>1}var Nv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Lv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.persistChanges=function(){var e=r.props.context.input,t=r.state.unsaved;if(t){var n,o=t.inputVariable,i=t.label,a=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["inputVariable","label"]),s={};"inputVariable"in t&&(s.inputVariable=o),"label"in t&&(s.label=i),n=a,Object.keys(n).length&&(s.inputExpression=a),r.modeling.updateProperties(e,s),r.setState({unsaved:!1})}},r.handleChange=function(e){r.setState({unsaved:Nv({},r.state.unsaved,e)},r.persistChanges)},r.state={},Kp(r),r.persistChanges=r.debounceInput(r.persistChanges),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Vv(t,[{key:"getValue",value:function(e){var t=this.props.context.input,n=this.state.unsaved,r=t;return"expressionLanguage"!==e&&"text"!==e||(r=r.inputExpression),n&&n[e]||r.get(e)}},{key:"render",value:function(){return fl(1,"div","context-menu-container input-edit",dl(2,Dv,{expressionLanguage:this.getValue("expressionLanguage"),inputVariable:this.getValue("inputVariable"),label:this.getValue("label"),text:this.getValue("text"),onChange:this.handleChange}),2)}}]),t}();Lv.$inject=["debounceInput","modeling"];var $v=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("cell",function(e){if("input-header"===e.cellType)return Tv}),t.onGetComponent("context-menu",function(){if("input-edit"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).contextMenuType)return Lv}),r.on("input.edit",function(e){var t=e.event,r=e.input,i=t.target,a=st(i,"th",!0).getBoundingClientRect(),s=a.left,c=a.top,u=a.width,l=a.height,p=o.getContainer();n.open({x:s+p.parentNode.scrollLeft,y:c+p.parentNode.scrollTop,width:u,height:l},{contextMenuType:"input-edit",input:r,offset:{x:4,y:4}})})};$v.$inject=["components","contextMenu","eventBus","renderer"];var Fv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Uv=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(e){var t=n.getTypeRefTarget();n._eventBus.fire("typeRef.edit",{event:e,element:t})},n.onContextmenu=function(e){var t=n.props.element,r=t;Nt(t,"dmn:LiteralExpression")&&(r=t.$parent),n._eventBus.fire("cell.contextmenu",{event:e,node:e.node,id:r.id})},n.onElementsChanged=function(){n.forceUpdate()},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Fv(t,[{key:"componentWillMount",value:function(){var e=this.context.injector;this._changeSupport=this.context.changeSupport,this._sheet=e.get("sheet"),this._eventBus=e.get("eventBus");var t=this.getTypeRefTarget();this._changeSupport.onElementsChanged(t.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getTypeRefTarget();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getTypeRefTarget",value:function(){var e=this.props.element;return Nt(e,"dmn:InputClause")?e.inputExpression:e}},{key:"render",value:function(){var e=this.props,t=e.element,n=(e.className||"")+" type-ref",r=Nt(t,"dmn:LiteralExpression")?t.$parent.id:t.id;return fl(1,"th",n,t.typeRef,0,{title:"Data Type","data-col-id":r,onClick:this.onClick,onContextmenu:this.onContextmenu})}}]),t}(),zv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Wv=["string","boolean","integer","long","double","date"],Gv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onTypeChange=function(e){var t=r.props.context.element,n=Nt(t,"dmn:LiteralExpression")?t.$parent:t,o=void 0;Vt(n)?o={inputExpression:{typeRef:e}}:Lt(n)&&(o={typeRef:e}),r._modeling.updateProperties(n,o)},r._modeling=n.injector.get("modeling"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),zv(t,[{key:"render",value:function(){var e=this.props.context.element,t=(Nt(e,"dmn:InputClause")?e.inputExpression:e).typeRef,n=Wv.map(function(e){return{label:e,value:e}});return fl(1,"div","type-ref-edit context-menu-container",[fl(1,"label","dms-label",hl("Type:"),2),dl(2,Av,{className:"type-ref-edit-select",onChange:this.onTypeChange,options:n,value:t})],4)}}]),t}();var Hv=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("cell",function(e){var t=e.cellType;if("input-header-type-ref"===t||"output-header-type-ref"===t)return Uv}),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"type-ref-edit"===e.contextMenuType)return Gv}),r.on("typeRef.edit",function(e){var t=e.event,r=e.element,i=t.target,a=st(i,"th",!0).getBoundingClientRect(),s=a.left,c=a.top,u=a.width,l=a.height,p=o.getContainer();n.open({x:s+p.parentNode.scrollLeft,y:c+p.parentNode.scrollTop,width:u,height:l},{contextMenuType:"type-ref-edit",element:r,offset:{x:4,y:4}})})};Hv.$inject=["components","contextMenu","eventBus","renderer"];var qv={__depends__:[nv],__init__:["typeRefEditingProvider"],typeRefEditingProvider:["type",Hv]};var Kv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.postExecuted("updateProperties",function(e){var t=e.context,r=t.element,o=t.properties,i=Vt(r)?o.inputExpression:o;if(i&&i.typeRef&&"string"!==i.typeRef){var a=Nt(r,"dmn:LiteralExpression")?r.$parent:r;n.editAllowedValues(a,null)}}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,fc),t}();Kv.$inject=["eventBus","modeling"];var Xv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Yv="radio",Zv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.getRemoveClickHandler=function(e){return function(t){t.stopPropagation(),r.removeItem(e)}},r.getToggleClickHandler=function(e){return function(t){t.stopPropagation(),r.toggleItem(e)}},r.removeItem=function(e){var t=r.props.onChange,n=r.state.items.filter(function(t){return t!==e});r.setState({items:n}),t&&t(n)},r.toggleItem=function(e){var t=r.props,n=t.onChange,o=t.type,i=r.state.items.map(function(t){return t===e?t.isChecked=!t.isChecked:o===Yv&&(t.isChecked=!1),t});r.setState({items:i}),n&&n(i)};var o=e.items;return r.state={items:o},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Xv(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.items;this.setState({items:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.items,o=t.type,i=["dms-list-component"];n&&i.push(n);var a=function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t}(m(r,"group"));return fl(1,"div",i.join(" "),a.map(function(t){var n=t[0],r=t[1];return fl(1,"div","group",[fl(1,"h4","dms-heading",n,0),fl(1,"ul","items no-wrap",r.map(function(t){return fl(1,"li","item",[o&&fl(64,"input","item-toggle",null,1,{type:o,checked:t.isChecked,onClick:e.getToggleClickHandler(t)}),hl(""),t.value,t.isRemovable&&fl(1,"span","remove dmn-icon-clear",null,1,{title:"Remove item",onClick:e.getRemoveClickHandler(t)})],0)}),0)],4)}),0)}}]),t}();var Jv=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Qv=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=e.validate,i=e.value,a=o?o(i||""):void 0;return r.state={validationWarning:a,value:i},r.onInput=r.onInput.bind(r),r.onKeyDown=r.onKeyDown.bind(r),r.onKeyUp=r.onKeyUp.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Jv(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.validate,n=e.value,r=t?t(n||""):void 0;this.setState({validationWarning:r,value:n})}},{key:"onInput",value:function(e){var t=this.props,n=t.onInput,r=t.validate,o=r?r(e):void 0;this.setState({validationWarning:o,value:e}),"function"==typeof n&&n&&n({isValid:!o,value:e})}},{key:"onKeyDown",value:function(e){var t=e.target.value,n=this.props,r=n.onKeyDown,o=n.validate,i=o?o(t):void 0;"function"==typeof r&&r({isValid:!i,value:t,event:e})}},{key:"onKeyUp",value:function(e){var t=e.target.value,n=this.props,r=n.onKeyUp,o=n.validate,i=o?o(t):void 0;"function"==typeof r&&r({isValid:!i,value:t,event:e})}},{key:"render",value:function(){var e=this.props,t=e.placeholder,n=e.type,r=e.className,o=this.state,i=o.validationWarning,a=o.value,s=["dms-validated-input",r].join(" "),c=[];return i&&c.push("invalid"),fl(1,"div",s,[dl(2,xv,{className:c,onInput:this.onInput,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,placeholder:t||"",type:n,value:a||""}),i&&fl(1,"p","dms-hint dms-validation-warning",i,0)],0)}}]),t}();function ey(e){if(!e||function(e){return""===e}(e.trim()))return{values:[]};var t={values:[]},n="";return e.split(",").forEach(function(e){/^"[^"]*"$/.test((n+=e).trim())?(t.values.push(n.trim()),n=""):n+=","}),n?void 0:t}var ty=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ny=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));ry.call(r),r._modeling=n.injector.get("modeling"),r._changeSupport=n.changeSupport;var o=r.getAllowedValuesTarget(),i=ey(o.inputValues&&o.inputValues.text||o.outputValues&&o.outputValues.text||"");return r.state=i?{values:i.values.map(function(e){return{value:e,isCheckable:!1,isRemovable:!0,group:"Predefined Values"}}),inputValue:""}:{values:null,inputValue:""},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),ty(t,[{key:"componentWillMount",value:function(){var e=this.getAllowedValuesTarget();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getAllowedValuesTarget();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getAllowedValuesTarget",value:function(){var e=this.props.context.element;return Nt(e,"dmn:LiteralExpression")?e.$parent:e}},{key:"render",value:function(){var e=this.props.context.element,t=this.state,n=t.inputValue,r=t.values;return"string"===e.typeRef?fl(1,"div","context-menu-container allowed-values-edit",[fl(1,"hr","dms-hrule"),!oy(r)&&r.length>0&&dl(2,Zv,{items:r,onChange:this.onListChange}),!oy(r)&&!r.length&&fl(1,"div",null,[fl(1,"h4","dms-heading",hl("Predefined Values"),2),fl(1,"span","placeholder",hl("No values"),2)],4),!oy(r)&&fl(1,"p","dms-hint",fl(1,"a","del-values",hl("Clear predefined values."),2,{href:"#",onClick:this.handleRemovePredifinedValuesClick}),2),fl(1,"h4","dms-heading",hl("Add Predefined Values"),2),dl(2,Qv,{onInput:this.onInput,onKeyDown:this.onKeyDown,placeholder:'"value", "value", ...',type:"text",validate:function(e){if(!ey(e))return"Strings must be in double quotes."},value:n})],0):null}}]),t}(),ry=function(){var e=this;this.onElementsChanged=function(){e.forceUpdate()},this.setPredefinedValues=function(t){var n=e.getAllowedValuesTarget();e.setState({values:t}),e._modeling.editAllowedValues(n,t&&function(e){return e.map(function(e){return e.value})}(t))},this.onListChange=function(t){e.setPredefinedValues(t)},this.onInput=function(t){t.isValid;var n=t.value;e.setState({inputValue:n})},this.onKeyDown=function(t){var n=t.isValid,r=t.event;if(13===r.keyCode&&(r.stopPropagation(),r.preventDefault(),n)){var o=e.state,i=o.inputValue,a=o.values,s=ey(i);e.onListChange((a||[]).concat(s.values.map(function(e){return{value:e,isCheckable:!1,isRemovable:!0,group:"Predefined Values"}}))),e.setState({inputValue:""})}},this.handleRemovePredifinedValuesClick=function(t){t.stopPropagation(),e.removePredefinedValues()},this.removePredefinedValues=function(){e.setPredefinedValues(null)}};function oy(e){return null===e}var iy=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("context-menu",500,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"type-ref-edit"===e.contextMenuType)return ny})};iy.$inject=["components"];var ay={__init__:["allowedValuesUpdateBehavior","allowedValuesEditingProvider"],allowedValuesUpdateBehavior:["type",Kv],allowedValuesEditingProvider:["type",iy]},sy=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var cy=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onElementsChanged=function(){r.forceUpdate()},r.handleClick=function(e){e.stopPropagation(),r.add()},r.add=function(){r._eventBus.fire("addInput")},r._sheet=n.injector.get("sheet"),r._eventBus=n.injector.get("eventBus"),r._changeSupport=n.changeSupport,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),sy(t,[{key:"componentWillMount",value:function(){var e=this.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getRoot();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getRoot",value:function(){return this._sheet.getRoot()}},{key:"render",value:function(){var e=this.getRoot().businessObject.input;if(!e||!e.length)return null;var t=e.length;return fl(1,"th","input-cell inputs-label actionable add-input header",[hl("Input "),fl(1,"span","add-input dmn-icon-plus action-icon",null,1,{title:"Add Input"})],4,{onClick:this.handleClick,colspan:t})}}]),t}(),uy=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ly=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onElementsChanged=function(){r.forceUpdate()},r.handleClick=function(e){e.stopPropagation(),r.add()},r.add=function(){r._eventBus.fire("addOutput")},r._sheet=n.injector.get("sheet"),r._eventBus=n.injector.get("eventBus"),r._changeSupport=n.changeSupport,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),uy(t,[{key:"componentWillMount",value:function(){var e=this.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.getRoot();this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"getRoot",value:function(){return this._sheet.getRoot()}},{key:"render",value:function(){var e=this.getRoot().businessObject.output.length;return fl(1,"th","output-cell outputs-label add-output actionable header",[hl("Output "),fl(1,"span","add-output dmn-icon-plus action-icon",null,1,{title:"Add Output"})],4,{onClick:this.handleClick,colspan:e})}}]),t}();function py(e,t,n){e.onGetComponent("cell",function(e){var t=e.cellType;return"input-label"===t?cy:"output-label"===t?ly:void 0}),n.on("addInput",function(){t.trigger("addInput")}),n.on("addOutput",function(){t.trigger("addOutput")})}py.$inject=["components","editorActions","eventBus"];var fy={__depends__:[{__depends__:[wh],__init__:["addInputOutputProvider"],addInputOutputProvider:["type",py]},ay,nv,zh,qv],__init__:["inputEditingProvider","outputEditingProvider"],inputEditingProvider:["type",$v],outputEditingProvider:["type",Sv]},dy=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var hy=".dmn-decision-table-container td,\n   .dmn-decision-table-container th",vy=function(){function e(t,n,r,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handleDragOver=function(e){yy(e);var t=e.target,n=st(t,hy,!0),r=!!n,o=i._dragContext.hoverEl;o&&o!==n&&(i._emit("dragAndDrop.dragLeave",e),i._dragContext.targetEl=null,i._dragContext.hoverEl=null),n&&(n!==o&&(i._dragContext.hoverEl=n,!1!==(r=i._emit("dragAndDrop.dragEnter",e))&&(i._dragContext.targetEl=n)),r=i._emit("dragAndDrop.dragOver",e)),e.dataTransfer.dropEffect=!1!==r?"move":"none"},this.handleDrop=function(e){yy(e);var t=i._emit("dragAndDrop.drop",e);if(t){var n=i._dragContext.draggedElement;if(n instanceof Du){var r=i._sheet.getRoot().rows.indexOf(t);i._modeling.moveRow(n,r)}else if(n instanceof Iu){var o=i._sheet.getRoot().cols.indexOf(t);i._modeling.moveCol(n,o)}}i.handleDragEnd(e)},this.handleDragEnd=function(e){yy(e),i._unbindListeners(),i._emit("dragAndDrop.dragEnd",e),i._dragContext=null},this._eventBus=t,this._renderer=n,this._modeling=r,this._sheet=o,this._dragContext=null,t.on("table.destroy",function(){i._unbindListeners()})}return dy(e,[{key:"_bindListeners",value:function(){pt.bind(document,"dragover",this.handleDragOver),pt.bind(document,"drop",this.handleDrop),pt.bind(document,"dragend",this.handleDragEnd)}},{key:"_unbindListeners",value:function(){pt.unbind(document,"dragover",this.handleDragOver),pt.unbind(document,"drop",this.handleDrop),pt.unbind(document,"dragend",this.handleDragEnd)}},{key:"_emit",value:function(e,t){return this._eventBus.fire(e,{dragContext:this._dragContext,originalEvent:t})}},{key:"startDrag",value:function(e,t){yy(t,!0),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData&&t.dataTransfer.setData("text","__DUMMY"),this._dragContext={draggedElement:e},this._bindListeners(),this._emit("dragAndDrop.dragStart",t)}}]),e}();function yy(e,t){e.stopPropagation(),!0!==t&&e.preventDefault()}vy.$inject=["eventBus","renderer","modeling","sheet"];var my={__init__:["dragAndDrop"],dragAndDrop:["type",vy]},gy=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var by="top",_y="right",wy="bottom",xy="left",Cy=function(){function e(t,n,r,o,i,a,s){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._cleanup=function(){var e=c._renderer.getContainer();ky(e),function(e){p(wt(".dragged",e),function(e){Py(e)&&et(e).remove("dragged")})}(e),c._dragImage&&(xt(c._dragImage),c._dragImage=null)},this._elementRegistry=n,this._dragAndDrop=o,this._renderer=i,this._rules=a,this._sheet=s,t.onGetComponent("cell-inner",function(e){var t=e.cellType,n=e.col,r=e.row;if("rule-index"===t)return function(){return fl(1,"span","dmn-icon-drag vertical",hl(""),2,{draggable:"true",onDragStart:function(e){return c.startDrag(r,e)},title:"Move rule"})};if("input-cell"===t||"output-cell"===t){var o="Move "+(Vt(n)?"Input":"Output");return function(){return fl(1,"span","dmn-icon-drag horizontal",null,1,{draggable:"true",onDragStart:function(e){return c.startDrag(n,e)},title:o})}}}),r.on("dragAndDrop.dragEnter",function(e){var t=e.dragContext,n=t.draggedElement,r=t.hoverEl;if(n instanceof Du)return!0;if(n instanceof Iu){var o=function(e,t,n){var r=t.get(e.dataset.colId);if(!r)return-1;return n.getRoot().cols.indexOf(r)}(r,c._elementRegistry,c._sheet);return-1!==o&&c._rules.allowed("col.move",{col:n,index:o})}return!1}),r.on("dragAndDrop.dragLeave",function(e){e.dragContext.targetEl&&ky(c._renderer.getContainer())}),r.on("dragAndDrop.dragOver",function(e){var t=e.dragContext,n=e.originalEvent,r=t.draggedElement,o=t.lastPosition,i=t.targetEl,a=c._renderer.getContainer();if(!i)return!1;var s=void 0;return r instanceof Du&&(s=Sy(n,i)),r instanceof Iu&&(s=jy(n,i)),o===s||(ky(a),r instanceof Du&&Ey(i,a,s===by?"top":"bottom"),r instanceof Iu&&Oy(i,a,s===xy?"left":"right"),t.lastPosition=s,!0)}),r.on("dragAndDrop.drop",function(e){var t=e.dragContext,n=e.originalEvent,r=t.draggedElement,o=t.targetEl;if(!o)return!1;if(r instanceof Du){var i=Sy(n,o),a=o.dataset.rowId,s=c._elementRegistry.get(a);if(!s||s===r)return;var u=function(e,t,n,r){r.indexOf(e)>r.indexOf(t)&&(t=function(e,t){var n=t.indexOf(e);return t[Math.min(t.length-1,n+1)]}(t,r));return n===by?function(e,t){var n=t.indexOf(e);return t[Math.max(0,n-1)]}(t,r):t}(r,s,i,c._sheet.getRoot().rows);if(u===r)return;return u}if(r instanceof Iu){var l=jy(n,o),p=o.dataset.colId,f=c._elementRegistry.get(p);if(!f||f===r)return;var d=function(e,t,n,r){r.indexOf(e)>r.indexOf(t)&&(t=function(e,t){var n=t.indexOf(e);if(Vt(e)){var r=t.filter(function(e){return Vt(e)}),o=r[r.length-1],i=t.indexOf(o);return t[Math.min(i,n+1)]}return t[Math.min(t.length-1,n+1)]}(t,r));return n===xy?function(e,t){var n=t.indexOf(e);if(Lt(e)){var r=t.filter(function(e){return Lt(e)})[0],o=t.indexOf(r);return t[Math.max(o,n-1)]}return t[Math.max(0,n-1)]}(t,r):t}(r,f,l,c._sheet.getRoot().cols);if(d===r)return;return d}}),r.on("dragAndDrop.dragEnd",this._cleanup)}return gy(e,[{key:"startDrag",value:function(e,t){var n=this._renderer.getContainer();this._dragImage=ht('<span style="\n          visibility: hidden;\n          position: fixed;\n          top: -10000px\n      "></span>'),document.body.appendChild(this._dragImage),t.dataTransfer.setDragImage&&t.dataTransfer.setDragImage(this._dragImage,0,0),e instanceof Du?function(e,t){p(wt("[data-row-id="+e.id+"]",t),function(e){Py(e)&&et(e).add("dragged")})}(e,n):e instanceof Iu&&function(e,t){p(wt("[data-col-id="+e.id+"]",t),function(e){Py(e)&&et(e).add("dragged")})}(e,n),this._dragAndDrop.startDrag(e,t)}}]),e}();function Ey(e,t,n){var r=e.dataset.rowId;r&&p(wt("[data-row-id="+r+"]",t),function(e){Py(e)&&(et(e).add("dragover"),et(e).add(n))})}function Oy(e,t,n){var r=e.dataset.colId;r&&p(wt("[data-col-id="+r+"]",t),function(e){Py(e)&&(et(e).add("dragover"),et(e).add(n))})}function ky(e){p(wt(".dragover",e),function(e){Py(e)&&(et(e).remove("dragover"),et(e).remove("top"),et(e).remove("right"),et(e).remove("bottom"),et(e).remove("left"))})}function jy(e,t){var n=t.getBoundingClientRect();return e.clientX<n.left+n.width/2?xy:_y}function Sy(e,t){var n=t.getBoundingClientRect();return e.clientY<n.top+n.height/2?by:wy}function Py(e){return e&&(1===e.nodeType||11==e.nodeType)}Cy.$inject=["components","elementRegistry","eventBus","dragAndDrop","renderer","rules","sheet"];var Ty={__depends__:[my,Jd],__init__:["dmnDragAndDrop"],dmnDragAndDrop:["type",Cy]},Ry=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Ay(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function My(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function By(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Dy=function(e){function t(e,n){Ay(this,t);var r=My(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.onElementsChanged=function(){r.forceUpdate()},r.changeDescription=function(e){r._modeling.updateProperties(r._element,{description:e})},r._elementRegistry=n.injector.get("elementRegistry"),r._modeling=n.injector.get("modeling"),r._changeSupport=r.context.changeSupport;var o=r.props.context.id;return r._element=r._elementRegistry.get(o),r}return By(t,Sp),Ry(t,[{key:"componentWillMount",value:function(){this._element&&this._changeSupport.onElementsChanged(this._element.id,this.onElementsChanged)}},{key:"componentDidMount",value:function(){this.props.context.autoFocus&&this.node&&_t(".content-editable",this.node).focus()}},{key:"componentWillUnmount",value:function(){if(this._element){this._changeSupport.offElementsChanged(this._element.id,this.onElementsChanged);var e=this._element.businessObject.description;s(e)&&!e.length&&this.changeDescription(null)}}},{key:"render",value:function(){var e=this;if(this._element){var t=this._element.businessObject.description;if(s(t))return fl(1,"div","context-menu-container description-editor",dl(2,Iy,{className:"dms-input",onChange:this.changeDescription,value:t}),2,null,null,function(t){return e.node=t})}}}]),t}(),Iy=function(e){function t(){return Ay(this,t),My(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return By(t,Mh),Ry(t,[{key:"render",value:function(){return fl(1,"div",this.getClassName(),this.getEditor(),0)}}]),t}();var Ny=26,Vy=function e(t,n,r,o,i,a){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addDescription=function(e){c._modeling.updateProperties(e,{description:""});var t=c._renderer.getContainer(),n=Ly(t,zd(e.id,t).getBoundingClientRect());c._contextMenu.open(n,{contextMenuType:"cell-description",id:e.id,autoFocus:!0,offset:{x:4,y:4}})},this.removeDescription=function(e){c._modeling.updateProperties(e,{description:null}),c._contextMenu.close()},this._contextMenu=n,this._modeling=i,this._renderer=a,o.on("cell.click",750,function(e){if(!e.defaultPrevented){var t=e.target,o=e.id,i=r.get(o);if(i){$y(i)||e.preventDefault();var s=Ly(a.getContainer(),t.getBoundingClientRect());n.open(s,{contextMenuType:"cell-description",autoFocus:!1,id:o,offset:{x:4,y:4}})}}}),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"cell-description"===e.contextMenuType&&s($y(r.get(e.id))))return Dy}),t.onGetComponent("context-menu-cell-additional",500,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"context-menu"===e.contextMenuType){var t=e.id;if(!t)return;var n=r.get(t);if(!n)return;var o=n.businessObject.description,i=s(o),a=i?function(){return c.removeDescription(n)}:function(){return c.addDescription(n)};return fl(1,"div","context-menu-group-entry "+(i?"remove-description":"add-description"),[fl(1,"span","context-menu-group-entry-icon "+(i?"dmn-icon-clear":"dmn-icon-plus")),s(o)?"Remove":"Add",hl(" Description")],0,{onClick:a})}})};function Ly(e,t){var n=t.top,r=t.left,o=t.width,i=t.height;return{x:r+e.parentNode.scrollLeft-Ny,y:n+e.parentNode.scrollTop,width:o+2*Ny,height:i}}function $y(e){return e&&e.businessObject&&e.businessObject.description}Vy.$inject=["components","contextMenu","elementRegistry","eventBus","modeling","renderer"];var Fy={__depends__:[nv,xd],__init__:["description"],description:["type",Vy]},Uy=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var zy=[{label:"FEEL",value:"feel"},{label:"JUEL",value:"juel"},{label:"JavaScript",value:"javascript"},{label:"Groovy",value:"groovy"},{label:"Python",value:"python"},{label:"JRuby",value:"jruby"}],Wy=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._modeling=r,t.onGetComponent("context-menu-cell-additional",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"context-menu"===e.contextMenuType){var t=e.id;if(!t)return;var r=n.get(t);if(!r)return;var i=r.businessObject.expressionLanguage||(Vt(r.col)?"feel":"juel");return fl(1,"div","context-menu-group-entry context-menu-entry-set-expression-language",[fl(1,"div",null,[fl(1,"span","context-menu-group-entry-icon dmn-icon-file-code"),hl("Expression Language")],4),dl(2,Av,{className:"expression-language",onChange:function(e){return o.onChange(r,e)},options:zy,value:i})],4)}})}return Uy(e,[{key:"onChange",value:function(e,t){this._modeling.editExpressionLanguage(e.businessObject,t)}}]),e}();Wy.$inject=["components","elementRegistry","modeling"];var Gy={__init__:["expressionLanguage"],expressionLanguage:["type",Wy]},Hy=/\s/,qy=/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i,Ky=/^[a-z_][\w-.]*$/i,Xy=/\$\{([^}]*)\}/g;function Yy(e,t){var n=e.$model.ids.assigned(t);return!t||n&&n!==e?"Element must have an unique id.":function(e){if(t=e=function(e){return e.replace(Xy,"$1")}(e),Hy.test(t))return"Id must not contain spaces.";var t;if(!Ky.test(e))return qy.test(e)?"Id must not contain prefix.":"Id must be a valid QName."}(t)}var Zy=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Jy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qy(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function em(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var tm=function(e){function t(e,n){Jy(this,t);var r=Qy(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onElementsChanged=function(){r.forceUpdate()},r.setDecisionTableName=function(e){r.modeling.editDecisionTableName(e)},r.setDecisionTableId=function(e){var t=r.getBusinessObject().id;t!==e&&(r.setupChangeListeners({bind:e,unbind:t}),r.modeling.editDecisionTableId(e))},r.validateId=function(e){return Yy(r.getBusinessObject(),e)},Kp(r),r}return em(t,Sp),Zy(t,[{key:"componentWillMount",value:function(){var e=this.context.injector;this.sheet=e.get("sheet"),this.modeling=e.get("modeling"),this.setupChangeListeners({bind:this.getBusinessObject().id})}},{key:"componentWillUnmount",value:function(){this.setupChangeListeners({unbind:this.getBusinessObject().id})}},{key:"setupChangeListeners",value:function(e){var t=e.bind,n=e.unbind;"string"==typeof n&&this.changeSupport.offElementsChanged(n,this.onElementsChanged),"string"==typeof t&&this.changeSupport.onElementsChanged(t,this.onElementsChanged)}},{key:"getBusinessObject",value:function(){return this.sheet.getRoot().businessObject.$parent}},{key:"render",value:function(){var e=this.getBusinessObject(),t=e.id,n=e.name;return fl(1,"header","decision-table-properties",[dl(2,nm,{className:"decision-table-name",value:n,ctrlForNewline:!0,onChange:this.setDecisionTableName,elementId:"__decisionProperties_name",coords:"0:__decisionProperties"}),dl(2,rm,{className:"decision-table-id",value:t,ctrlForNewline:!0,validate:this.validateId,onChange:this.setDecisionTableId,elementId:"__decisionProperties_id",coords:"1:__decisionProperties"})],4)}}]),t}();tm.$inject=["sheet","modeling","changeSupport"];var nm=function(e){function t(e,n){Jy(this,t);var r=Qy(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Yp(r,Zp),r}return em(t,Mh),Zy(t,[{key:"render",value:function(){return fl(1,"h3",qp(this.getSelectionClasses(),this.getClassName()),this.getEditor(),0,{"data-element-id":this.props.elementId,"data-coords":this.props.coords,title:"Decision Name"})}}]),t}(),rm=function(e){function t(e,n){Jy(this,t);var r=Qy(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Yp(r,Zp),r}return em(t,Mh),Zy(t,[{key:"render",value:function(){return fl(1,"h5",qp(this.getSelectionClasses(),this.getClassName()),this.getEditor(),0,{title:"Decision Id","data-element-id":this.props.elementId,"data-coords":this.props.coords})}}]),t}();var om=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("table.before",function(){return tm})};om.$inject=["components"];var im={__depends__:[zh],__init__:["decisionTableProperties"],decisionTableProperties:["type",om]},am=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var sm=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onClick=function(e){r.eventBus.fire("hitPolicy.edit",{event:e})},r.onElementsChanged=function(){r.forceUpdate()},Kp(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),am(t,[{key:"getRoot",value:function(){return this.sheet.getRoot()}},{key:"componentWillMount",value:function(){this.changeSupport.onElementsChanged(this.getRoot().id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){this.changeSupport.offElementsChanged(this.getRoot().id,this.onElementsChanged)}},{key:"render",value:function(){var e=this.getRoot().businessObject,t=e.hitPolicy;return fl(1,"th","hit-policy header",[t.charAt(0),function(e){switch(e){case"SUM":return"+";case"MIN":return"<";case"MAX":return">";case"COUNT":return"#";default:return""}}(e.aggregation)],0,{"data-hit-policy":"true",title:"Hit Policy = "+t,onClick:this.onClick,rowspan:"3"})}}]),t}();sm.$inject=["changeSupport","sheet","eventBus"];var cm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var um=["UNIQUE","FIRST","PRIORITY","ANY","COLLECT","RULE ORDER","OUTPUT ORDER"],lm=["SUM","MIN","MAX","COUNT"],pm=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onHitPolicyChange=r.onHitPolicyChange.bind(r),r.onAggregationChange=r.onAggregationChange.bind(r),r.onElementsChanged=r.onElementsChanged.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),cm(t,[{key:"onHitPolicyChange",value:function(e){this._modeling.editHitPolicy(e,void 0)}},{key:"onAggregationChange",value:function(e){var t=""===e?void 0:e;this._modeling.editHitPolicy("COLLECT",t)}},{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"componentWillMount",value:function(){var e=this.context.injector,t=this._changeSupport=this.context.changeSupport;this._sheet=e.get("sheet"),this._modeling=e.get("modeling");var n=this._sheet.getRoot(),r=n.businessObject,o=r.hitPolicy,i=r.aggregation;t.onElementsChanged(n.id,this.onElementsChanged),this.state={hitPolicy:o,aggregation:i}}},{key:"componentWillUnmount",value:function(){var e=this._sheet.getRoot();this._changeSupport.onElementsChanged(e.id,this.onElementsChanged)}},{key:"render",value:function(){var e=this._sheet.getRoot().businessObject,t=e.hitPolicy,n=e.aggregation,r=um.map(function(e){return{label:e,value:e}}),o=lm.map(function(e){return{label:"NONE"===e?"-":e,value:e}});return fl(1,"div","context-menu-container hit-policy-edit",[fl(1,"p","hit-policy-edit-policy",[fl(1,"label","dms-label",hl("Hit Policy:"),2),dl(2,Av,{className:"hit-policy-edit-policy-select",onChange:this.onHitPolicyChange,options:r,value:t})],4),"COLLECT"===t&&fl(1,"p","hit-policy-edit-operator",[fl(1,"label","dms-label",hl("Aggregation:"),2),dl(2,Av,{className:"hit-policy-edit-operator-select",onChange:this.onAggregationChange,options:o,value:n})],4)],0)}}]),t}();function fm(e,t,n,r){e.onGetComponent("cell",function(e){if("before-label-cells"===e.cellType)return sm}),e.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"hit-policy-edit"===e.contextMenuType)return pm}),n.on("hitPolicy.edit",function(e){var n=e.event,o=st(n.target,"th",!0).getBoundingClientRect(),i=o.left,a=o.top,s=o.width,c=o.height,u=r.getContainer();t.open({x:i+u.parentNode.scrollLeft,y:a+u.parentNode.scrollTop,width:s,height:c},{contextMenuType:"hit-policy-edit",offset:{x:4,y:4}})})}fm.$inject=["components","contextMenu","eventBus","renderer"];var dm={__depends__:[nv],__init__:["hitPolicyProvider"],hitPolicyProvider:["type",fm]},hm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var vm=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._init=function(){o._registerDefaultBindings(),o._fire("init")},this._destroy=function(){o._fire("destroy"),o.unbind(),o._listeners=null},this._keyHandler=function(e){var t,n,r=o._listeners,i=e.keyCode||e.charCode||-1;for(t=0;n=r[t];t++)if(n(i,e))return e.preventDefault(),void e.stopPropagation()},this.unbind=function(){var e=o._node;e&&(o._fire("unbind"),pt.unbind(e,"keydown",o._keyHandler,!0)),o._node=null},this._config=t||{},this._editorActions=r,this._eventBus=n,this._listeners=[],n.on("table.destroy",this._destroy),n.on("table.init",this._init),n.on("attach",function(){o._config.bindTo&&o.bind(t.bindTo)}),n.on("detach",this.unbind)}return hm(e,[{key:"bind",value:function(e){this.unbind(),this._node=e,pt.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")}},{key:"getBinding",value:function(){return this._node}},{key:"_fire",value:function(e){this._eventBus.fire("keyboard."+e,{node:this._node,listeners:this._listeners})}},{key:"_registerDefaultBindings",value:function(){var e=this._listeners,t=this._editorActions;e.push(function(e,n){if(rv(n)&&!ov(n)&&90===e)return t.trigger("undo"),!0}),e.push(function(e,n){if(rv(n)&&(89===e||90===e&&ov(n)))return t.trigger("redo"),!0}),e.push(function(e,n){if(13===e&&!rv(n)&&Wd(n.target)){var r=ov(n)?"selectCellAbove":"selectCellBelow";return t.trigger(r),!0}})}},{key:"addListener",value:function(e){this._listeners.unshift(e)}},{key:"removeListener",value:function(e){this._listeners=this._listeners.filter(function(t){return t!==e})}}]),e}();vm.$inject=["config.keyboard","eventBus","editorActions"];var ym={__depends__:[wh],__init__:["keyboard"],keyboard:["type",vm]},mm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var gm=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.executed(["row.add","row.remove","col.add","col.remove"],bm(function(e){var t=e.context,n=t.row||t.col;r.updateRoot(n,t.oldRoot)})),r.reverted(["row.add","row.remove","col.add","col.remove"],bm(function(e){var t=e.context,n=t.row||t.col;r.updateRoot(n,t.newRoot)})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,fc),mm(t,[{key:"updateRoot",value:function(e,t){var n=this,r=e.root,o=e.businessObject;if(Nt(e,"dmn:DecisionRule")){if(t){var i=t.businessObject.get("rule"),a=i.indexOf(o);i.splice(a,1),o.$parent=null}if(r){var s=r.businessObject,c=r.rows.indexOf(e);s.get("rule").splice(c,0,o),o.$parent=s,e.cells.forEach(function(t,r){n.wireCell(t,e,r)})}}if(Nt(e,"dmn:InputClause")||Nt(e,"dmn:OutputClause")){var u=void 0,l=void 0;if(t){var p=t.businessObject,f=p.get("input"),d=p.get("output");if(Nt(e,"dmn:InputClause")&&(u=f,l=f.indexOf(o)),Nt(e,"dmn:OutputClause")&&(u=d,l=d.indexOf(o)),-1===l)throw new Error("inconsistent model: clause not in table");u.splice(l,1),o.$parent=null,e.cells.forEach(function(e,r){n.unwireCell(e,t.rows[r])})}if(r){var h=r.businessObject,v=h.get("input"),y=h.get("output"),m=r.cols.indexOf(e),g=void 0,b=void 0;Nt(e,"dmn:InputClause")&&(b=v,g=m),Nt(e,"dmn:OutputClause")&&(b=y,g=m-v.length),b.splice(g,0,o),o.$parent=h,e.cells.forEach(function(e,t){n.wireCell(e,r.rows[t],m)})}}}},{key:"unwireCell",value:function(e,t){var n,r=e.businessObject,o=t.businessObject,i=o.get("inputEntry"),a=o.get("outputEntry"),s=void 0;if(Nt(e,"dmn:UnaryTests")&&(s=i),Nt(e,"dmn:LiteralExpression")&&(s=a),-1===(n=s.indexOf(r)))throw new Error("cell not in row");s.splice(n,1),r.$parent=null}},{key:"wireCell",value:function(e,t,n){var r=e.businessObject,o=t.businessObject,i=o.get("inputEntry"),a=o.get("outputEntry"),s=void 0,c=void 0;r.$parent!==o&&(Nt(e,"dmn:UnaryTests")&&(s=i,c=n),Nt(e,"dmn:LiteralExpression")&&(s=a,c=n-i.length),s.splice(c,0,r),r.$parent=o)}}]),t}();function bm(e){return function(t){var n=t.context;Nt(n.row||n.col,"dmn:DMNElement")&&e(t)}}gm.$inject=["eventBus","sheet"];var _m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var wm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._model=t}return _m(e,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._model.create(e,t||{});return Nt(n,"dmn:InputClause")&&(t.inputExpression?n.inputExpression=t.inputExpression:(n.inputExpression=this.create("dmn:LiteralExpression",{typeRef:"string"}),n.inputExpression.$parent=n)),Nt(n,"dmn:OutputClause")&&(n.typeRef=t.typeRef||"string"),(Nt(n,"dmn:UnaryTests")||Nt(n,"dmn:LiteralExpression"))&&(n.text=t.text||""),this._ensureId(n),n}},{key:"_needsId",value:function(e){return Nt(e,"dmn:DMNElement")}},{key:"_ensureId",value:function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))}}]),e}();wm.$inject=["moddle"];var xm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Em=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._dmnFactory=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Fu),Cm(t,[{key:"create",value:function(e,n){var r=this._dmnFactory,o=n.businessObject,i=n.type,a=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(n,["businessObject","type"]);if(!o){if(!i){if("root"===e)i="dmn:DecisionTable";else if("cell"===e){var s=a.col;Nt(s,"dmn:OutputClause")&&(i="dmn:LiteralExpression"),Nt(s,"dmn:InputClause")&&(i="dmn:UnaryTests")}if(!i)throw new Error("cannot guess <type>")}o=r.create(i)}return function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"create",this).call(this,e,xm({businessObject:o,id:o.id},a))}}]),t}();Em.$inject=["dmnFactory"];var Om=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var km="id",jm=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.executed("updateProperties",n.updateIds.bind(n)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,fc),Om(t,[{key:"updateIds",value:function(e){var t=e.context,n=t.element,r=t.oldProperties,o=t.properties;Nt(n,"dmn:DRGElement")&&function(e,t){return km in e&&km in t}(r,o)&&function(e){return e.$parent.drgElements}(n).forEach(function(e){var t,n,i;t=e,n=r.id,i=o.id,p({authorityRequirement:function(){t.authorityRequirement.forEach(function(e){var t=e.requiredAuthority,r=e.requiredDecision,o=e.requiredInput;t&&t.href==="#"+n&&(t.href="#"+i),r&&r.href==="#"+n&&(r.href="#"+i),o&&o.href==="#"+n&&(o.href="#"+i)})},informationRequirement:function(){t.informationRequirement.forEach(function(e){var t=e.requiredDecision,r=e.requiredInput;t&&t.href==="#"+n&&(t.href="#"+i),r&&r.href==="#"+n&&(r.href="#"+i)})},knowledgeRequirement:function(){t.knowledgeRequirement.forEach(function(e){var t=e.requiredKnowledge;t&&t.href==="#"+n&&(t.href="#"+i)})}},function(e,n){t[n]&&e()}),function(e,t,n){e.extensionElements&&e.extensionElements.values.forEach(function(e){Nt(e,"biodi:Edge")&&e.source===t&&(e.source=n)})}(e,r.id,o.id)})}}]),t}();jm.$inject=["eventBus"];var Sm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Pm=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sheet=t,this._elementFactory=n}return Sm(e,[{key:"execute",value:function(e){var t=this._sheet,n=this._elementFactory,r=t.getRoot(),o=e.row,i=e.index;return void 0===i&&(i=e.index=r.rows.length),e.newRoot=r,o.cells.length||r.cols.forEach(function(e,t){var r=n.create("cell",{row:o,col:e});o.cells[t]=r}),t.addRow(o,i),t.getRoot()}},{key:"revert",value:function(e){var t=e.row,n=this._sheet;return n.removeRow(t),n.getRoot()}}]),e}();Pm.$inject=["sheet","elementFactory"];var Tm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Rm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sheet=t}return Tm(e,[{key:"execute",value:function(e){var t=this._sheet,n=t.getRoot(),r=e.row,o=e.oldIndex=n.rows.indexOf(r);if(e.oldRoot=r.root,-1===o)throw new Error("row#"+r.id+" not in sheet");return t.removeRow(r),t.getRoot()}},{key:"revert",value:function(e){var t=e.row,n=e.oldIndex,r=this._sheet;return r.addRow(t,n),r.getRoot()}}]),e}();Rm.$inject=["sheet"];var Am=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Mm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._modeling=t}return Am(e,[{key:"preExecute",value:function(e){var t=e.row;this._modeling.removeRow(t)}},{key:"postExecute",value:function(e){var t=e.row,n=e.index;this._modeling.addRow(t,n)}}]),e}();Mm.$inject=["modeling"];var Bm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Dm=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sheet=t,this._elementFactory=n}return Bm(e,[{key:"execute",value:function(e){var t=this._sheet,n=this._elementFactory,r=t.getRoot(),o=e.col,i=e.index;return void 0===i&&(i=e.index=r.cols.length),e.newRoot=r,o.cells.length||r.rows.forEach(function(e,t){var r=n.create("cell",{row:e,col:o});o.cells[t]=r}),t.addCol(o,i),t.getRoot()}},{key:"revert",value:function(e){var t=e.col,n=this._sheet;return n.removeCol(t),n.getRoot()}}]),e}();Dm.$inject=["sheet","elementFactory"];var Im=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Nm=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sheet=t,this._elementFactory=n}return Im(e,[{key:"execute",value:function(e){var t=this._sheet,n=e.col,r=e.oldRoot=n.root;if(-1===(e.oldIndex=r.cols.indexOf(n)))throw new Error("col#"+n.id+" not in sheet");return t.removeCol(n),t.getRoot()}},{key:"revert",value:function(e){var t=e.col,n=e.oldIndex,r=this._sheet;return r.addCol(t,n),r.getRoot()}}]),e}();Nm.$inject=["sheet","elementFactory"];var Vm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Lm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._modeling=t}return Vm(e,[{key:"preExecute",value:function(e){var t=e.col;this._modeling.removeCol(t)}},{key:"postExecute",value:function(e){var t=e.col,n=e.index;this._modeling.addCol(t,n)}}]),e}();Lm.$inject=["modeling"];var $m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Fm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return $m(e,[{key:"execute",value:function(e){return e.cell}},{key:"revert",value:function(e){return e.cell}}]),e}(),Um=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Wm=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventBus=t,this._elementFactory=n,this._commandStack=r,t.on("table.init",function(){!function(e,t){p(e,function(e,n){t.registerHandler(n,e)})}(o.getHandlers(),r)})}return zm(e,[{key:"getHandlers",value:function(){return e._getHandlers()}},{key:"_create",value:function(e,t){return t instanceof Mu?t:this._elementFactory.create(e,t)}},{key:"addRow",value:function(e,t){var n=this._create("row",e),r={row:n,index:t};return this._commandStack.execute("row.add",r),n}},{key:"removeRow",value:function(e){this._commandStack.execute("row.remove",{row:e})}},{key:"moveRow",value:function(e,t){var n={row:e,index:t};this._commandStack.execute("row.move",n)}},{key:"addCol",value:function(e,t){var n=this._create("col",e),r={col:n,index:t};return this._commandStack.execute("col.add",r),n}},{key:"removeCol",value:function(e){this._commandStack.execute("col.remove",{col:e})}},{key:"moveCol",value:function(e,t){var n={col:e,index:t};this._commandStack.execute("col.move",n)}},{key:"editCell",value:function(e,t){var n=Um({cell:e},t);this._commandStack.execute("cell.edit",n)}}],[{key:"_getHandlers",value:function(){return{"row.add":Pm,"row.remove":Rm,"row.move":Mm,"col.add":Dm,"col.remove":Nm,"col.move":Lm,"cell.edit":Fm}}}]),e}();Wm.$inject=["eventBus","elementFactory","commandStack"];var Gm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Hm=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dmnFactory=t,this._moddle=n,this._modeling=r}return Gm(e,[{key:"execute",value:function(e){var t=e.element,n=e.allowedValues;return Nt(t,"dmn:InputClause")?(t.inputValues?e.oldAllowedValues=t.inputValues.text:qm(n)||(t.inputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),qm(n)?t.inputValues&&delete t.inputValues:t.inputValues.text=n.join(",")):(t.outputValues&&t?e.oldAllowedValues=t.outputValues.text:qm(n)||(t.outputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),qm(n)?t.outputValues&&delete t.outputValues:t.outputValues.text=n.join(",")),t}},{key:"revert",value:function(e){var t=e.element,n=e.oldAllowedValues;return Nt(t,"dmn:InputClause")?n?(t.inputValues||(t.inputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),t.inputValues.text=n):delete t.inputValues:n?(t.outputValues||(t.outputValues=this._dmnFactory.create("dmn:UnaryTests",{text:""})),t.outputValues.text=n):delete t.outputValues,t}}]),e}();function qm(e){return null===e}Hm.$inject=["dmnFactory","moddle","modeling"];var Km=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xm=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Ym(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zm(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Jm="id",Qm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._moddle=t}return Xm(e,[{key:"execute",value:function(e){var t=e.element,n=e.properties,r=$t(t),o=this.updateProperties(r,n),i=o.changed,a=o.oldProperties;return e.oldProperties=a,[].concat(Zm(i),[t])}},{key:"revert",value:function(e){var t=e.element,n=e.oldProperties,r=$t(t),o=this.updateProperties(r,n).changed;return[].concat(Zm(o),[t])}},{key:"updateProperties",value:function(e,t){var n,r,o=this,i=this._moddle.ids;return r=t,Jm in(n=e)&&n[Jm]!==r[Jm]&&(i.unclaim(e[Jm]),i.claim(t[Jm],e)),f(t,function(t,n,r){var i=e.get(r);if(eg(n)){if(!eg(i))throw new Error("non-existing property <"+r+">: cannot update values");var a=o.updateProperties(i,n),s=a.changed,c=a.oldProperties;return{changed:[].concat(Zm(t.changed),Zm(s),[i]),oldProperties:Km({},t.oldProperties,Ym({},r,c))}}return e.set(r,n),{changed:t.changed,oldProperties:Km({},t.oldProperties,Ym({},r,i))}},{changed:[],oldProperties:{}})}}]),e}();function eg(e){return(null!==(t=e)||void 0!==t)&&o(e);var t}Qm.$inject=["moddle"];var tg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ng=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._moddle=t}return tg(e,[{key:"execute",value:function(e){var t=this._moddle.ids,n=e.id,r=e.element;e.claiming?t.claim(n,r):t.unclaim(n)}},{key:"revert",value:function(e){var t=this._moddle.ids,n=e.id,r=e.element;e.claiming?t.unclaim(n):t.claim(n,r)}}]),e}();ng.$inject=["moddle"];var rg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var og=function(e){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));return i._eventBus=e,i._elementFactory=n,i._commandStack=r,i._sheet=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Wm),rg(t,[{key:"getHandlers",value:function(){return t._getHandlers()}},{key:"editDecisionTableName",value:function(e){var t={element:this._sheet.getRoot().businessObject.$parent,properties:{name:e}};this._commandStack.execute("updateProperties",t)}},{key:"editDecisionTableId",value:function(e){var t={element:this._sheet.getRoot().businessObject.$parent,properties:{id:e}};this._commandStack.execute("updateProperties",t)}},{key:"editHitPolicy",value:function(e,t){var n={element:this._sheet.getRoot().businessObject,properties:{hitPolicy:e,aggregation:t}};this._commandStack.execute("updateProperties",n)}},{key:"updateProperties",value:function(e,t){var n={element:e,properties:t};this._commandStack.execute("updateProperties",n)}},{key:"editInputExpression",value:function(e,t){var n={element:e,properties:t};this._commandStack.execute("updateProperties",n)}},{key:"editOutputName",value:function(e,t){var n={element:e,properties:{name:t}};this._commandStack.execute("updateProperties",n)}},{key:"editInputExpressionTypeRef",value:function(e,t){var n={element:e,properties:{typeRef:t}};this._commandStack.execute("updateProperties",n)}},{key:"editOutputTypeRef",value:function(e,t){var n={element:e,properties:{typeRef:t}};this._commandStack.execute("updateProperties",n)}},{key:"editCell",value:function(e,t){var n={element:e,properties:{text:t}};this._commandStack.execute("updateProperties",n)}},{key:"editAnnotation",value:function(e,t){var n={element:e,properties:{description:t}};this._commandStack.execute("updateProperties",n)}},{key:"editAllowedValues",value:function(e,t){var n={element:e,allowedValues:t};this._commandStack.execute("editAllowedValues",n)}},{key:"editExpressionLanguage",value:function(e,t){var n={element:e,properties:{expressionLanguage:t}};this._commandStack.execute("updateProperties",n)}},{key:"claimId",value:function(e,t){var n={id:e,element:t,claiming:!0};this._commandStack.execute("id.updateClaim",n)}},{key:"unclaimId",value:function(e,t){var n={id:e,element:t};this._commandStack.execute("id.updateClaim",n)}}],[{key:"_getHandlers",value:function(){return S({},function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0}(t.__proto__||Object.getPrototypeOf(t),"_getHandlers",this).call(this),{editAllowedValues:Hm,updateProperties:Qm,"id.updateClaim":ng})}}]),t}();og.$inject=["eventBus","elementFactory","commandStack","sheet"];var ig=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ag=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o._ids=n.ids,o._modeling=r,o.preExecute(["row.add","col.add"],function(e){var t=e.context,n=t.row||t.col;o.claimId(n.businessObject),n.cells&&n.cells.forEach(function(e){return o.claimId(e.businessObject)})}),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,fc),ig(t,[{key:"claimId",value:function(e){var t=this;e.id&&!this._ids.assigned(e.id)&&this._modeling.claimId(e.id,e),e.$descriptor.properties.forEach(function(n){var o=e[n.name];o&&(r(o)&&o.forEach(function(e){return t.claimId(e)}),o.$type&&t.claimId(o))})}}]),t}();ag.$inject=["eventBus","moddle","modeling"];var sg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var cg=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._modeling=n,r.preExecute(["row.remove","col.remove"],function(e){var t=e.context,n=t.row||t.col;r.unclaimId(n.businessObject),n.cells&&n.cells.forEach(function(e){return r.unclaimId(e.businessObject)})}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,fc),sg(t,[{key:"unclaimId",value:function(e){var t=this;e.id&&this._modeling.unclaimId(e.id,e),e.$descriptor.properties.forEach(function(n){var o=e[n.name];o&&(r(o)&&o.forEach(function(e){return t.unclaimId(e)}),o.$type&&t.unclaimId(o))})}}]),t}();cg.$inject=["eventBus","modeling"];var ug={__init__:["dmnUpdater","idChangeBehavior","modeling"],__depends__:[{__init__:["idClaimBehavior","idUnclaimBehavior"],idClaimBehavior:["type",ag],idUnclaimBehavior:["type",cg]},Zs],dmnUpdater:["type",gm],dmnFactory:["type",wm],elementFactory:["type",Em],idChangeBehavior:["type",jm],modeling:["type",og]},lg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function pg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fg(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function dg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var hg={feel:"FEEL",juel:"JUEL",python:"Python",javascript:"JavaScript",groovy:"Groovy",jruby:"JRuby"},vg=function(e){function t(e,n){pg(this,t);var r=fg(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={isFocussed:!1},r.changeCellValue=r.changeCellValue.bind(r),r.onFocus=r.onFocus.bind(r),r.onBlur=r.onBlur.bind(r),r.onElementsChanged=r.onElementsChanged.bind(r),r}return dg(t,Sp),lg(t,[{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"componentWillMount",value:function(){var e=this.context.injector,t=this.props.cell,n=this._changeSupport=this.context.changeSupport;this._modeling=e.get("modeling"),n.onElementsChanged(t.id,this.onElementsChanged)}},{key:"componentWillUnmount",value:function(){var e=this.props.cell;this._changeSupport.offElementsChanged(e.id,this.onElementsChanged)}},{key:"changeCellValue",value:function(e){var t=this.props.cell;this._modeling.editCell(t.businessObject,e)}},{key:"onFocus",value:function(){this.setState({isFocussed:!0})}},{key:"onBlur",value:function(){this.setState({isFocussed:!1})}},{key:"render",value:function(){var e=this.props,t=e.cell,n=e.rowIndex,r=e.row,o=e.col,i=e.colIndex,a=this.state.isFocussed,s=Nt(t,"dmn:UnaryTests")?"input-cell":"output-cell",c=t.businessObject;return dl(2,rf,{className:s,elementId:t.id,coords:n+":"+i,"data-row-id":r.id,"data-col-id":o.id,children:dl(2,yg,{className:"cell-editor",ctrlForNewline:!0,onFocus:this.onFocus,onBlur:this.onBlur,isFocussed:a,onChange:this.changeCellValue,value:c.text,businessObject:c})})}}]),t}(),yg=function(e){function t(){return pg(this,t),fg(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return dg(t,Mh),lg(t,[{key:"isDefaultExpressionLanguage",value:function(e){var t=e.expressionLanguage,n=Nt(e,"dmn:UnaryTests"),r=this.context.injector.get("config"),o=r.defaultInputExpressionLanguage,i=r.defaultOutputExpressionLanguage;return n?!t&&!o||t===(o||"feel"):!t&&!i||t===(i||"juel")}},{key:"getDescription",value:function(e){return e.description}},{key:"getExpressionLanguageLabel",value:function(e){var t=e.expressionLanguage;return Nt(e,"dmn:UnaryTests")?t?hg[e.expressionLanguage.toLowerCase()]:"FEEL":t?hg[e.expressionLanguage.toLowerCase()]:"JUEL"}},{key:"isScript",value:function(e){return Nt(e,"dmn:UnaryTests")&&("FEEL"!==(e.expressionLanguage||"FEEL")||-1!==e.text.indexOf("\n"))}},{key:"render",value:function(){var e=this.props,t=e.businessObject,n=e.isFocussed,r=this.getDescription(t),o=this.isDefaultExpressionLanguage(t),i=this.getExpressionLanguageLabel(t)||t.expressionLanguage,a=this.isScript(t);return fl(1,"div",this.getClassName(),[s(r)&&!n&&fl(1,"div","description-indicator"),this.getEditor({className:a?"script-editor":null}),!o&&!n&&fl(1,"span","dms-badge dmn-expression-language",[fl(1,"span","dms-badge-icon dmn-icon-file-code"),fl(1,"span","dms-badge-label",i,0)],4,{title:"Expression Language = "+i})],0)}}]),t}();var mg=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("cell",1500,function(e){if("rule"===e.cellType)return vg})};mg.$inject=["components"];var gg={__depends__:[zh,Hf],__init__:["decisionRulesEditor"],decisionRulesEditor:["type",mg]},bg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var _g=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.state={top:0,left:0,isVisible:!1,isDisabled:!0};var o=n.injector,i=r._eventBus=o.get("eventBus"),a=o.get("simpleMode");return r._renderer=o.get("renderer"),r._selection=n.injector.get("selection"),r.updatePosition=r.updatePosition.bind(r),i.on("selection.changed",function(e){var t,n=e.selection;n&&a.canSimpleEdit(n)?(r.setState({isVisible:!0,selection:n},r.updatePosition),t=!function(e,t){if(Vt(e.col))return!t||"feel"===t;if(Lt(e.col))return!t||"juel"===t}(n,n.businessObject.expressionLanguage),r.setState({isVisible:!0,selection:n,isDisabled:t},r.updatePosition)):r.setState({isVisible:!1})}),r.onClick=r.onClick.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),bg(t,[{key:"updatePosition",value:function(){var e=this.state.selection;if(e&&this.node){var t=this._container=this._renderer.getContainer(),n=zd(e.id,t).getBoundingClientRect(),r=this.node.getBoundingClientRect(),o=t.getBoundingClientRect(),i=t.scrollLeft,a=t.scrollTop,s={};n.left+n.width/2>o.width/2?s.left=window.scrollX-o.left+n.left-r.width+4+i+"px":s.left=window.scrollX-o.left+n.left+n.width-4+i+"px",n.top+n.height/2>o.height/2?s.top=window.scrollY-o.top+n.top-r.height+4+a+"px":s.top=window.scrollY-o.top+n.top-4+a+"px",S(this.node.style,s)}}},{key:"onClick",value:function(){if(!this.state.isDisabled){var e=this._selection.get();e&&(this._eventBus.fire("simpleMode.open",{element:e,node:zd(e.id,this._container)}),this.setState({isVisible:!1}))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.isDisabled,r=t.isVisible,o=t.top,i=t.left,a=["simple-mode-button","no-deselect"];return n&&a.push("disabled"),r?fl(1,"div",a.join(" "),fl(1,"span","dmn-icon-edit"),2,{onClick:this.onClick,style:{top:o,left:i},title:n?"Editing not supported for set expression language":"Edit"},null,function(t){return e.node=t}):null}}]),t}();var wg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var xg=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._providers=[],t.onGetComponent("table.before",function(){return _g}),o.on("simpleMode.open",function(e){var t=e.element,r=e.node.getBoundingClientRect(),o=r.left,a=r.top,s=r.width,c=r.height,u=i.getContainer();n.open({x:o+u.parentNode.scrollLeft,y:a+u.parentNode.scrollTop,width:s,height:c},{contextMenuType:"simple-mode-edit",element:t,offset:{x:4,y:4}})}),o.on("cell.click",function(e){var t=e.event,n=e.node,i=e.id;if(function(e){if(e.altKey)return!1;return e.ctrlKey||e.metaKey}(t)){var a=r.get(i);a&&o.fire("simpleMode.open",{node:n,element:a}),e.preventDefault()}})}return wg(e,[{key:"registerProvider",value:function(e){this._providers.push(e)}},{key:"canSimpleEdit",value:function(e){return this._providers.reduce(function(t,n){return t||n(e)},!1)}}]),e}();xg.$inject=["components","contextMenu","elementRegistry","eventBus","renderer"];var Cg={__depends__:[nv,Xd],__init__:["simpleMode"],simpleMode:["type",xg]};var Eg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Og="none",kg=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o,i=r.props.context.element,a=!(o=i.businessObject.text)||function(e){return""===e}(o)?"none":"true"===o.trim()?"true":"false"===o.trim()?"false":void 0;return r.state={value:a||Og},r.editCell=r.editCell.bind(r),r.onChange=r.onChange.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Eg(t,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onChange",value:function(e){var t=this.props.context.element;this.editCell(t.businessObject,e===Og?"":e),this.setState({value:e})}},{key:"render",value:function(){var e=this.state.value,t=[{label:"-",value:Og},{label:"Yes",value:"true"},{label:"No",value:"false"}];return fl(1,"div","simple-boolean-edit context-menu-container",[fl(1,"h3","dms-heading",hl("Edit Boolean"),2),fl(1,"h4","dms-heading",hl("Set Value"),2),dl(2,Av,{noInput:!0,className:"dms-block",onChange:this.onChange,options:t,value:e})],4)}}]),t}();var jg=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.registerProvider(function(e){return(Vt(e.col)||Lt(e.col))&&"boolean"===Sg(e)}),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"simple-mode-edit"===e.contextMenuType){if(!e.element)return;if("boolean"===Sg(e.element))return kg}})};function Sg(e){return Vt(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}jg.$inject=["components","simpleMode"];var Pg={__depends__:[ym,Cg],__init__:["simpleBooleanEdit"],simpleBooleanEdit:["type",jg]},Tg=/^\d{4}(?:-\d\d){2}T(?:\d\d:){2}\d\d$/,Rg=/^\[date and time\("(\d{4}(?:-\d\d){2}T(?:\d\d:){2}\d\d)"\)..date and time\("(\d{4}(?:-\d\d){2}T(?:\d\d:){2}\d\d)"/,Ag=/^(<|>)\s*date and time\("(\d{4}(?:-\d\d){2}T(?:\d\d:){2}\d\d)"\)/,Mg=/^date and time\("(\d{4}(?:-\d\d){2}T(?:\d\d:){2}\d\d)"\)$/,Bg="exact",Dg="before",Ig="after",Ng="between";function Vg(e){if(!Tg.test(e.trim()))return"Date must match pattern yyyy-MM-ddTHH:mm:ss."}function Lg(e,t){return e===Bg?'date and time("'+t[0]+'")':e===Dg?'< date and time("'+t[0]+'")':e===Ig?'> date and time("'+t[0]+'")':e===Ng?'[date and time("'+t[0]+'")..date and time("'+t[1]+'")]':void 0}function $g(){var e=new Date;return e.setUTCHours(0,0,0,0),e.toISOString().slice(0,-5)}function Fg(e){if(!e||""===e.trim())return{type:"exact",date:""};var t=e.match(Rg);return t?{type:"between",dates:[t[1],t[2]]}:(t=e.match(Ag))?{type:"<"===t[1]?"before":"after",date:t[2]}:(t=e.match(Mg))?{type:"exact",date:t[1]}:void 0}var Ug=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var zg="exact",Wg=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o=Fg(r.props.context.element.businessObject.text);if(o){var i=void 0;i=o.date?[o.date,""]:o.dates?o.dates:["",""],r.state={type:o.type,dates:i}}else r.state={type:zg,dates:["",""]};var a=n.injector.get("debounceInput");return r.debouncedEditCell=a(r.editCell.bind(r)),r.editCell=r.editCell.bind(r),r.onTypeChange=r.onTypeChange.bind(r),r.onSetStartDateTodayClick=r.onSetStartDateTodayClick.bind(r),r.onSetEndDateTodayClick=r.onSetEndDateTodayClick.bind(r),r.onStartDateInput=r.onStartDateInput.bind(r),r.onEndDateInput=r.onEndDateInput.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Ug(t,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state.dates;this.setState({type:e}),Fg(Lg(e,n))&&this.editCell(t.businessObject,Lg(e,n))}},{key:"onSetStartDateTodayClick",value:function(){var e=this.props.context.element,t=this.state,n=t.dates,r=t.type,o=$g();this.setState({dates:[o,n[1]]}),Fg(Lg(r,[o,n[1]]))&&this.editCell(e.businessObject,Lg(r,[o,n[1]]))}},{key:"onSetEndDateTodayClick",value:function(){var e=this.props.context.element,t=this.state,n=t.dates,r=t.type,o=$g();this.setState({dates:[n[0],o]}),Fg(Lg(r,[n[0],o]))&&this.editCell(e.businessObject,Lg(r,[n[0],o]))}},{key:"onStartDateInput",value:function(e){var t=e.isValid,n=e.value;if(t){var r=this.props.context.element,o=this.state,i=o.dates,a=o.type;this.setState({dates:[n,i[1]]}),this.debouncedEditCell(r.businessObject,Lg(a,[n,i[1]]))}}},{key:"onEndDateInput",value:function(e){var t=e.isValid,n=e.value;if(t){var r=this.props.context.element,o=this.state,i=o.dates,a=o.type;this.setState({dates:[i[0],n]}),this.debouncedEditCell(r.businessObject,Lg(a,[i[0],n]))}}},{key:"render",value:function(){var e=this.state,t=e.dates,n=e.type,r=[{label:"Exactly",value:zg},{label:"Before",value:"before"},{label:"After",value:"after"},{label:"Between",value:"between"}];return fl(1,"div","context-menu-container simple-date-edit",[fl(1,"h3","dms-heading",hl("Edit Date"),2),fl(1,"div","dms-fill-row",dl(2,Av,{noInput:!0,onChange:this.onTypeChange,options:r,value:n}),2),fl(1,"h4","dms-heading","between"===n?"Edit Start Date":"Set Date",0),fl(1,"div",null,[dl(2,Qv,{className:"start-date-input dms-block",onInput:this.onStartDateInput,placeholder:"e.g. "+$g(),validate:Vg,value:t[0]}),fl(1,"p","dms-hint",[fl(1,"a","use-today",hl("Use today"),2,{href:"#",onClick:this.onSetStartDateTodayClick}),hl(".")],4)],4),"between"===n&&fl(1,"h4","dms-heading",hl("Edit End Date"),2),"between"===n&&fl(1,"div",null,[dl(2,Qv,{className:"end-date-input dms-block",onInput:this.onEndDateInput,placeholder:"e.g. "+$g(),validate:Vg,value:t[1]}),fl(1,"p","dms-hint",[fl(1,"a","use-today",hl("Use today"),2,{href:"#",onClick:this.onSetEndDateTodayClick}),hl(".")],4)],4)],0)}}]),t}(),Gg=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Hg=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o=Fg(r.props.context.element.businessObject.text);r.state={date:o?o.date:""};var i=n.injector.get("debounceInput");return r.debouncedEditCell=i(r.editCell.bind(r)),r.editCell=r.editCell.bind(r),r.onClick=r.onClick.bind(r),r.onInput=r.onInput.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Gg(t,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onClick",value:function(){var e=this.props.context.element,t=$g();this.setState({date:t}),this.editCell(e.businessObject,'date and time("'+t+'")')}},{key:"onInput",value:function(e){var t=e.isValid,n=e.value;if(t){var r=this.props.context.element;this.setState({date:n}),this.debouncedEditCell(r.businessObject,'date and time("'+n+'")')}}},{key:"render",value:function(){var e=this.state.date;return fl(1,"div","context-menu-container simple-date-edit",[fl(1,"h3","dms-heading",hl("Edit Date"),2),fl(1,"h4","dms-heading",hl("Set Date"),2),fl(1,"div",null,[dl(2,Qv,{onInput:this.onInput,placeholder:"e.g. "+$g(),validate:Vg,value:e,className:"dms-block"}),fl(1,"p","dms-hint",[hl("Set date "),fl(1,"a","use-today",hl("to today"),2,{href:"#",onClick:this.onClick}),hl(".")],4)],4)],4)}}]),t}();var qg=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.registerProvider(function(e){var t=Kg(e);return(Vt(e.col)||Lt(e.col))&&Xg(t)}),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"simple-mode-edit"===e.contextMenuType){if(!e.element)return;if(Xg(Kg(e.element))){if(Vt(e.element.col))return Wg;if(Lt(e.element.col))return Hg}}})};function Kg(e){return Vt(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}function Xg(e){return"date"===e}qg.$inject=["components","simpleMode"];var Yg={__depends__:[ym,Cg],__init__:["simpleDateEdit"],simpleDateEdit:["type",qg]},Zg=/^(-?(?:[0-9]|\.[0-9])+)$|^((?:<|>|=){0,2})\s*(-?(?:[0-9]|\.[0-9])+)$/,Jg=/^(\[|\]){1}(-?(?:[0-9]|\.[0-9])+){1,}\.\.(-?(?:[0-9]|\.[0-9])+){1,}(\[|\]){1}$/,Qg={equals:"=",less:"<",lessEquals:"<=",greater:">",greaterEquals:">="};function eb(e){if(!e||function(e){return""===e}(e.trim()))return{type:"comparison"};var t,n=e.match(Zg),r=e.match(Jg);if(n){if((t=n)[0]&&t[1]&&!t[2]&&!t[3])return{type:"comparison",value:parseFloat(n[1]),operator:"equals"};if(function(e){return e[0]&&!e[1]&&e[2]&&e[3]}(n))return{type:"comparison",value:parseFloat(n[3]),operator:function(e){return y(Qg).filter(function(t){return e===Qg[t]})[0]}(n[2])}}else if(r)return{type:"range",values:[r[2],r[3]].map(function(e){return parseFloat(e)}),start:"]"===r[1]?"exclude":"include",end:"["===r[4]?"exclude":"include"}}function tb(e,t){return"equals"===e?""+t:Qg[e]+" "+t}function nb(e,t,n,r){return""+("exclude"===n?"]":"[")+e+".."+t+("exclude"===r?"[":"]")}var rb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ob="comparison",ib=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o=eb(r.props.context.element.businessObject.text);r.state=o?{type:o.type,comparisonOperator:o.operator||"equals",comparisonValue:o.value||0,rangeStartValue:o.values?o.values[0]:0,rangeEndValue:o.values?o.values[1]:0,rangeStartType:o.start||"include",rangeEndType:o.end||"include"}:{type:ob,comparisonOperator:"equals",comparisonValue:0,rangeStartValue:0,rangeEndValue:0,rangeStartType:"include",rangeEndType:"include"};var i=n.injector.get("debounceInput");return r.debouncedEditCell=i(r.editCell.bind(r)),r.editCell=r.editCell.bind(r),r.onComparisonOperatorChange=r.onComparisonOperatorChange.bind(r),r.onComparisonValueChange=r.onComparisonValueChange.bind(r),r.onTypeChange=r.onTypeChange.bind(r),r.onRangeStartTypeChange=r.onRangeStartTypeChange.bind(r),r.onRangeStartValueChange=r.onRangeStartValueChange.bind(r),r.onRangeEndTypeChange=r.onRangeEndTypeChange.bind(r),r.onRangeEndValueChange=r.onRangeEndValueChange.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),rb(t,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onTypeChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.comparisonOperator,o=n.comparisonValue,i=n.rangeStartValue,a=n.rangeEndValue,s=n.rangeStartType,c=n.rangeEndType;e===ob?this.editCell(t.businessObject,tb(r,o)):this.editCell(t.businessObject,nb(i,a,s,c)),this.setState({type:e})}},{key:"onComparisonOperatorChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.type,o=n.comparisonValue;r===ob&&(this.editCell(t.businessObject,tb(e,o)),this.setState({comparisonOperator:e}))}},{key:"onComparisonValueChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.type,o=n.comparisonOperator;r===ob&&(this.debouncedEditCell(t.businessObject,tb(o,e)),this.setState({comparisonValue:e}))}},{key:"onRangeStartTypeChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.type,o=n.rangeStartValue,i=n.rangeEndValue,a=n.rangeEndType;"range"===r&&(this.editCell(t.businessObject,nb(o,i,e,a)),this.setState({rangeStartType:e}))}},{key:"onRangeStartValueChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.type,o=n.rangeEndValue,i=n.rangeStartType,a=n.rangeEndType;"range"===r&&(this.editCell(t.businessObject,nb(e,o,i,a)),this.setState({rangeStartValue:e}))}},{key:"onRangeEndTypeChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.type,o=n.rangeStartValue,i=n.rangeEndValue,a=n.rangeStartType;"range"===r&&(this.editCell(t.businessObject,nb(o,i,a,e)),this.setState({rangeEndType:e}))}},{key:"onRangeEndValueChange",value:function(e){var t=this.props.context.element,n=this.state,r=n.type,o=n.rangeStartValue,i=n.rangeStartType,a=n.rangeEndType;"range"===r&&(this.editCell(t.businessObject,nb(o,e,i,a)),this.setState({rangeEndValue:e}))}},{key:"renderComparison",value:function(e,t){return fl(1,"div","comparison",[fl(1,"h4","dms-heading",hl("Value"),2),fl(1,"div","dms-fill-row",[dl(2,Av,{noInput:!0,onChange:this.onComparisonOperatorChange,options:[{label:"Equals",value:"equals"},{label:"Less",value:"less"},{label:"Less or equals",value:"lessEquals"},{label:"Greater",value:"greater"},{label:"Greater or equals",value:"greaterEquals"}],value:e}),hl(""),dl(2,xv,{className:"comparison-number-input",onInput:this.onComparisonValueChange,type:"number",value:t})],4)],4)}},{key:"renderRange",value:function(e,t,n,r){var o=[{label:"Include",value:"include"},{label:"Exclude",value:"exclude"}];return fl(1,"div","range",[fl(1,"h4","dms-heading",hl("Start Value"),2),fl(1,"div","dms-fill-row",[dl(2,Av,{noInput:!0,onChange:this.onRangeStartTypeChange,options:o,value:n}),hl(""),dl(2,xv,{className:"range-start-number-input",onInput:this.onRangeStartValueChange,type:"number",value:e})],4),fl(1,"h4","dms-heading",hl("End Value"),2),fl(1,"div","dms-fill-row",[dl(2,Av,{noInput:!0,onChange:this.onRangeEndTypeChange,options:o,value:r}),hl(""),dl(2,xv,{className:"range-end-number-input",onInput:this.onRangeEndValueChange,type:"number",value:t})],4)],4)}},{key:"render",value:function(){var e=this.state,t=e.type,n=e.comparisonOperator,r=e.comparisonValue,o=e.rangeStartValue,i=e.rangeEndValue,a=e.rangeStartType,s=e.rangeEndType,c=[{label:"Comparison",value:ob},{label:"Range",value:"range"}];return fl(1,"div","context-menu-container simple-number-edit",[fl(1,"h3","dms-heading",hl("Edit Number"),2),fl(1,"div","dms-fill-row",dl(2,Av,{noInput:!0,onChange:this.onTypeChange,options:c,value:t}),2),t===ob&&this.renderComparison(n,r),"range"===t&&this.renderRange(o,i,a,s)],0)}}]),t}(),ab=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var sb=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o=eb(r.props.context.element.businessObject.text);r.state=o?{value:o.value}:{value:""};var i=n.injector.get("debounceInput");return r.debouncedEditCell=i(r.editCell.bind(r)),r.editCell=r.editCell.bind(r),r.onInput=r.onInput.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),ab(t,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onInput",value:function(e){var t=this.props.context.element;this.debouncedEditCell(t.businessObject,e),this.setState({value:e})}},{key:"render",value:function(){var e=this.state.value;return fl(1,"div","context-menu-container simple-number-edit",[fl(1,"h3","dms-heading",hl("Edit Number"),2),fl(1,"h4","dms-heading",hl("Set Value"),2),dl(2,xv,{onInput:this.onInput,type:"number",value:e})],4)}}]),t}();var cb=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.registerProvider(function(e){var t=ub(e);return(Vt(e.col)||Lt(e.col))&&("integer"===t||"long"===t||"double"===t)}),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"simple-mode-edit"===e.contextMenuType){if(!e.element)return;if(function(e){return"integer"===e||"long"===e||"double"===e}(ub(e.element))){if(Vt(e.element.col))return ib;if(Lt(e.element.col))return sb}}})};function ub(e){return Vt(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}cb.$inject=["components","simpleMode"];var lb={__depends__:[ym,Cg],__init__:["simpleNumberEdit"],simpleNumberEdit:["type",cb]};function pb(e){if(!e||fb(e.trim()))return{type:"disjunction",values:[]};var t=e.split(","),n={type:"disjunction",values:[]},r="";if(t.forEach(function(e){/^"[^"]*"$/.test((r+=e).trim())?(n.values.push(r.trim()),r=""):r+=","}),!r)return n;n.type="negation",n.values=[],r="";var o=e.match(/^\s*not\((.*)\)\s*$/);return o&&((t=o[1].split(",")).forEach(function(e){/^"[^"]*"$/.test((r+=e).trim())?(n.values.push(r.trim()),r=""):r+=","}),!r)?n:void 0}function fb(e){return""===e}var db=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var hb="disjunction",vb="Predefined Values",yb="Predefined Values",mb="Custom Values",gb=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o=pb(e.context.element.businessObject.text);o||(o={values:[],type:hb});var i=function(e){var t=Vt(e)?e.inputValues:e.outputValues;return!t||fb(t.text)?[]:t.text.split(",").map(function(e){return e.trim()})}(e.context.element.col.businessObject),a=o.values.filter(function(e){return!_b(i,e)}),s=Vt(e.context.element.col),c=i.map(function(e){return{value:e,isChecked:_b(o.values,e),isRemovable:!1,group:s?vb:yb}});s&&(c=c.concat(a.map(function(e){return{value:e,isChecked:!0,isRemovable:!0,group:mb}})));var u="";s||!o.values.length||_b(i,o.values[0])||(u=o.values[0]),r.state={items:c,unaryTestsType:o.type,inputValue:u,isOutputValueInputChecked:""!==u};var l=n.injector.get("debounceInput");return r.debouncedEditCell=l(r.editCell.bind(r)),r.editCell=r.editCell.bind(r),r.addUnaryTestsListItem=r.addUnaryTestsListItem.bind(r),r.onInput=r.onInput.bind(r),r.onKeyDown=r.onKeyDown.bind(r),r.onOutputValueInputClick=r.onOutputValueInputClick.bind(r),r.onUnaryTestsListChanged=r.onUnaryTestsListChanged.bind(r),r.onUnaryTestsTypeChange=r.onUnaryTestsTypeChange.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),db(t,[{key:"editCell",value:function(e,t){this._modeling.editCell(e,t)}},{key:"onUnaryTestsTypeChange",value:function(e){var t=bb(this.state.items),n=this.props.context.element;e===hb?(this.editCell(n.businessObject,t.join(",")),this.setState({unaryTestsType:hb})):(this.editCell(n.businessObject,"not("+t.join(",")+")"),this.setState({unaryTestsType:"negation"}))}},{key:"onUnaryTestsListChanged",value:function(e){var t=bb(e),n=this.props.context.element;this.state.unaryTestsType===hb?this.editCell(n.businessObject,t.join(",")):this.editCell(n.businessObject,"not("+t.join(",")+")"),this.setState({items:e,isOutputValueInputChecked:!1})}},{key:"onOutputValueInputClick",value:function(){var e=this.props.context.element,t=this.state,n=t.inputValue,r=t.items,o=pb(n);!o||o.values.length>1||(this.editCell(e.businessObject,""+o.values.join("")),this.setState({items:r.map(function(e){return e.isChecked=!1,e}),isOutputValueInputChecked:!0}))}},{key:"onInput",value:function(e){var t=e.isValid,n=e.value,r=this.state.isOutputValueInputChecked;this.setState({inputValue:n});var o=this.props.context.element;!Vt(o)&&t&&r&&this.debouncedEditCell(o.businessObject,n)}},{key:"onKeyDown",value:function(e){var t=e.isValid,n=e.event;if(13===n.keyCode){var r=Vt(this.props.context.element.col);!r&&t||(n.stopPropagation(),n.preventDefault()),t&&(r?this.addUnaryTestsListItem():this.onOutputValueInputClick())}}},{key:"addUnaryTestsListItem",value:function(){var e=this.state,t=e.inputValue,n=e.items,r=e.unaryTestsType,o=pb(t);if(o){var i=this.props.context.element,a=bb(n),s=[].concat(a,o.values);r===hb?this.editCell(i.businessObject,s.join(",")):this.editCell(i.businessObject,"not("+s.join(",")+")");var c=n.concat(o.values.map(function(e){return{value:e,isChecked:!0,isRemovable:!0,group:"Custom Values"}}));this.setState({items:c,inputValue:""})}}},{key:"render",value:function(){var e=this,t=this.props.context.element,n=this.state,r=n.inputValue,o=n.isOutputValueInputChecked,i=n.items,a=n.unaryTestsType,s=[{label:"Match one",value:hb},{label:"Match none",value:"negation"}],c=Vt(t.col),u="negation"===a,l=!c&&i.length>0;return fl(1,"div","simple-string-edit context-menu-container",[fl(1,"h3","dms-heading",hl("Edit String"),2),c&&fl(1,"p",null,dl(2,Av,{noInput:!0,onChange:this.onUnaryTestsTypeChange,options:s,value:u?"negation":hb},null,function(t){return e.selectNode=t}),2),dl(2,Zv,{onChange:this.onUnaryTestsListChanged,items:i,type:c?"checkbox":"radio"}),fl(1,"h4","dms-heading",hl(c?"Add Values":"Set Value"),2),fl(1,"div","dms-fill-row",[l&&fl(64,"input","cursor-pointer",null,1,{checked:o,onClick:this.onOutputValueInputClick,type:"radio",style:{marginRight:"8px"}}),dl(2,Qv,{className:"dms-block",onKeyDown:this.onKeyDown,onInput:this.onInput,placeholder:c?'"value", "value", ...':'"value"',type:"text",validate:function(e){if(!pb(e))return"Strings must be in double quotes."},value:r})],0)],0)}}]),t}();function bb(e){return e.filter(function(e){return e.isChecked}).map(function(e){return e.value})}function _b(e,t){return-1!==e.indexOf(t)}var wb=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.registerProvider(function(e){return(Vt(e.col)||Lt(e.col))&&"string"===xb(e)}),t.onGetComponent("context-menu",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contextMenuType&&"simple-mode-edit"===e.contextMenuType){if(!e.element)return;if("string"===xb(e.element))return gb}})};function xb(e){return Vt(e.col)?e.col&&e.col.businessObject.inputExpression.typeRef:e.col&&e.col.businessObject.typeRef}wb.$inject=["components","simpleMode"];var Cb={__depends__:[ym,Cg],__init__:["simpleStringEdit"],simpleStringEdit:["type",wb]},Eb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Ob(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var kb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,pd),Eb(t,[{key:"getModules",value:function(){return[].concat(Ob(pd._getModules()),Ob(t._getModules()))}}],[{key:"_getModules",value:function(){return[xh,Wh,Xd,nv,vh,sv,dv,gv,wh,fy,Ty,Fy,Gy,ym,fy,im,_h,dm,xd,ug,gg,gd,Cg,Pg,Yg,lb,Cb]}}]),t}(),jb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Sb=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners={},t.on("elements.changed",function(e){var t=e.elements;n.elementsChanged(t)}),t.on("root.remove",function(e){var r=e.root.id;n._listeners[r]&&t.once("root.add",function(e){var t=e.root.id;n._listeners[t]=n._listeners[r],delete n._listeners[r]})})}return jb(e,[{key:"elementsChanged",value:function(e){for(var t={},n=e.length,r=0;r<n;r++){var o=e[r].id;if(t[o])return;t[o]=!0;var i=this._listeners[o]&&this._listeners[o].length;if(i)for(var a=0;a<i;a++)this._listeners[o][a]&&this._listeners[o][a]()}}},{key:"onElementsChanged",value:function(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e][this._listeners[e].length]=t}},{key:"offElementsChanged",value:function(e,t){if(this._listeners[e])if(t){var n=this._listeners[e].indexOf(t);-1!==n&&this._listeners[e].splice(n,1)}else this._listeners[e].length=0}}]),e}();Sb.$inject=["eventBus"];var Pb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Tb=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners={}}return Pb(e,[{key:"getComponent",value:function(e,t){var n=this._listeners[e];if(n){for(var r=void 0,o=0;o<n.length&&!(r=n[o].callback(t));o++);return r}}},{key:"getComponents",value:function(e,t){var n=this._listeners[e];if(n){for(var r=[],o=0;o<n.length;o++){var i=n[o].callback(t);i&&r.push(i)}if(r.length)return r}}},{key:"onGetComponent",value:function(e,t,n){if(a(t)&&(n=t,t=1e3),!i(t))throw new Error("priority must be a number");var r=this._getListeners(e),o=void 0,s=void 0,c={priority:t,callback:n};for(s=0;o=r[s];s++)if(o.priority<t)return void r.splice(s,0,c);r.push(c)}},{key:"offGetComponent",value:function(e,t){var n=this._getListeners(e),r=void 0,o=void 0;if(t)for(o=n.length-1;r=n[o];o--)r.callback===t&&n.splice(o,1);else n.length=0}},{key:"_getListeners",value:function(e){var t=this._listeners[e];return t||(this._listeners[e]=t=[]),t}}]),e}(),Rb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ab=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n._injector=e.injector;return n._changeSupport=r.get("changeSupport"),n._components=r.get("components"),n._renderer=r.get("renderer"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Rb(t,[{key:"getChildContext",value:function(){return{changeSupport:this._changeSupport,components:this._components,renderer:this._renderer,injector:this._injector}}},{key:"render",value:function(){var e=this._components.getComponents("viewer");return fl(1,"div","viewer-container",e&&e.map(function(e,t){return dl(2,e,null,t)}),0)}}]),t}(),Mb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Bb=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=r.container;this._container=a,o.on("renderer.mount",function(){Cp(dl(2,Ab,{injector:i}),a)}),o.on("renderer.unmount",function(){Cp(null,a)})}return Mb(e,[{key:"getContainer",value:function(){return this._container}}]),e}();Bb.$inject=["changeSupport","components","config.renderer","eventBus","injector"];var Db={__init__:["changeSupport","components","renderer"],changeSupport:["type",Sb],components:["type",Tb],eventBus:["type",A],renderer:["type",Bb]},Ib=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Nb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.injector;if(!n){var r=this._init(t),o=r.modules;n=function(e,t){return function(e){var t=[],n=[];function r(e){return t.indexOf(e)>=0}e.forEach(function e(o){if(r(o))return;(o.__depends__||[]).forEach(e);if(r(o))return;!function(e){t.push(e)}(o);(o.__init__||[]).forEach(function(e){n.push(e)})});var o=new nn(t);return n.forEach(function(e){try{o["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),o}([{config:["value",e]},Db].concat(t||[]))}(r.config,o)}this.get=n.get,this.invoke=n.invoke,this.get("eventBus").fire("viewer.init")}return Ib(e,[{key:"_init",value:function(e){return{modules:e.modules,config:function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["modules"])}}},{key:"destroy",value:function(){this.get("eventBus").fire("viewer.destroy")}},{key:"clear",value:function(){this.get("eventBus").fire("viewer.clear")}}]),e}();var Vb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Lb=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._viewer=n.injector.get("viewer"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Vb(t,[{key:"render",value:function(){var e=this._viewer._decision,t=e.name,n=e.id;return fl(1,"div","decision-properties",[fl(1,"h3","decision-name",t,0),fl(1,"h5","decision-id",n,0)],4)}}]),t}();var $b=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",2e3,function(){return Lb})};$b.$inject=["components"];var Fb={__init__:["decisionProperties"],decisionProperties:["type",$b]},Ub=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var zb=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._viewer=n.injector.get("viewer"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Ub(t,[{key:"render",value:function(){var e=this._viewer._decision,t=e.literalExpression,n=e.variable;return fl(1,"div","literal-expression-properties",fl(1,"table",null,[fl(1,"tr",null,[fl(1,"td",null,hl("Variable Name:"),2),fl(1,"td",null,fl(1,"span",null,n.name||"-",0),2)],4),fl(1,"tr",null,[fl(1,"td",null,hl("Variable Type:"),2),fl(1,"td",null,fl(1,"span",null,n.typeRef||"-",0),2)],4),fl(1,"tr",null,[fl(1,"td",null,hl("Expression Language:"),2),fl(1,"td",null,fl(1,"span",null,t.expressionLanguage||"-",0),2)],4)],4),2)}}]),t}();var Wb=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",500,function(){return zb})};Wb.$inject=["components"];var Gb={__init__:["literalExpressionProperties"],literalExpressionProperties:["type",Wb]},Hb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var qb=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.onClick=function(){r._eventBus.fire("poweredBy.show")};var o=n.injector;return r._eventBus=o.get("eventBus"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Hb(t,[{key:"render",value:function(){var e=this;return fl(1,"div","powered-by-logo",fl(1,"img","logo",null,1,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC"}),2,{onClick:this.onClick,title:"Powered by bpmn.io"},null,function(t){return e.node=t})}}]),t}(),Kb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Xb=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1},n.onClick=n.onClick.bind(n),n.onShow=n.onShow.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Kb(t,[{key:"onClick",value:function(){this.setState({show:!1})}},{key:"onShow",value:function(){this.setState({show:!0})}},{key:"componentWillMount",value:function(){(this._eventBus=this.context.injector.get("eventBus")).on("poweredBy.show",this.onShow)}},{key:"componentWillUnmount",value:function(){this._eventBus.off("poweredBy.show",this.onShow)}},{key:"render",value:function(){return this.state.show&&fl(1,"div","powered-by-overlay",fl(1,"div","powered-by-overlay-content",[fl(1,"div",null,fl(1,"img","logo",null,1,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC"}),2),fl(1,"div",null,[hl("Web-based tooling for BPMN, DMN and CMMN diagrams powered by "),fl(1,"a",null,hl("bpmn.io"),2,{href:"http://bpmn.io",target:"_blank"}),hl(".")],4)],4,{onClick:function(e){return e.stopPropagation()}}),2,{onClick:this.onClick})}}]),t}();var Yb=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",2e3,function(){return qb}),t.onGetComponent("viewer",function(){return Xb})};Yb.$inject=["components","eventBus"];var Zb={__init__:["poweredBy"],poweredBy:["type",Yb]},Jb=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Qb=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._viewer=n.injector.get("viewer"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),Jb(t,[{key:"render",value:function(){return fl(1,"div","textarea",fl(1,"div","content",this._viewer._decision.literalExpression.text,0),2)}}]),t}();var e_=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",function(){return Qb})};e_.$inject=["components"];var t_={__init__:["textarea"],textarea:["type",e_]},n_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r_=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r.onClick=function(){r._eventBus.fire("showDrd")};var o=n.injector;return r._eventBus=o.get("eventBus"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),n_(t,[{key:"render",value:function(){var e=this;return fl(1,"div","view-drd",fl(1,"button","view-drd-button",hl("View DRD"),2,{onClick:this.onClick}),2,null,null,function(t){return e.node=t})}}]),t}(),o_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i_=1500,a_=function(){function e(t,n,r,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._injector=r,this._viewer=o,t.onGetComponent("viewer",i_,function(){if(i.canViewDrd())return r_}),n.on("showDrd",function(){var e=r.get("_parent",!1),t=s_(o._decision),n=e.getView(t);e.open(n)})}return o_(e,[{key:"canViewDrd",value:function(){var e=this._injector.get("_parent",!1);if(e){var t=s_(this._viewer._decision);return!!e.getView(t)}}}]),e}();function s_(e){return e.$parent}a_.$inject=["components","eventBus","injector","viewer"];var c_={__init__:["viewDrd"],viewDrd:["type",a_]},u_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function l_(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var p_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=t._createContainer(),r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,S(e,{renderer:{container:n}})));return r._container=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Nb),u_(t,[{key:"open",value:function(e,t){var n;try{this._decision&&(this.clear(),this.get("eventBus").fire("renderer.unmount")),this._decision=e,this.get("eventBus").fire("import",e),this.get("eventBus").fire("renderer.mount")}catch(e){n=e}return t(n)}},{key:"_init",value:function(e){var t=e.modules,n=e.additionalModules,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["modules","additionalModules"]),o=t||this.getModules(),i=n||[],a=[{viewer:["value",this]}];return{modules:[].concat(l_(o),l_(i),a),config:r}}},{key:"on",value:function(e,t,n,r){return this.get("eventBus").on(e,t,n,r)}},{key:"off",value:function(e,t){this.get("eventBus").off(e,t)}},{key:"_emit",value:function(e,t){return this.get("eventBus").fire(e,t)}},{key:"attachTo",value:function(e){if(!e)throw new Error("parentNode required");this.detach(),e.appendChild(this._container),this._emit("attach",{})}},{key:"detach",value:function(){var e=this._container;e.parentNode&&(this._emit("detach",{}),xt(e))}},{key:"destroy",value:function(){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.detach()}},{key:"getModules",value:function(){return t._getModules()}}],[{key:"_getModules",value:function(){return[Fb,Gb,Zb,t_,c_]}},{key:"_createContainer",value:function(){return ht('<div class="dmn-literal-expression-container"></div>')}}]),t}(),f_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function d_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h_(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y_=function(e){function t(e,n){d_(this,t);var r=h_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r._viewer=n.injector.get("viewer");r._modeling=n.injector.get("modeling"),r.setDecisionName=r.setDecisionName.bind(r),r.setDecisionId=r.setDecisionId.bind(r),r.onElementsChanged=r.onElementsChanged.bind(r),r.validateId=r.validateId.bind(r);var i=o._decision.id;return r.setupChangeListeners({bind:i}),r}return v_(t,Sp),f_(t,[{key:"componentWillUnmount",value:function(){var e=this._viewer._decision.id;this.setupChangeListeners({unbind:e})}},{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"setupChangeListeners",value:function(e){var t=e.bind,n=e.unbind,r=this.context.changeSupport;"string"==typeof n&&r.offElementsChanged(n,this.onElementsChanged),"string"==typeof t&&r.onElementsChanged(t,this.onElementsChanged)}},{key:"setDecisionName",value:function(e){this._modeling.editDecisionName(e)}},{key:"setDecisionId",value:function(e){var t=this._viewer._decision.id;t!==e&&(this.setupChangeListeners({bind:e,unbind:t}),this._modeling.editDecisionId(e))}},{key:"validateId",value:function(e){return Yy(this._viewer._decision,e)}},{key:"render",value:function(){var e=this._viewer._decision,t=e.name,n=e.id;return fl(1,"header","decision-properties",[dl(2,m_,{className:"decision-name editor",value:t,onChange:this.setDecisionName}),dl(2,g_,{className:"decision-id editor",value:n,validate:this.validateId,onChange:this.setDecisionId})],4)}}]),t}(),m_=function(e){function t(){return d_(this,t),h_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v_(t,Mh),f_(t,[{key:"render",value:function(){return fl(1,"h3",this.getClassName(),this.getEditor(),0)}}]),t}(),g_=function(e){function t(){return d_(this,t),h_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v_(t,Mh),f_(t,[{key:"render",value:function(){return fl(1,"h5",this.getClassName(),this.getEditor(),0)}}]),t}();var b_=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",2e3,function(){return y_})};b_.$inject=["components"];var __={__depends__:[zh],__init__:["decisionProperties"],decisionProperties:["type",b_]},w_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var x_=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._actions={undo:function(){t.undo()},redo:function(){t.redo()}}}return w_(e,[{key:"trigger",value:function(e,t){if(!this._actions[e])throw C_(e,"is not a registered action");return this._actions[e](t)}},{key:"register",value:function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);p(e,function(e,t){n._registerAction(t,e)})}},{key:"_registerAction",value:function(e,t){if(this.isRegistered(e))throw C_(e,"is already registered");this._actions[e]=t}},{key:"unregister",value:function(e){if(!this.isRegistered(e))throw C_(e,"is not a registered action");this._actions[e]=void 0}},{key:"isRegistered",value:function(e){return!!this._actions[e]}}]),e}();function C_(e,t){return new Error(e+" "+t)}x_.$inject=["commandStack","eventBus"];var E_={__init__:["editorActions"],editorActions:["type",x_]};function O_(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function k_(e){return e.shiftKey}var j_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var S_=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._init=function(){o._registerDefaultBindings(),o._fire("init")},this._destroy=function(){o._fire("destroy"),o.unbind(),o._listeners=null},this._keyHandler=function(e){var t,n,r=o._listeners,i=e.keyCode||e.charCode||-1;for(t=0;n=r[t];t++)if(n(i,e))return e.preventDefault(),void e.stopPropagation()},this.unbind=function(){var e=o._node;e&&(o._fire("unbind"),pt.unbind(e,"keydown",o._keyHandler,!0)),o._node=null},this._config=t||{},this._eventBus=n,this._editorActions=r,this._listeners=[],n.on("viewer.destroy",this._destroy),n.on("viewer.init",this._init),n.on("attach",function(){o._config.bindTo&&o.bind(t.bindTo)}),n.on("detach",this.unbind)}return j_(e,[{key:"bind",value:function(e){this.unbind(),this._node=e,pt.bind(e,"keydown",this._keyHandler,!0),this._fire("bind")}},{key:"getBinding",value:function(){return this._node}},{key:"_fire",value:function(e){this._eventBus.fire("keyboard."+e,{node:this._node,listeners:this._listeners})}},{key:"_registerDefaultBindings",value:function(){var e=this._listeners,t=this._editorActions;e.push(function(e,n){if(O_(n)&&!k_(n)&&90===e)return t.trigger("undo"),!0}),e.push(function(e,n){if(O_(n)&&(89===e||90===e&&k_(n)))return t.trigger("redo"),!0})}},{key:"addListener",value:function(e){this._listeners.unshift(e)}},{key:"removeListener",value:function(e){this._listeners=this._listeners.filter(function(t){return t!==e})}}]),e}();S_.$inject=["config.keyboard","eventBus","editorActions"];var P_={__depends__:[E_],__init__:["keyboard"],keyboard:["type",S_]},T_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var R_=[{label:"FEEL",value:"feel"},{label:"JUEL",value:"juel"},{label:"JavaScript",value:"javascript"},{label:"Groovy",value:"groovy"},{label:"Python",value:"python"},{label:"JRuby",value:"jruby"}],A_=[{label:"string",value:"string"},{label:"boolean",value:"boolean"},{label:"integer",value:"integer"},{label:"long",value:"long"},{label:"double",value:"double"},{label:"date",value:"date"}],M_=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=r._viewer=n.injector.get("viewer");r._modeling=n.injector.get("modeling");var i,a=o._decision;return r.state={name:a.variable.name,typeRef:a.variable.typeRef,expressionLanguage:(i=a.literalExpression,i&&i.expressionLanguage?i.expressionLanguage.toLowerCase():void 0)},r.setVariableName=r.setVariableName.bind(r),r.setVariableType=r.setVariableType.bind(r),r.setExpressionLanguage=r.setExpressionLanguage.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Sp),T_(t,[{key:"setVariableName",value:function(e){this._modeling.editVariableName(e),this.setState({name:e})}},{key:"setVariableType",value:function(e){""===e?(this._modeling.editVariableType(void 0),this.setState({typeRef:void 0})):(this._modeling.editVariableType(e),this.setState({typeRef:e}))}},{key:"setExpressionLanguage",value:function(e){""===e?(this._modeling.editExpressionLanguage(void 0),this.setState({expressionLanguage:void 0})):(this._modeling.editExpressionLanguage(e),this.setState({expressionLanguage:e}))}},{key:"render",value:function(){var e=this.state,t=e.expressionLanguage,n=e.name,r=e.typeRef;return fl(1,"div","literal-expression-properties",fl(1,"table",null,[fl(1,"tr",null,[fl(1,"td",null,hl("Variable Name:"),2),fl(1,"td",null,dl(2,xv,{className:"variable-name-input",onInput:this.setVariableName,placeholder:"name",value:n||""}),2)],4),fl(1,"tr",null,[fl(1,"td",null,hl("Variable Type:"),2),fl(1,"td",null,fl(1,"div","dms-fill-row",dl(2,Av,{onChange:this.setVariableType,options:A_,value:r,className:"variable-type-select dms-block"}),2),2)],4),fl(1,"tr",null,[fl(1,"td",null,hl("Expression Language:"),2),fl(1,"td",null,fl(1,"div","dms-fill-row",dl(2,Av,{onChange:this.setExpressionLanguage,options:R_,value:t,className:"expression-language-select dms-block"}),2),2)],4)],4),2)}}]),t}();var B_=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",500,function(){return M_})};B_.$inject=["components"];var D_={__depends__:[zh,P_],__init__:["literalExpressionProperties"],literalExpressionProperties:["type",B_]},I_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var N_=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventBus=t,this._commandStack=n,this._viewer=r,t.on("viewer.init",function(){!function(e,t){p(e,function(e,n){t.registerHandler(n,e)})}(o.getHandlers(),n)})}return I_(e,[{key:"getHandlers",value:function(){return e._getHandlers()}},{key:"editDecisionName",value:function(e){var t={element:this._viewer._decision,properties:{name:e}};this._commandStack.execute("updateProperties",t)}},{key:"editDecisionId",value:function(e){var t={element:this._viewer._decision,properties:{id:e}};this._commandStack.execute("updateProperties",t)}},{key:"editLiteralExpressionText",value:function(e){var t={element:this._viewer._decision.literalExpression,properties:{text:e}};this._commandStack.execute("updateProperties",t)}},{key:"editExpressionLanguage",value:function(e){var t={element:this._viewer._decision.literalExpression,properties:{expressionLanguage:e}};this._commandStack.execute("updateProperties",t)}},{key:"editVariableName",value:function(e){var t={element:this._viewer._decision.variable,properties:{name:e}};this._commandStack.execute("updateProperties",t)}},{key:"editVariableType",value:function(e){var t={element:this._viewer._decision.variable,properties:{typeRef:e}};this._commandStack.execute("updateProperties",t)}}],[{key:"_getHandlers",value:function(){return{updateProperties:Qm}}}]),e}();N_.$inject=["eventBus","commandStack","viewer"];var V_={__init__:["idChangeBehavior","modeling"],commandStack:["type",Ys],idChangeBehavior:["type",jm],modeling:["type",N_]},L_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function $_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F_(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function U_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var z_=function(e){function t(e,n){$_(this,t);var r=F_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));r._modeling=n.injector.get("modeling");var o=r._viewer=n.injector.get("viewer");r.editLiteralExpressionText=r.editLiteralExpressionText.bind(r),r.onElementsChanged=r.onElementsChanged.bind(r);var i=o._decision.literalExpression.id;return n.changeSupport.onElementsChanged(i,r.onElementsChanged),r}return U_(t,Sp),L_(t,[{key:"onElementsChanged",value:function(){this.forceUpdate()}},{key:"editLiteralExpressionText",value:function(e){this._modeling.editLiteralExpressionText(e)}},{key:"render",value:function(){var e=this._viewer._decision.literalExpression.text;return dl(2,W_,{className:"textarea editor",value:e,onChange:this.editLiteralExpressionText})}}]),t}(),W_=function(e){function t(){return $_(this,t),F_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return U_(t,Mh),L_(t,[{key:"render",value:function(){return fl(1,"div",this.getClassName(),this.getEditor(),0)}}]),t}();var G_=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.onGetComponent("viewer",function(){return z_})};G_.$inject=["components"];var H_={__depends__:[zh],__init__:["textarea"],textarea:["type",G_]},q_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function K_(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var X_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p_),q_(t,[{key:"getModules",value:function(){return[].concat(K_(p_._getModules()),K_(t._getModules()))}}],[{key:"_getModules",value:function(){return[__,P_,D_,V_,H_]}}]),t}(),Y_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();return function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Wt),Y_(t,[{key:"_getViewProviders",value:function(){return[{id:"drd",constructor:Pu,opens:"dmn:Definitions"},{id:"decisionTable",constructor:kb,opens:function(e){return Nt(e,"dmn:Decision")&&e.decisionTable}},{id:"literalExpression",constructor:X_,opens:function(e){return Nt(e,"dmn:Decision")&&e.literalExpression}}]}},{key:"_getInitialView",value:function(e){for(var t,n=0;n<e.length;n++){var r=e[n],o=r.element;if(Nt(o,"dmn:Decision"))return r;if(Nt(o,"dmn:Definitions")&&(t=r,Qa(o)))return r}return t||e[0]}}]),t}()});
